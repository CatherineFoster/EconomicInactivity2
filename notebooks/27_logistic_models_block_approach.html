<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Jon Minton">
<meta name="author" content="Martin Taulbut">

<title>Block-based models predicting flows into EILTS</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="27_logistic_models_block_approach_files/libs/clipboard/clipboard.min.js"></script>
<script src="27_logistic_models_block_approach_files/libs/quarto-html/quarto.js"></script>
<script src="27_logistic_models_block_approach_files/libs/quarto-html/popper.min.js"></script>
<script src="27_logistic_models_block_approach_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="27_logistic_models_block_approach_files/libs/quarto-html/anchor.min.js"></script>
<link href="27_logistic_models_block_approach_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="27_logistic_models_block_approach_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="27_logistic_models_block_approach_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="27_logistic_models_block_approach_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="27_logistic_models_block_approach_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

<script src="27_logistic_models_block_approach_files/libs/kePrint-0.0.1/kePrint.js"></script>
<link href="27_logistic_models_block_approach_files/libs/lightable-0.0.1/lightable.css" rel="stylesheet">


</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="27_logistic_models_block_approach.docx"><i class="bi bi-file-word"></i>MS Word</a></li></ul></div></div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Block-based models predicting flows into EILTS</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Authors</div>
    <div class="quarto-title-meta-contents">
             <p>Jon Minton </p>
             <p>Martin Taulbut </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<section id="aim" class="level2">
<h2 class="anchored" data-anchor-id="aim">Aim</h2>
<p>This document will develop analyses which predict flows into EILTS using a block-based approach. This will involve developing a series of logistic regression models which predict flows into EILTS using a range of individual and household level attributes.</p>
</section>
<section id="preparation" class="level2">
<h2 class="anchored" data-anchor-id="preparation">Preparation</h2>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">load_all</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">"R"</span>))</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>base_dir_location <span class="ot">&lt;-</span> <span class="st">"big_data/UKDA-6614-stata/stata/stata13_se/ukhls"</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nnet)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a><span class="co"># Individual level attributes </span></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>varnames <span class="ot">&lt;-</span>  <span class="fu">c</span>(</span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a>  <span class="st">"jbstat"</span>, <span class="st">"dvage"</span>, <span class="st">"sex"</span>, <span class="co"># econ status; age; sex</span></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>  <span class="st">"sf12mcs_dv"</span>, <span class="st">"sf12pcs_dv"</span>, <span class="co"># SF12 MH, SF12 PH</span></span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>  <span class="st">"health"</span> <span class="co"># LLTI as a binary variable</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-17"><a href="#cb1-17" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb1-18"><a href="#cb1-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-19"><a href="#cb1-19" aria-hidden="true" tabindex="-1"></a>extract_what <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb1-20"><a href="#cb1-20" aria-hidden="true" tabindex="-1"></a>  <span class="st">"labels"</span>, <span class="st">"values"</span>, <span class="st">"labels"</span>, </span>
<span id="cb1-21"><a href="#cb1-21" aria-hidden="true" tabindex="-1"></a>  <span class="st">"values"</span>, <span class="st">"values"</span>,</span>
<span id="cb1-22"><a href="#cb1-22" aria-hidden="true" tabindex="-1"></a>  <span class="st">"labels"</span></span>
<span id="cb1-23"><a href="#cb1-23" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb1-24"><a href="#cb1-24" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb1-25"><a href="#cb1-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-26"><a href="#cb1-26" aria-hidden="true" tabindex="-1"></a>demohealth_data <span class="ot">&lt;-</span> <span class="fu">get_ind_level_vars_for_selected_waves</span>(</span>
<span id="cb1-27"><a href="#cb1-27" aria-hidden="true" tabindex="-1"></a>  <span class="at">varnames =</span> varnames, <span class="at">vartypes =</span> extract_what</span>
<span id="cb1-28"><a href="#cb1-28" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-29"><a href="#cb1-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-30"><a href="#cb1-30" aria-hidden="true" tabindex="-1"></a>mh_data <span class="ot">&lt;-</span> </span>
<span id="cb1-31"><a href="#cb1-31" aria-hidden="true" tabindex="-1"></a>  <span class="fu">get_ind_level_vars_for_selected_waves</span>(</span>
<span id="cb1-32"><a href="#cb1-32" aria-hidden="true" tabindex="-1"></a>    <span class="at">varnames =</span> <span class="fu">c</span>(<span class="st">"jbstat"</span>, <span class="st">"sf12mcs_dv"</span>),</span>
<span id="cb1-33"><a href="#cb1-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">vartypes =</span> <span class="fu">c</span>(<span class="st">"labels"</span>, <span class="st">"values"</span>)</span>
<span id="cb1-34"><a href="#cb1-34" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb1-35"><a href="#cb1-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-36"><a href="#cb1-36" aria-hidden="true" tabindex="-1"></a>eth_data <span class="ot">&lt;-</span> </span>
<span id="cb1-37"><a href="#cb1-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">get_ind_level_vars_for_selected_waves</span>(</span>
<span id="cb1-38"><a href="#cb1-38" aria-hidden="true" tabindex="-1"></a>    <span class="at">varnames =</span> <span class="fu">c</span>(<span class="st">"jbstat"</span>, <span class="st">"ethn_dv"</span>),</span>
<span id="cb1-39"><a href="#cb1-39" aria-hidden="true" tabindex="-1"></a>    <span class="at">vartypes =</span> <span class="fu">c</span>(<span class="st">"labels"</span>, <span class="st">"labels"</span>)</span>
<span id="cb1-40"><a href="#cb1-40" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb1-41"><a href="#cb1-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-42"><a href="#cb1-42" aria-hidden="true" tabindex="-1"></a>hiqual_data <span class="ot">&lt;-</span> </span>
<span id="cb1-43"><a href="#cb1-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">get_ind_level_vars_for_selected_waves</span>(</span>
<span id="cb1-44"><a href="#cb1-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">varnames =</span> <span class="fu">c</span>(<span class="st">"jbstat"</span>, <span class="st">"hiqual_dv"</span>),</span>
<span id="cb1-45"><a href="#cb1-45" aria-hidden="true" tabindex="-1"></a>    <span class="at">vartypes =</span> <span class="fu">c</span>(<span class="st">"labels"</span>, <span class="st">"labels"</span>)</span>
<span id="cb1-46"><a href="#cb1-46" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb1-47"><a href="#cb1-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-48"><a href="#cb1-48" aria-hidden="true" tabindex="-1"></a>gor_data <span class="ot">&lt;-</span> </span>
<span id="cb1-49"><a href="#cb1-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">get_ind_level_vars_for_selected_waves</span>(</span>
<span id="cb1-50"><a href="#cb1-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">varnames =</span> <span class="fu">c</span>(<span class="st">"jbstat"</span>, <span class="st">"gor_dv"</span>),</span>
<span id="cb1-51"><a href="#cb1-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">vartypes =</span> <span class="fu">c</span>(<span class="st">"labels"</span>, <span class="st">"labels"</span>)</span>
<span id="cb1-52"><a href="#cb1-52" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb1-53"><a href="#cb1-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-54"><a href="#cb1-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-55"><a href="#cb1-55" aria-hidden="true" tabindex="-1"></a>ind_joined <span class="ot">&lt;-</span> </span>
<span id="cb1-56"><a href="#cb1-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(</span>
<span id="cb1-57"><a href="#cb1-57" aria-hidden="true" tabindex="-1"></a>    demohealth_data <span class="sc">|&gt;</span> <span class="fu">select</span>(<span class="sc">-</span>sf12mcs_dv),</span>
<span id="cb1-58"><a href="#cb1-58" aria-hidden="true" tabindex="-1"></a>    eth_data <span class="sc">|&gt;</span> <span class="fu">select</span>(</span>
<span id="cb1-59"><a href="#cb1-59" aria-hidden="true" tabindex="-1"></a>      pidp, wave, ethn_dv</span>
<span id="cb1-60"><a href="#cb1-60" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb1-61"><a href="#cb1-61" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb1-62"><a href="#cb1-62" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(</span>
<span id="cb1-63"><a href="#cb1-63" aria-hidden="true" tabindex="-1"></a>    mh_data <span class="sc">|&gt;</span> <span class="fu">select</span>(</span>
<span id="cb1-64"><a href="#cb1-64" aria-hidden="true" tabindex="-1"></a>      pidp, wave, sf12mcs_dv</span>
<span id="cb1-65"><a href="#cb1-65" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb1-66"><a href="#cb1-66" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb1-67"><a href="#cb1-67" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(</span>
<span id="cb1-68"><a href="#cb1-68" aria-hidden="true" tabindex="-1"></a>    hiqual_data <span class="sc">|&gt;</span> </span>
<span id="cb1-69"><a href="#cb1-69" aria-hidden="true" tabindex="-1"></a>      <span class="fu">select</span>(pidp, wave, hiqual_dv)</span>
<span id="cb1-70"><a href="#cb1-70" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb1-71"><a href="#cb1-71" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(</span>
<span id="cb1-72"><a href="#cb1-72" aria-hidden="true" tabindex="-1"></a>    gor_data <span class="sc">|&gt;</span> </span>
<span id="cb1-73"><a href="#cb1-73" aria-hidden="true" tabindex="-1"></a>      <span class="fu">select</span>(pidp, wave, gor_dv)</span>
<span id="cb1-74"><a href="#cb1-74" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb1-75"><a href="#cb1-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-76"><a href="#cb1-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-77"><a href="#cb1-77" aria-hidden="true" tabindex="-1"></a><span class="co"># Household level attributes </span></span>
<span id="cb1-78"><a href="#cb1-78" aria-hidden="true" tabindex="-1"></a><span class="co"># cars: ncars</span></span>
<span id="cb1-79"><a href="#cb1-79" aria-hidden="true" tabindex="-1"></a><span class="co"># equivalised hh income </span></span>
<span id="cb1-80"><a href="#cb1-80" aria-hidden="true" tabindex="-1"></a><span class="co"># hh type</span></span>
<span id="cb1-81"><a href="#cb1-81" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-82"><a href="#cb1-82" aria-hidden="true" tabindex="-1"></a>vars_types_hh <span class="ot">&lt;-</span> <span class="fu">tribble</span>(</span>
<span id="cb1-83"><a href="#cb1-83" aria-hidden="true" tabindex="-1"></a>  <span class="sc">~</span>var_name, <span class="sc">~</span>var_type, </span>
<span id="cb1-84"><a href="#cb1-84" aria-hidden="true" tabindex="-1"></a>  <span class="st">"fihhmnnet1_dv"</span>, <span class="st">"values"</span>,</span>
<span id="cb1-85"><a href="#cb1-85" aria-hidden="true" tabindex="-1"></a>  <span class="st">"ieqmoecd_dv"</span>, <span class="st">"values"</span>,</span>
<span id="cb1-86"><a href="#cb1-86" aria-hidden="true" tabindex="-1"></a>  <span class="st">"hhtype_dv"</span>, <span class="st">"labels"</span></span>
<span id="cb1-87"><a href="#cb1-87" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb1-88"><a href="#cb1-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-89"><a href="#cb1-89" aria-hidden="true" tabindex="-1"></a>dta_joined_pt1 <span class="ot">&lt;-</span> </span>
<span id="cb1-90"><a href="#cb1-90" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_hh_variables</span>(</span>
<span id="cb1-91"><a href="#cb1-91" aria-hidden="true" tabindex="-1"></a>    ind_joined, </span>
<span id="cb1-92"><a href="#cb1-92" aria-hidden="true" tabindex="-1"></a>    <span class="at">varnames =</span> vars_types_hh<span class="sc">$</span>var_name, </span>
<span id="cb1-93"><a href="#cb1-93" aria-hidden="true" tabindex="-1"></a>    <span class="at">vartypes =</span> vars_types_hh<span class="sc">$</span>var_type</span>
<span id="cb1-94"><a href="#cb1-94" aria-hidden="true" tabindex="-1"></a>  ) </span>
<span id="cb1-95"><a href="#cb1-95" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-96"><a href="#cb1-96" aria-hidden="true" tabindex="-1"></a>dta_joined_pt2 <span class="ot">&lt;-</span> </span>
<span id="cb1-97"><a href="#cb1-97" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_hh_variables</span>(</span>
<span id="cb1-98"><a href="#cb1-98" aria-hidden="true" tabindex="-1"></a>    ind_joined,</span>
<span id="cb1-99"><a href="#cb1-99" aria-hidden="true" tabindex="-1"></a>    <span class="at">varnames =</span> <span class="st">"ncars"</span>,</span>
<span id="cb1-100"><a href="#cb1-100" aria-hidden="true" tabindex="-1"></a>    <span class="at">vartypes =</span> <span class="st">"values"</span></span>
<span id="cb1-101"><a href="#cb1-101" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb1-102"><a href="#cb1-102" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-103"><a href="#cb1-103" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-104"><a href="#cb1-104" aria-hidden="true" tabindex="-1"></a>dta_joined <span class="ot">&lt;-</span> </span>
<span id="cb1-105"><a href="#cb1-105" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(</span>
<span id="cb1-106"><a href="#cb1-106" aria-hidden="true" tabindex="-1"></a>    dta_joined_pt1,</span>
<span id="cb1-107"><a href="#cb1-107" aria-hidden="true" tabindex="-1"></a>    dta_joined_pt2 <span class="sc">|&gt;</span> <span class="fu">select</span>(pidp, wave, hidp, ncars)</span>
<span id="cb1-108"><a href="#cb1-108" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb1-109"><a href="#cb1-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-110"><a href="#cb1-110" aria-hidden="true" tabindex="-1"></a><span class="fu">rm</span>(dta_joined_pt1, dta_joined_pt2, ind_joined, mh_data, eth_data, demohealth_data, hiqual_data, gor_data)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
</section>
<section id="modelling" class="level2">
<h2 class="anchored" data-anchor-id="modelling">Modelling</h2>
<p>We will start with the simplest possible model specification, then add blocks of covariates</p>
<p>We are predicting whether next_status is EILTS or not.</p>
<p>We will start with a manual approach to deciding on which blocks of variables, and variables within, to include</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>data_tidied <span class="ot">&lt;-</span> </span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  dta_joined <span class="sc">|&gt;</span> </span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>      <span class="at">eth_simplified =</span> <span class="fu">case_when</span>(</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>        ethn_dv <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"british/english/scottish/welsh/northern irish"</span>, <span class="st">"any other white background"</span>, <span class="st">"gypsy or irish traveller"</span>) <span class="sc">~</span> <span class="st">'White'</span>,</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>        <span class="fu">is.na</span>(ethn_dv) <span class="sc">|</span> ethn_dv <span class="sc">==</span> <span class="st">'missing'</span> <span class="sc">~</span> <span class="cn">NA_character_</span>,</span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>        <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">'non-White'</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>      <span class="at">age =</span> <span class="fu">ifelse</span>(dvage <span class="sc">&lt;</span> <span class="dv">0</span>, <span class="cn">NA</span>, dvage)</span>
<span id="cb2-12"><a href="#cb2-12" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb2-13"><a href="#cb2-13" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="fu">between</span>(age, <span class="dv">16</span>, <span class="dv">64</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb2-14"><a href="#cb2-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(hiqual_dv <span class="sc">!=</span> <span class="st">'missing'</span>) <span class="sc">|&gt;</span> </span>
<span id="cb2-15"><a href="#cb2-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>      <span class="at">mh =</span> <span class="fu">ifelse</span>(sf12mcs_dv <span class="sc">&lt;</span> <span class="dv">0</span>, <span class="cn">NA</span>, sf12mcs_dv),</span>
<span id="cb2-17"><a href="#cb2-17" aria-hidden="true" tabindex="-1"></a>      <span class="at">ph =</span> <span class="fu">ifelse</span>(sf12pcs_dv <span class="sc">&lt;</span> <span class="dv">0</span>, <span class="cn">NA</span>, sf12pcs_dv)</span>
<span id="cb2-18"><a href="#cb2-18" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb2-19"><a href="#cb2-19" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb2-20"><a href="#cb2-20" aria-hidden="true" tabindex="-1"></a>      <span class="at">ncars =</span> <span class="fu">ifelse</span>(ncars <span class="sc">&lt;</span> <span class="dv">0</span>, <span class="cn">NA</span>, ncars),</span>
<span id="cb2-21"><a href="#cb2-21" aria-hidden="true" tabindex="-1"></a>      <span class="at">hascar =</span> <span class="fu">ifelse</span>(ncars <span class="sc">&gt;</span> <span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb2-22"><a href="#cb2-22" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb2-23"><a href="#cb2-23" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">ieqmoecd_dv =</span> <span class="fu">ifelse</span>(ieqmoecd_dv <span class="sc">&lt;</span> <span class="dv">0</span>, <span class="cn">NA</span>, ieqmoecd_dv)) <span class="sc">|&gt;</span></span>
<span id="cb2-24"><a href="#cb2-24" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb2-25"><a href="#cb2-25" aria-hidden="true" tabindex="-1"></a>      <span class="at">eq_net_income =</span> fihhmnnet1_dv <span class="sc">/</span> ieqmoecd_dv</span>
<span id="cb2-26"><a href="#cb2-26" aria-hidden="true" tabindex="-1"></a>    )  <span class="sc">|&gt;</span> </span>
<span id="cb2-27"><a href="#cb2-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb2-28"><a href="#cb2-28" aria-hidden="true" tabindex="-1"></a>      <span class="at">ncars =</span> <span class="fu">ifelse</span>(ncars <span class="sc">&lt;</span> <span class="dv">0</span>, <span class="cn">NA</span>, ncars)</span>
<span id="cb2-29"><a href="#cb2-29" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb2-30"><a href="#cb2-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb2-31"><a href="#cb2-31" aria-hidden="true" tabindex="-1"></a>      <span class="at">lti =</span> <span class="fu">case_when</span>(</span>
<span id="cb2-32"><a href="#cb2-32" aria-hidden="true" tabindex="-1"></a>        health <span class="sc">==</span> <span class="st">'1'</span> <span class="sc">~</span> <span class="st">'yes'</span>,</span>
<span id="cb2-33"><a href="#cb2-33" aria-hidden="true" tabindex="-1"></a>        health <span class="sc">==</span> <span class="st">'2'</span> <span class="sc">~</span> <span class="st">'no'</span>,</span>
<span id="cb2-34"><a href="#cb2-34" aria-hidden="true" tabindex="-1"></a>        <span class="cn">TRUE</span>   <span class="sc">~</span> <span class="cn">NA_character_</span></span>
<span id="cb2-35"><a href="#cb2-35" aria-hidden="true" tabindex="-1"></a>      )</span>
<span id="cb2-36"><a href="#cb2-36" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb2-37"><a href="#cb2-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(simplified_household_lookup, <span class="at">by =</span> <span class="fu">c</span>(<span class="st">'hhtype_dv'</span> <span class="ot">=</span> <span class="st">'original'</span>)) <span class="sc">|&gt;</span> </span>
<span id="cb2-38"><a href="#cb2-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(this_status)) <span class="sc">|&gt;</span> </span>
<span id="cb2-39"><a href="#cb2-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(wave <span class="sc">%in%</span> letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">10</span>]) <span class="sc">|&gt;</span> <span class="co"># waves a to j</span></span>
<span id="cb2-40"><a href="#cb2-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb2-41"><a href="#cb2-41" aria-hidden="true" tabindex="-1"></a>    <span class="at">becomes_eilts =</span> <span class="fu">ifelse</span>(next_status <span class="sc">==</span> <span class="st">"Inactive long term sick"</span>, <span class="dv">1</span>, <span class="dv">0</span>)</span>
<span id="cb2-42"><a href="#cb2-42" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb2-43"><a href="#cb2-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb2-44"><a href="#cb2-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">age_group =</span> <span class="fu">case_when</span>(</span>
<span id="cb2-45"><a href="#cb2-45" aria-hidden="true" tabindex="-1"></a>      <span class="fu">between</span>(age, <span class="dv">16</span>, <span class="dv">24</span>) <span class="sc">~</span> <span class="st">"16-24"</span>,</span>
<span id="cb2-46"><a href="#cb2-46" aria-hidden="true" tabindex="-1"></a>      <span class="fu">between</span>(age, <span class="dv">25</span>, <span class="dv">44</span>) <span class="sc">~</span> <span class="st">"25-44"</span>,</span>
<span id="cb2-47"><a href="#cb2-47" aria-hidden="true" tabindex="-1"></a>      <span class="fu">between</span>(age, <span class="dv">45</span>, <span class="dv">54</span>) <span class="sc">~</span> <span class="st">"45-54"</span>,</span>
<span id="cb2-48"><a href="#cb2-48" aria-hidden="true" tabindex="-1"></a>      <span class="fu">between</span>(age, <span class="dv">55</span>, <span class="dv">64</span>) <span class="sc">~</span> <span class="st">"55-64"</span></span>
<span id="cb2-49"><a href="#cb2-49" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb2-50"><a href="#cb2-50" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb2-51"><a href="#cb2-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(sex <span class="sc">!=</span> <span class="st">'missing'</span>) <span class="sc">|&gt;</span> </span>
<span id="cb2-52"><a href="#cb2-52" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb2-53"><a href="#cb2-53" aria-hidden="true" tabindex="-1"></a>    <span class="at">hh_type =</span> <span class="fu">factor</span>(recoded, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Single Adult"</span>, <span class="st">"Small Adult"</span>, <span class="st">"Single Parent"</span>, <span class="st">"Family with 1-2 Children"</span>, <span class="st">"Family with 3 or more Children"</span>, <span class="st">"Single Pensioner"</span>, <span class="st">"Pensioner Couple"</span>) </span>
<span id="cb2-54"><a href="#cb2-54" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb2-55"><a href="#cb2-55" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb2-56"><a href="#cb2-56" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">hiqual_dv =</span> <span class="fu">case_when</span>(</span>
<span id="cb2-57"><a href="#cb2-57" aria-hidden="true" tabindex="-1"></a>    hiqual_dv <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"A level etc"</span>, <span class="st">"A-level etc"</span>) <span class="sc">~</span> <span class="st">"A level etc"</span>,</span>
<span id="cb2-58"><a href="#cb2-58" aria-hidden="true" tabindex="-1"></a>    hiqual_dv <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"No qual"</span>, <span class="st">"No qualification"</span>) <span class="sc">~</span> <span class="st">"No qualification"</span>,</span>
<span id="cb2-59"><a href="#cb2-59" aria-hidden="true" tabindex="-1"></a>    hiqual_dv <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Other higher"</span>, <span class="st">"Other higher degree"</span>) <span class="sc">~</span> <span class="st">"Other higher degree"</span>,</span>
<span id="cb2-60"><a href="#cb2-60" aria-hidden="true" tabindex="-1"></a>    hiqual_dv <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Other qual"</span>, <span class="st">"Other qualification"</span>) <span class="sc">~</span> <span class="st">"Other qualification"</span>,</span>
<span id="cb2-61"><a href="#cb2-61" aria-hidden="true" tabindex="-1"></a>    hiqual_dv <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"inapplicable"</span>, <span class="st">"missing"</span>) <span class="sc">~</span> <span class="cn">NA_character_</span>,</span>
<span id="cb2-62"><a href="#cb2-62" aria-hidden="true" tabindex="-1"></a>    <span class="cn">TRUE</span> <span class="sc">~</span> hiqual_dv</span>
<span id="cb2-63"><a href="#cb2-63" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb2-64"><a href="#cb2-64" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>mod_null <span class="ot">&lt;-</span> <span class="fu">glm</span>(becomes_eilts <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> data_tidied, <span class="at">family =</span> binomial)</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod_null)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = becomes_eilts ~ 1, family = binomial, data = data_tidied)

Coefficients:
             Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept) -3.077283   0.009132    -337   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 102852  on 284717  degrees of freedom
Residual deviance: 102852  on 284717  degrees of freedom
  (62657 observations deleted due to missingness)
AIC: 102854

Number of Fisher Scoring iterations: 6</code></pre>
</div>
</div>
<p>Now to add the first block of variables: history</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>mod_history <span class="ot">&lt;-</span> <span class="fu">glm</span>(becomes_eilts <span class="sc">~</span> this_status, <span class="at">data =</span> data_tidied, <span class="at">family =</span> binomial)</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod_history)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = becomes_eilts ~ this_status, family = binomial, 
    data = data_tidied)

Coefficients:
                                   Estimate Std. Error  z value Pr(&gt;|z|)    
(Intercept)                        -5.50920    0.03556 -154.926   &lt;2e-16 ***
this_statusInactive care            2.00788    0.05577   36.000   &lt;2e-16 ***
this_statusInactive long term sick  6.60620    0.04119  160.396   &lt;2e-16 ***
this_statusInactive other           2.45032    0.12049   20.337   &lt;2e-16 ***
this_statusInactive retired         1.94958    0.06033   32.315   &lt;2e-16 ***
this_statusInactive student         0.18833    0.10198    1.847   0.0648 .  
this_statusUnemployed               3.07013    0.04572   67.155   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 102852  on 284717  degrees of freedom
Residual deviance:  44435  on 284711  degrees of freedom
  (62657 observations deleted due to missingness)
AIC: 44449

Number of Fisher Scoring iterations: 8</code></pre>
</div>
</div>
<p>Now to add the second block of variables: demographics</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>mod_history_demographics <span class="ot">&lt;-</span> <span class="fu">glm</span>(becomes_eilts <span class="sc">~</span> this_status <span class="sc">+</span> age_group <span class="sc">+</span> sex <span class="sc">+</span> eth_simplified, <span class="at">data =</span> data_tidied, <span class="at">family =</span> binomial)</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod_history_demographics)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = becomes_eilts ~ this_status + age_group + sex + 
    eth_simplified, family = binomial, data = data_tidied)

Coefficients:
                                   Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                        -6.63745    0.07377 -89.969  &lt; 2e-16 ***
this_statusInactive care            2.10816    0.05768  36.552  &lt; 2e-16 ***
this_statusInactive long term sick  6.59097    0.04198 156.988  &lt; 2e-16 ***
this_statusInactive other           2.55555    0.12106  21.110  &lt; 2e-16 ***
this_statusInactive retired         1.90961    0.06551  29.152  &lt; 2e-16 ***
this_statusInactive student         1.03978    0.11192   9.290  &lt; 2e-16 ***
this_statusUnemployed               3.24432    0.04649  69.784  &lt; 2e-16 ***
age_group25-44                      0.74836    0.05990  12.494  &lt; 2e-16 ***
age_group45-54                      1.26333    0.06075  20.797  &lt; 2e-16 ***
age_group55-64                      0.91921    0.06206  14.812  &lt; 2e-16 ***
sexmale                             0.04212    0.02853   1.476     0.14    
eth_simplifiedWhite                 0.23248    0.03411   6.815 9.44e-12 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 102697  on 284023  degrees of freedom
Residual deviance:  43766  on 284012  degrees of freedom
  (63351 observations deleted due to missingness)
AIC: 43790

Number of Fisher Scoring iterations: 8</code></pre>
</div>
</div>
<p>We can now start comparing the AICs</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(mod_null, mod_history, mod_history_demographics)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                         df       AIC
mod_null                  1 102854.06
mod_history               7  44448.90
mod_history_demographics 12  43789.93</code></pre>
</div>
</div>
<p>Now hh income, both linear and logged</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>mod_history_demographics_hhincome <span class="ot">&lt;-</span> <span class="fu">glm</span>(</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>  becomes_eilts <span class="sc">~</span> this_status <span class="sc">+</span> age_group <span class="sc">+</span> sex <span class="sc">+</span> eth_simplified <span class="sc">+</span> eq_net_income, </span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>   <span class="at">data =</span> data_tidied, </span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>   <span class="at">family =</span> binomial</span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod_history_demographics_hhincome)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = becomes_eilts ~ this_status + age_group + sex + 
    eth_simplified + eq_net_income, family = binomial, data = data_tidied)

Coefficients:
                                     Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                        -6.590e+00  7.897e-02 -83.440  &lt; 2e-16 ***
this_statusInactive care            2.095e+00  5.857e-02  35.768  &lt; 2e-16 ***
this_statusInactive long term sick  6.571e+00  4.342e-02 151.317  &lt; 2e-16 ***
this_statusInactive other           2.552e+00  1.214e-01  21.018  &lt; 2e-16 ***
this_statusInactive retired         1.903e+00  6.578e-02  28.928  &lt; 2e-16 ***
this_statusInactive student         1.028e+00  1.127e-01   9.124  &lt; 2e-16 ***
this_statusUnemployed               3.218e+00  4.849e-02  66.366  &lt; 2e-16 ***
age_group25-44                      7.476e-01  6.017e-02  12.423  &lt; 2e-16 ***
age_group45-54                      1.266e+00  6.101e-02  20.746  &lt; 2e-16 ***
age_group55-64                      9.166e-01  6.233e-02  14.705  &lt; 2e-16 ***
sexmale                             3.918e-02  2.862e-02   1.369    0.171    
eth_simplifiedWhite                 2.362e-01  3.426e-02   6.895  5.4e-12 ***
eq_net_income                      -2.330e-05  1.445e-05  -1.613    0.107    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 102192  on 281904  degrees of freedom
Residual deviance:  43552  on 281892  degrees of freedom
  (65470 observations deleted due to missingness)
AIC: 43578

Number of Fisher Scoring iterations: 8</code></pre>
</div>
</div>
<p>Now logged</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>mod_history_demographics_loghhincome <span class="ot">&lt;-</span> <span class="fu">glm</span>(</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>  becomes_eilts <span class="sc">~</span> this_status <span class="sc">+</span> age_group <span class="sc">+</span> sex <span class="sc">+</span> eth_simplified <span class="sc">+</span> <span class="fu">log</span>(eq_net_income<span class="sc">+</span> <span class="fl">0.5</span>), </span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>   <span class="at">data =</span> data_tidied, </span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>   <span class="at">family =</span> binomial</span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod_history_demographics_loghhincome)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = becomes_eilts ~ this_status + age_group + sex + 
    eth_simplified + log(eq_net_income + 0.5), family = binomial, 
    data = data_tidied)

Coefficients:
                                    Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                        -6.614857   0.140640 -47.034  &lt; 2e-16 ***
this_statusInactive care            2.110572   0.058341  36.176  &lt; 2e-16 ***
this_statusInactive long term sick  6.587726   0.042823 153.836  &lt; 2e-16 ***
this_statusInactive other           2.564306   0.121521  21.102  &lt; 2e-16 ***
this_statusInactive retired         1.910969   0.065746  29.066  &lt; 2e-16 ***
this_statusInactive student         1.040043   0.112704   9.228  &lt; 2e-16 ***
this_statusUnemployed               3.239070   0.048420  66.895  &lt; 2e-16 ***
age_group25-44                      0.748574   0.060203  12.434  &lt; 2e-16 ***
age_group45-54                      1.265794   0.061044  20.736  &lt; 2e-16 ***
age_group55-64                      0.915205   0.062350  14.679  &lt; 2e-16 ***
sexmale                             0.040290   0.028629   1.407    0.159    
eth_simplifiedWhite                 0.233709   0.034271   6.819 9.14e-12 ***
log(eq_net_income + 0.5)           -0.002659   0.015957  -0.167    0.868    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 102175  on 281778  degrees of freedom
Residual deviance:  43544  on 281766  degrees of freedom
  (65596 observations deleted due to missingness)
AIC: 43570

Number of Fisher Scoring iterations: 8</code></pre>
</div>
</div>
<p>If we were to remove event history, the effect of income may be stat sig</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>mod_demographics_loghhincome <span class="ot">&lt;-</span> <span class="fu">glm</span>(</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>  becomes_eilts <span class="sc">~</span>  age_group <span class="sc">+</span> sex <span class="sc">+</span> eth_simplified <span class="sc">+</span> <span class="fu">log</span>(eq_net_income <span class="sc">+</span> <span class="fl">0.5</span>), </span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>   <span class="at">data =</span> data_tidied, </span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>   <span class="at">family =</span> binomial</span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod_demographics_loghhincome)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = becomes_eilts ~ age_group + sex + eth_simplified + 
    log(eq_net_income + 0.5), family = binomial, data = data_tidied)

Coefficients:
                          Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)              -1.764249   0.068014 -25.940  &lt; 2e-16 ***
age_group25-44            0.987046   0.046827  21.078  &lt; 2e-16 ***
age_group45-54            1.770604   0.046395  38.164  &lt; 2e-16 ***
age_group55-64            1.906987   0.046450  41.054  &lt; 2e-16 ***
sexmale                  -0.001138   0.018676  -0.061    0.951    
eth_simplifiedWhite       0.098977   0.024553   4.031 5.55e-05 ***
log(eq_net_income + 0.5) -0.385585   0.007772 -49.615  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 102175  on 281778  degrees of freedom
Residual deviance:  96790  on 281772  degrees of freedom
  (65596 observations deleted due to missingness)
AIC: 96804

Number of Fisher Scoring iterations: 7</code></pre>
</div>
</div>
<p>Now car access</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>mod_history_demographics_hascar <span class="ot">&lt;-</span> <span class="fu">glm</span>(</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>  becomes_eilts <span class="sc">~</span> this_status <span class="sc">+</span> age_group <span class="sc">+</span> sex <span class="sc">+</span> eth_simplified <span class="sc">+</span> hascar, </span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>   <span class="at">data =</span> data_tidied, </span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>   <span class="at">family =</span> binomial</span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod_history_demographics_hascar)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = becomes_eilts ~ this_status + age_group + sex + 
    eth_simplified + hascar, family = binomial, data = data_tidied)

Coefficients:
                                   Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                        -6.23477    0.07913 -78.794  &lt; 2e-16 ***
this_statusInactive care            2.04902    0.05890  34.787  &lt; 2e-16 ***
this_statusInactive long term sick  6.46109    0.04336 149.023  &lt; 2e-16 ***
this_statusInactive other           2.53695    0.12231  20.743  &lt; 2e-16 ***
this_statusInactive retired         1.88974    0.06676  28.309  &lt; 2e-16 ***
this_statusInactive student         1.00293    0.11388   8.807  &lt; 2e-16 ***
this_statusUnemployed               3.08455    0.04859  63.482  &lt; 2e-16 ***
age_group25-44                      0.73470    0.06099  12.047  &lt; 2e-16 ***
age_group45-54                      1.27923    0.06187  20.675  &lt; 2e-16 ***
age_group55-64                      0.91998    0.06332  14.530  &lt; 2e-16 ***
sexmale                             0.04269    0.02910   1.467    0.142    
eth_simplifiedWhite                 0.27626    0.03512   7.866 3.67e-15 ***
hascar                             -0.50003    0.03074 -16.268  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 99491  on 274672  degrees of freedom
Residual deviance: 42057  on 274660  degrees of freedom
  (72702 observations deleted due to missingness)
AIC: 42083

Number of Fisher Scoring iterations: 8</code></pre>
</div>
</div>
<p>Now to add the next block of variables: health</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>mod_history_demographics_car_lti <span class="ot">&lt;-</span> <span class="fu">glm</span>(</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>  becomes_eilts <span class="sc">~</span> this_status <span class="sc">+</span> age_group <span class="sc">+</span> sex <span class="sc">+</span> eth_simplified <span class="sc">+</span> hascar <span class="sc">+</span> lti, </span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>   <span class="at">data =</span> data_tidied, </span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>   <span class="at">family =</span> binomial</span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod_history_demographics_car_lti)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = becomes_eilts ~ this_status + age_group + sex + 
    eth_simplified + hascar + lti, family = binomial, data = data_tidied)

Coefficients:
                                   Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                        -6.95842    0.08619 -80.738  &lt; 2e-16 ***
this_statusInactive care            1.88101    0.05956  31.582  &lt; 2e-16 ***
this_statusInactive long term sick  5.50304    0.04477 122.931  &lt; 2e-16 ***
this_statusInactive other           2.25620    0.12478  18.081  &lt; 2e-16 ***
this_statusInactive retired         1.51623    0.06695  22.649  &lt; 2e-16 ***
this_statusInactive student         1.08326    0.11507   9.414  &lt; 2e-16 ***
this_statusUnemployed               2.81475    0.04962  56.727  &lt; 2e-16 ***
age_group25-44                      0.56288    0.06454   8.722  &lt; 2e-16 ***
age_group45-54                      0.95897    0.06529  14.687  &lt; 2e-16 ***
age_group55-64                      0.55836    0.06635   8.415  &lt; 2e-16 ***
sexmale                             0.08040    0.02958   2.718  0.00657 ** 
eth_simplifiedWhite                 0.18205    0.03623   5.025 5.04e-07 ***
hascar                             -0.44214    0.03110 -14.215  &lt; 2e-16 ***
ltiyes                              2.05628    0.04236  48.545  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 99400  on 274412  degrees of freedom
Residual deviance: 39061  on 274399  degrees of freedom
  (72962 observations deleted due to missingness)
AIC: 39089

Number of Fisher Scoring iterations: 8</code></pre>
</div>
</div>
<p>Now health as continuous variables</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>mod_history_demographics_car_sf12 <span class="ot">&lt;-</span> <span class="fu">glm</span>(</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>  becomes_eilts <span class="sc">~</span> this_status <span class="sc">+</span> age_group <span class="sc">+</span> sex <span class="sc">+</span> hascar <span class="sc">+</span> eth_simplified <span class="sc">+</span> mh <span class="sc">+</span> ph, </span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>   <span class="at">data =</span> data_tidied, </span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>   <span class="at">family =</span> binomial</span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod_history_demographics_car_sf12)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = becomes_eilts ~ this_status + age_group + sex + 
    hascar + eth_simplified + mh + ph, family = binomial, data = data_tidied)

Coefficients:
                                    Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                        -0.429428   0.133318  -3.221  0.00128 ** 
this_statusInactive care            1.508376   0.066405  22.715  &lt; 2e-16 ***
this_statusInactive long term sick  4.804996   0.051967  92.463  &lt; 2e-16 ***
this_statusInactive other           2.021429   0.140777  14.359  &lt; 2e-16 ***
this_statusInactive retired         1.282066   0.076053  16.857  &lt; 2e-16 ***
this_statusInactive student         0.643392   0.140127   4.591 4.40e-06 ***
this_statusUnemployed               2.410940   0.055531  43.416  &lt; 2e-16 ***
age_group25-44                      0.572001   0.076125   7.514 5.73e-14 ***
age_group45-54                      0.901074   0.077535  11.622  &lt; 2e-16 ***
age_group55-64                      0.451309   0.080003   5.641 1.69e-08 ***
sexmale                             0.229690   0.034090   6.738 1.61e-11 ***
hascar                             -0.555532   0.035047 -15.851  &lt; 2e-16 ***
eth_simplifiedWhite                 0.374324   0.042506   8.806  &lt; 2e-16 ***
mh                                 -0.044757   0.001315 -34.036  &lt; 2e-16 ***
ph                                 -0.071427   0.001327 -53.846  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 82752  on 243719  degrees of freedom
Residual deviance: 30987  on 243705  degrees of freedom
  (103655 observations deleted due to missingness)
AIC: 31017

Number of Fisher Scoring iterations: 8</code></pre>
</div>
</div>
<p>Finally lets look at both health and lti</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>mod_history_demographics_car_health <span class="ot">&lt;-</span> <span class="fu">glm</span>(</span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  becomes_eilts <span class="sc">~</span> this_status <span class="sc">+</span> age_group <span class="sc">+</span> sex <span class="sc">+</span> eth_simplified <span class="sc">+</span> hascar <span class="sc">+</span> mh <span class="sc">+</span> ph <span class="sc">+</span> lti, </span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>   <span class="at">data =</span> data_tidied, </span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>   <span class="at">family =</span> binomial</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod_history_demographics_car_health)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = becomes_eilts ~ this_status + age_group + sex + 
    eth_simplified + hascar + mh + ph + lti, family = binomial, 
    data = data_tidied)

Coefficients:
                                    Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                        -1.998743   0.148004 -13.505  &lt; 2e-16 ***
this_statusInactive care            1.456753   0.066737  21.828  &lt; 2e-16 ***
this_statusInactive long term sick  4.524810   0.052024  86.975  &lt; 2e-16 ***
this_statusInactive other           1.921301   0.141816  13.548  &lt; 2e-16 ***
this_statusInactive retired         1.125488   0.075513  14.905  &lt; 2e-16 ***
this_statusInactive student         0.720100   0.140736   5.117 3.11e-07 ***
this_statusUnemployed               2.339414   0.056058  41.732  &lt; 2e-16 ***
age_group25-44                      0.477625   0.078062   6.119 9.44e-10 ***
age_group45-54                      0.755825   0.079423   9.516  &lt; 2e-16 ***
age_group55-64                      0.304891   0.081493   3.741 0.000183 ***
sexmale                             0.212207   0.034089   6.225 4.81e-10 ***
eth_simplifiedWhite                 0.290800   0.043041   6.756 1.42e-11 ***
hascar                             -0.522201   0.035132 -14.864  &lt; 2e-16 ***
mh                                 -0.036517   0.001341 -27.236  &lt; 2e-16 ***
ph                                 -0.057356   0.001408 -40.739  &lt; 2e-16 ***
ltiyes                              1.297349   0.051534  25.174  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 82687  on 243549  degrees of freedom
Residual deviance: 30229  on 243534  degrees of freedom
  (103825 observations deleted due to missingness)
AIC: 30261

Number of Fisher Scoring iterations: 8</code></pre>
</div>
</div>
<p>But is the AIC of including both types of health better than just sf12 or lti?</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a><span class="fu">AIC</span>(mod_history_demographics_car_sf12, mod_history_demographics_car_lti, mod_history_demographics_car_health)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>                                    df      AIC
mod_history_demographics_car_sf12   15 31016.72
mod_history_demographics_car_lti    14 39089.14
mod_history_demographics_car_health 16 30260.91</code></pre>
</div>
</div>
<p>The number of observations arent exactly the same, so we cant directly compare AICs. However, the AIC of the model with both types of health is lower than the AIC of the model with just one type of health. However it appears that the sf12 derived variables are more useful than the lti/no lti binary variable</p>
<p>So lets use mh and ph, before moving onto the next block of variables: household</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>mod_history_demographics_health_car_hhchildren <span class="ot">&lt;-</span> <span class="fu">glm</span>(</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>  becomes_eilts <span class="sc">~</span> this_status <span class="sc">+</span> age_group <span class="sc">+</span> sex <span class="sc">+</span> eth_simplified <span class="sc">+</span> lti <span class="sc">+</span> mh <span class="sc">+</span> ph <span class="sc">+</span> has_children, </span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>   <span class="at">data =</span> data_tidied, </span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>   <span class="at">family =</span> binomial</span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod_history_demographics_health_car_hhchildren)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = becomes_eilts ~ this_status + age_group + sex + 
    eth_simplified + lti + mh + ph + has_children, family = binomial, 
    data = data_tidied)

Coefficients:
                                    Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                        -2.126822   0.145400 -14.627  &lt; 2e-16 ***
this_statusInactive care            1.616602   0.066401  24.346  &lt; 2e-16 ***
this_statusInactive long term sick  4.633204   0.050543  91.668  &lt; 2e-16 ***
this_statusInactive other           1.951821   0.140017  13.940  &lt; 2e-16 ***
this_statusInactive retired         1.139327   0.073956  15.406  &lt; 2e-16 ***
this_statusInactive student         0.808770   0.139328   5.805 6.45e-09 ***
this_statusUnemployed               2.491928   0.053899  46.234  &lt; 2e-16 ***
age_group25-44                      0.515059   0.077150   6.676 2.45e-11 ***
age_group45-54                      0.676430   0.078712   8.594  &lt; 2e-16 ***
age_group55-64                      0.148588   0.081717   1.818    0.069 .  
sexmale                             0.192425   0.033656   5.717 1.08e-08 ***
eth_simplifiedWhite                 0.212236   0.042596   4.983 6.28e-07 ***
ltiyes                              1.294258   0.050967  25.394  &lt; 2e-16 ***
mh                                 -0.037514   0.001322 -28.379  &lt; 2e-16 ***
ph                                 -0.057109   0.001387 -41.188  &lt; 2e-16 ***
has_childrenTRUE                   -0.402256   0.038110 -10.555  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 84625  on 248916  degrees of freedom
Residual deviance: 31047  on 248901  degrees of freedom
  (98458 observations deleted due to missingness)
AIC: 31079

Number of Fisher Scoring iterations: 8</code></pre>
</div>
</div>
<p>Now hh category</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>mod_history_demographics_health_car_hhtype <span class="ot">&lt;-</span> <span class="fu">glm</span>(</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>  becomes_eilts <span class="sc">~</span> this_status <span class="sc">+</span> age_group <span class="sc">+</span> sex <span class="sc">+</span> hascar <span class="sc">+</span> eth_simplified <span class="sc">+</span> lti <span class="sc">+</span> mh <span class="sc">+</span> ph <span class="sc">+</span> hh_type, </span>
<span id="cb29-3"><a href="#cb29-3" aria-hidden="true" tabindex="-1"></a>   <span class="at">data =</span> data_tidied, </span>
<span id="cb29-4"><a href="#cb29-4" aria-hidden="true" tabindex="-1"></a>   <span class="at">family =</span> binomial</span>
<span id="cb29-5"><a href="#cb29-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb29-6"><a href="#cb29-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb29-7"><a href="#cb29-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod_history_demographics_health_car_hhtype)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = becomes_eilts ~ this_status + age_group + sex + 
    hascar + eth_simplified + lti + mh + ph + hh_type, family = binomial, 
    data = data_tidied)

Coefficients:
                                       Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                           -1.444565   0.203602  -7.095 1.29e-12 ***
this_statusInactive care               1.486190   0.084503  17.588  &lt; 2e-16 ***
this_statusInactive long term sick     4.395104   0.063427  69.294  &lt; 2e-16 ***
this_statusInactive other              1.957847   0.173866  11.261  &lt; 2e-16 ***
this_statusInactive retired            1.229633   0.091304  13.467  &lt; 2e-16 ***
this_statusInactive student            0.928661   0.189587   4.898 9.67e-07 ***
this_statusUnemployed                  2.256186   0.069163  32.621  &lt; 2e-16 ***
age_group25-44                         0.678116   0.125470   5.405 6.49e-08 ***
age_group45-54                         0.913669   0.128504   7.110 1.16e-12 ***
age_group55-64                         0.572838   0.133064   4.305 1.67e-05 ***
sexmale                                0.093554   0.043920   2.130   0.0332 *  
hascar                                -0.486297   0.047316 -10.278  &lt; 2e-16 ***
eth_simplifiedWhite                    0.224398   0.056841   3.948 7.89e-05 ***
ltiyes                                 1.235665   0.063929  19.329  &lt; 2e-16 ***
mh                                    -0.038245   0.001652 -23.150  &lt; 2e-16 ***
ph                                    -0.060273   0.001723 -34.989  &lt; 2e-16 ***
hh_typeSmall Adult                    -0.376975   0.059776  -6.306 2.85e-10 ***
hh_typeSingle Parent                  -0.429186   0.077776  -5.518 3.42e-08 ***
hh_typeFamily with 1-2 Children       -0.596903   0.067558  -8.835  &lt; 2e-16 ***
hh_typeFamily with 3 or more Children -0.775609   0.095714  -8.103 5.34e-16 ***
hh_typeSingle Pensioner               -1.074282   0.116606  -9.213  &lt; 2e-16 ***
hh_typePensioner Couple               -0.894505   0.081699 -10.949  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 55849  on 166110  degrees of freedom
Residual deviance: 20011  on 166089  degrees of freedom
  (181264 observations deleted due to missingness)
AIC: 20055

Number of Fisher Scoring iterations: 8</code></pre>
</div>
</div>
<p>Now qualifications, which we think is the last block</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>mod_history_demographics_health_car_hhtype_qual <span class="ot">&lt;-</span> <span class="fu">glm</span>(</span>
<span id="cb31-2"><a href="#cb31-2" aria-hidden="true" tabindex="-1"></a>  becomes_eilts <span class="sc">~</span> this_status <span class="sc">+</span> age_group <span class="sc">+</span> sex <span class="sc">+</span> hascar <span class="sc">+</span> eth_simplified <span class="sc">+</span> lti <span class="sc">+</span> mh <span class="sc">+</span> ph <span class="sc">+</span> hh_type <span class="sc">+</span> hiqual_dv, </span>
<span id="cb31-3"><a href="#cb31-3" aria-hidden="true" tabindex="-1"></a>   <span class="at">data =</span> data_tidied, </span>
<span id="cb31-4"><a href="#cb31-4" aria-hidden="true" tabindex="-1"></a>   <span class="at">family =</span> binomial</span>
<span id="cb31-5"><a href="#cb31-5" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb31-6"><a href="#cb31-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb31-7"><a href="#cb31-7" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod_history_demographics_health_car_hhtype_qual)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = becomes_eilts ~ this_status + age_group + sex + 
    hascar + eth_simplified + lti + mh + ph + hh_type + hiqual_dv, 
    family = binomial, data = data_tidied)

Coefficients:
                                       Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                           -1.489855   0.209272  -7.119 1.09e-12 ***
this_statusInactive care               1.383321   0.085565  16.167  &lt; 2e-16 ***
this_statusInactive long term sick     4.292269   0.064163  66.896  &lt; 2e-16 ***
this_statusInactive other              1.907683   0.174489  10.933  &lt; 2e-16 ***
this_statusInactive retired            1.188993   0.091991  12.925  &lt; 2e-16 ***
this_statusInactive student            0.911707   0.191371   4.764 1.90e-06 ***
this_statusUnemployed                  2.159671   0.070122  30.799  &lt; 2e-16 ***
age_group25-44                         0.714528   0.127378   5.609 2.03e-08 ***
age_group45-54                         0.922738   0.130664   7.062 1.64e-12 ***
age_group55-64                         0.545290   0.135435   4.026 5.67e-05 ***
sexmale                                0.076076   0.044292   1.718  0.08587 .  
hascar                                -0.394998   0.048476  -8.148 3.69e-16 ***
eth_simplifiedWhite                    0.181965   0.057622   3.158  0.00159 ** 
ltiyes                                 1.227335   0.064174  19.125  &lt; 2e-16 ***
mh                                    -0.037589   0.001659 -22.662  &lt; 2e-16 ***
ph                                    -0.059200   0.001737 -34.079  &lt; 2e-16 ***
hh_typeSmall Adult                    -0.400592   0.060216  -6.653 2.88e-11 ***
hh_typeSingle Parent                  -0.468823   0.078287  -5.989 2.12e-09 ***
hh_typeFamily with 1-2 Children       -0.605993   0.067919  -8.922  &lt; 2e-16 ***
hh_typeFamily with 3 or more Children -0.824808   0.096061  -8.586  &lt; 2e-16 ***
hh_typeSingle Pensioner               -1.125300   0.116953  -9.622  &lt; 2e-16 ***
hh_typePensioner Couple               -0.951806   0.082293 -11.566  &lt; 2e-16 ***
hiqual_dvDegree                       -0.336396   0.073994  -4.546 5.46e-06 ***
hiqual_dvGCSE etc                      0.111135   0.061660   1.802  0.07149 .  
hiqual_dvNo qualification              0.342377   0.066033   5.185 2.16e-07 ***
hiqual_dvOther higher degree          -0.137755   0.080659  -1.708  0.08766 .  
hiqual_dvOther qualification           0.198317   0.071517   2.773  0.00555 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 55525  on 164794  degrees of freedom
Residual deviance: 19821  on 164768  degrees of freedom
  (182580 observations deleted due to missingness)
AIC: 19875

Number of Fisher Scoring iterations: 8</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>broom<span class="sc">::</span><span class="fu">tidy</span>(mod_history_demographics_health_car_hhtype_qual) <span class="sc">|&gt;</span> <span class="fu">write.csv</span>(<span class="st">"final_model_results_preds_into_eilts.csv"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>We now have a series of models, organised into blocks, which build up in complexity incrementally. Each appears to increase the proportion explained. Lets use Nagelkerkes R^2 to compare the models</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb34"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>fmsb<span class="sc">::</span><span class="fu">NagelkerkeR2</span>(mod_null)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$N
[1] 284718

$R2
[1] 5.303035e-12</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb36"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>fmsb<span class="sc">::</span><span class="fu">NagelkerkeR2</span>(mod_history)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$N
[1] 284718

$R2
[1] 0.6118141</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb38"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>fmsb<span class="sc">::</span><span class="fu">NagelkerkeR2</span>(mod_history_demographics)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$N
[1] 284024

$R2
[1] 0.6175377</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb40"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>fmsb<span class="sc">::</span><span class="fu">NagelkerkeR2</span>(mod_history_demographics_hascar)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$N
[1] 274673

$R2
[1] 0.6209505</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb42"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>fmsb<span class="sc">::</span><span class="fu">NagelkerkeR2</span>(mod_history_demographics_car_health)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$N
[1] 243550

$R2
[1] 0.6731046</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>fmsb<span class="sc">::</span><span class="fu">NagelkerkeR2</span>(mod_history_demographics_health_car_hhchildren) <span class="co"># slightly worse than previous</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$N
[1] 248917

$R2
[1] 0.6719252</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>fmsb<span class="sc">::</span><span class="fu">NagelkerkeR2</span>(mod_history_demographics_health_car_hhtype)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$N
[1] 166111

$R2
[1] 0.6796468</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>fmsb<span class="sc">::</span><span class="fu">NagelkerkeR2</span>(mod_history_demographics_health_car_hhtype_qual)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$N
[1] 164795

$R2
[1] 0.6810013</code></pre>
</div>
</div>
<p>Now to make this a table</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>label_and_return_nr2 <span class="ot">&lt;-</span> <span class="cf">function</span>(label, model){</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  nr2 <span class="ot">&lt;-</span> fmsb<span class="sc">::</span><span class="fu">NagelkerkeR2</span>(model)</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="fu">tibble</span>(<span class="at">label =</span> label, <span class="at">nr2 =</span> nr2<span class="sc">$</span>R2)</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>nr2s <span class="ot">&lt;-</span> <span class="fu">bind_rows</span>(</span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">label_and_return_nr2</span>(<span class="st">"null"</span>, mod_null),</span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">label_and_return_nr2</span>(<span class="st">"history"</span>, mod_history),</span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">label_and_return_nr2</span>(<span class="st">"history_demographics"</span>, mod_history_demographics),</span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">label_and_return_nr2</span>(<span class="st">"history_demographics_hascar"</span>, mod_history_demographics_hascar),</span>
<span id="cb50-11"><a href="#cb50-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">label_and_return_nr2</span>(<span class="st">"history_demographics_car_health"</span>, mod_history_demographics_car_health),</span>
<span id="cb50-12"><a href="#cb50-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">label_and_return_nr2</span>(<span class="st">"history_demographics_health_car_hhchildren"</span>, mod_history_demographics_health_car_hhchildren),</span>
<span id="cb50-13"><a href="#cb50-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">label_and_return_nr2</span>(<span class="st">"history_demographics_health_car_hhtype"</span>, mod_history_demographics_health_car_hhtype),</span>
<span id="cb50-14"><a href="#cb50-14" aria-hidden="true" tabindex="-1"></a>  <span class="fu">label_and_return_nr2</span>(<span class="st">"history_demographics_health_car_hhtype_qual"</span>, mod_history_demographics_health_car_hhtype_qual)</span>
<span id="cb50-15"><a href="#cb50-15" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb50-16"><a href="#cb50-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-17"><a href="#cb50-17" aria-hidden="true" tabindex="-1"></a>nr2s <span class="sc">|&gt;</span> <span class="fu">write.csv</span>(<span class="st">"nagelkerke_r2s.csv"</span>)</span>
<span id="cb50-18"><a href="#cb50-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb50-19"><a href="#cb50-19" aria-hidden="true" tabindex="-1"></a>nr2s <span class="sc">|&gt;</span> <span class="fu">kable</span>() <span class="sc">|&gt;</span> <span class="fu">kable_styling</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table class="table table-sm table-striped small" data-quarto-postprocess="true">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">label</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">nr2</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">null</td>
<td style="text-align: right;">0.0000000</td>
</tr>
<tr class="even">
<td style="text-align: left;">history</td>
<td style="text-align: right;">0.6118141</td>
</tr>
<tr class="odd">
<td style="text-align: left;">history_demographics</td>
<td style="text-align: right;">0.6175377</td>
</tr>
<tr class="even">
<td style="text-align: left;">history_demographics_hascar</td>
<td style="text-align: right;">0.6209505</td>
</tr>
<tr class="odd">
<td style="text-align: left;">history_demographics_car_health</td>
<td style="text-align: right;">0.6731046</td>
</tr>
<tr class="even">
<td style="text-align: left;">history_demographics_health_car_hhchildren</td>
<td style="text-align: right;">0.6719252</td>
</tr>
<tr class="odd">
<td style="text-align: left;">history_demographics_health_car_hhtype</td>
<td style="text-align: right;">0.6796468</td>
</tr>
<tr class="even">
<td style="text-align: left;">history_demographics_health_car_hhtype_qual</td>
<td style="text-align: right;">0.6810013</td>
</tr>
</tbody>
</table>


</div>
</div>
<p>Lets return to the demographics block and see if we can do better (using the spec previously arrived at )</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>mod_history_demographics_better <span class="ot">&lt;-</span> <span class="fu">glm</span>(becomes_eilts <span class="sc">~</span> this_status <span class="sc">*</span> sex <span class="sc">+</span> splines<span class="sc">::</span><span class="fu">bs</span>(age, <span class="dv">5</span>) <span class="sc">+</span> sex <span class="sc">+</span> eth_simplified, <span class="at">data =</span> data_tidied, <span class="at">family =</span> binomial)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mod_history_demographics_better)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = becomes_eilts ~ this_status * sex + splines::bs(age, 
    5) + sex + eth_simplified, family = binomial, data = data_tidied)

Coefficients:
                                           Estimate Std. Error z value Pr(&gt;|z|)
(Intercept)                                -7.29911    0.15367 -47.497  &lt; 2e-16
this_statusInactive care                    2.00969    0.06578  30.553  &lt; 2e-16
this_statusInactive long term sick          6.48097    0.05583 116.075  &lt; 2e-16
this_statusInactive other                   2.30230    0.16892  13.630  &lt; 2e-16
this_statusInactive retired                 1.98284    0.08890  22.305  &lt; 2e-16
this_statusInactive student                 1.18139    0.15326   7.709 1.27e-14
this_statusUnemployed                       3.20384    0.06413  49.959  &lt; 2e-16
sexmale                                    -0.17094    0.07176  -2.382 0.017213
splines::bs(age, 5)1                        1.07505    0.22816   4.712 2.45e-06
splines::bs(age, 5)2                        1.39106    0.14643   9.500  &lt; 2e-16
splines::bs(age, 5)3                        1.84290    0.18022  10.226  &lt; 2e-16
splines::bs(age, 5)4                        2.53725    0.15095  16.809  &lt; 2e-16
splines::bs(age, 5)5                        0.47966    0.15986   3.000 0.002695
eth_simplifiedWhite                         0.23946    0.03439   6.964 3.31e-12
this_statusInactive care:sexmale            0.31402    0.18442   1.703 0.088620
this_statusInactive long term sick:sexmale  0.31299    0.08365   3.742 0.000183
this_statusInactive other:sexmale           0.56931    0.24269   2.346 0.018985
this_statusInactive retired:sexmale         0.62219    0.12161   5.116 3.11e-07
this_statusInactive student:sexmale         0.39506    0.20453   1.932 0.053418
this_statusUnemployed:sexmale               0.15391    0.09239   1.666 0.095743
                                              
(Intercept)                                ***
this_statusInactive care                   ***
this_statusInactive long term sick         ***
this_statusInactive other                  ***
this_statusInactive retired                ***
this_statusInactive student                ***
this_statusUnemployed                      ***
sexmale                                    *  
splines::bs(age, 5)1                       ***
splines::bs(age, 5)2                       ***
splines::bs(age, 5)3                       ***
splines::bs(age, 5)4                       ***
splines::bs(age, 5)5                       ** 
eth_simplifiedWhite                        ***
this_statusInactive care:sexmale           .  
this_statusInactive long term sick:sexmale ***
this_statusInactive other:sexmale          *  
this_statusInactive retired:sexmale        ***
this_statusInactive student:sexmale        .  
this_statusUnemployed:sexmale              .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 102697  on 284023  degrees of freedom
Residual deviance:  43199  on 284004  degrees of freedom
  (63351 observations deleted due to missingness)
AIC: 43239

Number of Fisher Scoring iterations: 8</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>fmsb<span class="sc">::</span><span class="fu">NagelkerkeR2</span>(mod_history_demographics_better)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$N
[1] 284024

$R2
[1] 0.6228821</code></pre>
</div>
</div>
<p>Lets now look at the stepwise AIC approach to see if similar variables are selected</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>complete_data <span class="ot">&lt;-</span> data_tidied <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">complete.cases</span>(.))</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a>new_mod_null <span class="ot">&lt;-</span> <span class="fu">glm</span>(becomes_eilts <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> complete_data, <span class="at">family =</span> binomial)</span>
<span id="cb55-5"><a href="#cb55-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-6"><a href="#cb55-6" aria-hidden="true" tabindex="-1"></a>new_mod_history_demographics <span class="ot">&lt;-</span>  <span class="fu">glm</span>(becomes_eilts <span class="sc">~</span> this_status <span class="sc">+</span> age_group <span class="sc">+</span> sex <span class="sc">+</span> eth_simplified, <span class="at">data =</span> complete_data, <span class="at">family =</span> binomial)</span>
<span id="cb55-7"><a href="#cb55-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-8"><a href="#cb55-8" aria-hidden="true" tabindex="-1"></a>new_mod_history_demographics_health_car_hhtype_qual <span class="ot">&lt;-</span> <span class="fu">glm</span>(</span>
<span id="cb55-9"><a href="#cb55-9" aria-hidden="true" tabindex="-1"></a>  becomes_eilts <span class="sc">~</span> this_status <span class="sc">+</span> age_group <span class="sc">+</span> sex <span class="sc">+</span> hascar <span class="sc">+</span> eth_simplified <span class="sc">+</span> lti <span class="sc">+</span> mh <span class="sc">+</span> ph <span class="sc">+</span> hh_type <span class="sc">+</span> hiqual_dv, </span>
<span id="cb55-10"><a href="#cb55-10" aria-hidden="true" tabindex="-1"></a>   <span class="at">data =</span> complete_data, </span>
<span id="cb55-11"><a href="#cb55-11" aria-hidden="true" tabindex="-1"></a>   <span class="at">family =</span> binomial</span>
<span id="cb55-12"><a href="#cb55-12" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb55-13"><a href="#cb55-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb55-14"><a href="#cb55-14" aria-hidden="true" tabindex="-1"></a>mdl_stepAIC <span class="ot">&lt;-</span> <span class="fu">step</span>(new_mod_history_demographics, <span class="at">direction =</span> <span class="st">"both"</span>, <span class="at">scope =</span> <span class="fu">list</span>(<span class="at">lower =</span> new_mod_null, <span class="at">upper =</span> new_mod_history_demographics_health_car_hhtype_qual))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=23518.89
becomes_eilts ~ this_status + age_group + sex + eth_simplified

                 Df Deviance   AIC
+ ph              1    21774 21800
+ lti             1    21851 21877
+ mh              1    22825 22851
+ hh_type         6    23117 23153
+ hiqual_dv       5    23225 23259
+ hascar          1    23244 23270
- sex             1    23495 23517
&lt;none&gt;                 23495 23519
- eth_simplified  1    23500 23522
- age_group       3    23764 23782
- this_status     6    53511 53523

Step:  AIC=21800.33
becomes_eilts ~ this_status + age_group + sex + eth_simplified + 
    ph

                 Df Deviance   AIC
+ mh              1    20839 20867
+ lti             1    20977 21005
+ hh_type         6    21273 21311
+ hascar          1    21436 21464
+ hiqual_dv       5    21591 21627
&lt;none&gt;                 21774 21800
- sex             1    21779 21803
- eth_simplified  1    21785 21809
- age_group       3    21949 21969
- ph              1    23495 23519
- this_status     6    37059 37073

Step:  AIC=20866.64
becomes_eilts ~ this_status + age_group + sex + eth_simplified + 
    ph + mh

                 Df Deviance   AIC
+ lti             1    20367 20397
+ hh_type         6    20440 20480
+ hascar          1    20577 20607
+ hiqual_dv       5    20695 20733
&lt;none&gt;                 20839 20867
- eth_simplified  1    20851 20877
- sex             1    20868 20894
- age_group       3    20968 20990
- mh              1    21774 21800
- ph              1    22825 22851
- this_status     6    31449 31465

Step:  AIC=20396.82
becomes_eilts ~ this_status + age_group + sex + eth_simplified + 
    ph + mh + lti

                 Df Deviance   AIC
+ hh_type         6    20024 20066
+ hascar          1    20138 20170
+ hiqual_dv       5    20231 20271
&lt;none&gt;                 20367 20397
- eth_simplified  1    20372 20400
- sex             1    20392 20420
- age_group       3    20471 20495
- lti             1    20839 20867
- mh              1    20977 21005
- ph              1    21497 21525
- this_status     6    29985 30003

Step:  AIC=20065.83
becomes_eilts ~ this_status + age_group + sex + eth_simplified + 
    ph + mh + lti + hh_type

                 Df Deviance   AIC
+ hiqual_dv       5    19886 19938
+ hascar          1    19920 19964
&lt;none&gt;                 20024 20066
- sex             1    20030 20070
- eth_simplified  1    20033 20073
- age_group       3    20093 20129
- hh_type         6    20367 20397
- lti             1    20440 20480
- mh              1    20574 20614
- ph              1    21243 21283
- this_status     6    28682 28712

Step:  AIC=19938.15
becomes_eilts ~ this_status + age_group + sex + eth_simplified + 
    ph + mh + lti + hh_type + hiqual_dv

                 Df Deviance   AIC
+ hascar          1    19820 19874
&lt;none&gt;                 19886 19938
- sex             1    19890 19940
- eth_simplified  1    19892 19942
- age_group       3    19966 20012
- hiqual_dv       5    20024 20066
- hh_type         6    20231 20271
- lti             1    20295 20345
- mh              1    20411 20461
- ph              1    21045 21095
- this_status     6    27646 27686

Step:  AIC=19874.06
becomes_eilts ~ this_status + age_group + sex + eth_simplified + 
    ph + mh + lti + hh_type + hiqual_dv + hascar

                 Df Deviance   AIC
&lt;none&gt;                 19820 19874
- sex             1    19823 19875
- eth_simplified  1    19830 19882
- hascar          1    19886 19938
- age_group       3    19903 19951
- hiqual_dv       5    19920 19964
- hh_type         6    20059 20101
- lti             1    20221 20273
- mh              1    20335 20387
- ph              1    21011 21063
- this_status     6    27063 27105</code></pre>
</div>
</div>
<p>Lets see the final specification arrived at</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mdl_stepAIC)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = becomes_eilts ~ this_status + age_group + sex + 
    eth_simplified + ph + mh + lti + hh_type + hiqual_dv + hascar, 
    family = binomial, data = complete_data)

Coefficients:
                                       Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                           -1.489860   0.209268  -7.119 1.08e-12 ***
this_statusInactive care               1.383259   0.085565  16.166  &lt; 2e-16 ***
this_statusInactive long term sick     4.292131   0.064162  66.895  &lt; 2e-16 ***
this_statusInactive other              1.909042   0.174523  10.939  &lt; 2e-16 ***
this_statusInactive retired            1.189942   0.091990  12.936  &lt; 2e-16 ***
this_statusInactive student            0.911692   0.191369   4.764 1.90e-06 ***
this_statusUnemployed                  2.159479   0.070123  30.796  &lt; 2e-16 ***
age_group25-44                         0.714655   0.127377   5.611 2.02e-08 ***
age_group45-54                         0.922760   0.130662   7.062 1.64e-12 ***
age_group55-64                         0.545435   0.135433   4.027 5.64e-05 ***
sexmale                                0.076283   0.044294   1.722  0.08503 .  
eth_simplifiedWhite                    0.182040   0.057622   3.159  0.00158 ** 
ph                                    -0.059198   0.001737 -34.079  &lt; 2e-16 ***
mh                                    -0.037595   0.001659 -22.666  &lt; 2e-16 ***
ltiyes                                 1.227407   0.064173  19.126  &lt; 2e-16 ***
hh_typeSmall Adult                    -0.399958   0.060224  -6.641 3.11e-11 ***
hh_typeSingle Parent                  -0.468642   0.078288  -5.986 2.15e-09 ***
hh_typeFamily with 1-2 Children       -0.605696   0.067922  -8.918  &lt; 2e-16 ***
hh_typeFamily with 3 or more Children -0.824577   0.096063  -8.584  &lt; 2e-16 ***
hh_typeSingle Pensioner               -1.125580   0.116945  -9.625  &lt; 2e-16 ***
hh_typePensioner Couple               -0.951679   0.082292 -11.565  &lt; 2e-16 ***
hiqual_dvDegree                       -0.336249   0.073996  -4.544 5.52e-06 ***
hiqual_dvGCSE etc                      0.111043   0.061661   1.801  0.07173 .  
hiqual_dvNo qualification              0.342532   0.066037   5.187 2.14e-07 ***
hiqual_dvOther higher degree          -0.137846   0.080658  -1.709  0.08745 .  
hiqual_dvOther qualification           0.198179   0.071517   2.771  0.00559 ** 
hascar                                -0.395392   0.048482  -8.155 3.48e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 55524  on 164773  degrees of freedom
Residual deviance: 19820  on 164747  degrees of freedom
AIC: 19874

Number of Fisher Scoring iterations: 8</code></pre>
</div>
</div>
<p>Lets see what happens if we ask the algorithm to prune our final model specification</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>mdl_stepAIC_pruned <span class="ot">&lt;-</span> <span class="fu">step</span>(new_mod_history_demographics_health_car_hhtype_qual, <span class="at">direction =</span> <span class="st">"backward"</span>, <span class="at">scope =</span> <span class="fu">list</span>(<span class="at">lower =</span> new_mod_null, <span class="at">upper =</span> new_mod_history_demographics_health_car_hhtype_qual))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=19874.06
becomes_eilts ~ this_status + age_group + sex + hascar + eth_simplified + 
    lti + mh + ph + hh_type + hiqual_dv

                 Df Deviance   AIC
&lt;none&gt;                 19820 19874
- sex             1    19823 19875
- eth_simplified  1    19830 19882
- hascar          1    19886 19938
- age_group       3    19903 19951
- hiqual_dv       5    19920 19964
- hh_type         6    20059 20101
- lti             1    20221 20273
- mh              1    20335 20387
- ph              1    21011 21063
- this_status     6    27063 27105</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mdl_stepAIC_pruned)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = becomes_eilts ~ this_status + age_group + sex + 
    hascar + eth_simplified + lti + mh + ph + hh_type + hiqual_dv, 
    family = binomial, data = complete_data)

Coefficients:
                                       Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                           -1.489860   0.209268  -7.119 1.08e-12 ***
this_statusInactive care               1.383259   0.085565  16.166  &lt; 2e-16 ***
this_statusInactive long term sick     4.292131   0.064162  66.895  &lt; 2e-16 ***
this_statusInactive other              1.909042   0.174523  10.939  &lt; 2e-16 ***
this_statusInactive retired            1.189942   0.091990  12.936  &lt; 2e-16 ***
this_statusInactive student            0.911692   0.191369   4.764 1.90e-06 ***
this_statusUnemployed                  2.159479   0.070123  30.796  &lt; 2e-16 ***
age_group25-44                         0.714655   0.127377   5.611 2.02e-08 ***
age_group45-54                         0.922760   0.130662   7.062 1.64e-12 ***
age_group55-64                         0.545435   0.135433   4.027 5.64e-05 ***
sexmale                                0.076283   0.044294   1.722  0.08503 .  
hascar                                -0.395392   0.048482  -8.155 3.48e-16 ***
eth_simplifiedWhite                    0.182040   0.057622   3.159  0.00158 ** 
ltiyes                                 1.227407   0.064173  19.126  &lt; 2e-16 ***
mh                                    -0.037595   0.001659 -22.666  &lt; 2e-16 ***
ph                                    -0.059198   0.001737 -34.079  &lt; 2e-16 ***
hh_typeSmall Adult                    -0.399958   0.060224  -6.641 3.11e-11 ***
hh_typeSingle Parent                  -0.468642   0.078288  -5.986 2.15e-09 ***
hh_typeFamily with 1-2 Children       -0.605696   0.067922  -8.918  &lt; 2e-16 ***
hh_typeFamily with 3 or more Children -0.824577   0.096063  -8.584  &lt; 2e-16 ***
hh_typeSingle Pensioner               -1.125580   0.116945  -9.625  &lt; 2e-16 ***
hh_typePensioner Couple               -0.951679   0.082292 -11.565  &lt; 2e-16 ***
hiqual_dvDegree                       -0.336249   0.073996  -4.544 5.52e-06 ***
hiqual_dvGCSE etc                      0.111043   0.061661   1.801  0.07173 .  
hiqual_dvNo qualification              0.342532   0.066037   5.187 2.14e-07 ***
hiqual_dvOther higher degree          -0.137846   0.080658  -1.709  0.08745 .  
hiqual_dvOther qualification           0.198179   0.071517   2.771  0.00559 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 55524  on 164773  degrees of freedom
Residual deviance: 19820  on 164747  degrees of freedom
AIC: 19874

Number of Fisher Scoring iterations: 8</code></pre>
</div>
</div>
<p>The pruned model is the same as the model we derived manually, so all variables appear essential</p>
<p>Finally, we can start with the simplest and move forwards</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>mdl_stepAIC_grown <span class="ot">&lt;-</span> <span class="fu">step</span>(new_mod_null, <span class="at">direction =</span> <span class="st">"forward"</span>, <span class="at">scope =</span> <span class="fu">list</span>(<span class="at">lower =</span> new_mod_null, <span class="at">upper =</span> new_mod_history_demographics_health_car_hhtype_qual))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=55525.76
becomes_eilts ~ 1

                 Df Deviance   AIC
+ this_status     6    23771 23785
+ ph              1    37494 37498
+ lti             1    42552 42556
+ mh              1    48351 48355
+ hiqual_dv       5    50580 50592
+ hascar          1    51287 51291
+ hh_type         6    51774 51788
+ age_group       3    53516 53524
+ eth_simplified  1    55509 55513
&lt;none&gt;                 55524 55526
+ sex             1    55522 55526

Step:  AIC=23784.67
becomes_eilts ~ this_status

                 Df Deviance   AIC
+ ph              1    21961 21977
+ lti             1    22004 22020
+ mh              1    23139 23155
+ hh_type         6    23331 23357
+ hiqual_dv       5    23494 23518
+ age_group       3    23500 23520
+ hascar          1    23563 23579
+ eth_simplified  1    23764 23780
&lt;none&gt;                 23771 23785
+ sex             1    23770 23786

Step:  AIC=21976.79
becomes_eilts ~ this_status + ph

                 Df Deviance   AIC
+ mh              1    21011 21029
+ lti             1    21120 21138
+ hh_type         6    21411 21439
+ hascar          1    21653 21671
+ age_group       3    21790 21812
+ hiqual_dv       5    21795 21821
+ eth_simplified  1    21953 21971
+ sex             1    21956 21974
&lt;none&gt;                 21961 21977

Step:  AIC=21029.14
becomes_eilts ~ this_status + ph + mh

                 Df Deviance   AIC
+ lti             1    20500 20520
+ hh_type         6    20549 20579
+ hascar          1    20778 20798
+ hiqual_dv       5    20872 20900
+ age_group       3    20881 20905
+ sex             1    20979 20999
+ eth_simplified  1    21000 21020
&lt;none&gt;                 21011 21029

Step:  AIC=20520.09
becomes_eilts ~ this_status + ph + mh + lti

                 Df Deviance   AIC
+ hh_type         6    20105 20137
+ hascar          1    20292 20314
+ hiqual_dv       5    20374 20404
+ age_group       3    20397 20423
+ sex             1    20476 20498
+ eth_simplified  1    20496 20518
&lt;none&gt;                 20500 20520

Step:  AIC=20137.17
becomes_eilts ~ this_status + ph + mh + lti + hh_type

                 Df Deviance   AIC
+ hiqual_dv       5    19973 20015
+ hascar          1    20014 20048
+ age_group       3    20039 20077
+ eth_simplified  1    20097 20131
+ sex             1    20101 20135
&lt;none&gt;                 20105 20137

Step:  AIC=20014.87
becomes_eilts ~ this_status + ph + mh + lti + hh_type + hiqual_dv

                 Df Deviance   AIC
+ age_group       3    19896 19944
+ hascar          1    19914 19958
+ eth_simplified  1    19968 20012
+ sex             1    19971 20015
&lt;none&gt;                 19973 20015

Step:  AIC=19943.58
becomes_eilts ~ this_status + ph + mh + lti + hh_type + hiqual_dv + 
    age_group

                 Df Deviance   AIC
+ hascar          1    19833 19883
+ eth_simplified  1    19890 19940
+ sex             1    19892 19942
&lt;none&gt;                 19896 19944

Step:  AIC=19883.08
becomes_eilts ~ this_status + ph + mh + lti + hh_type + hiqual_dv + 
    age_group + hascar

                 Df Deviance   AIC
+ eth_simplified  1    19823 19875
+ sex             1    19830 19882
&lt;none&gt;                 19833 19883

Step:  AIC=19875.02
becomes_eilts ~ this_status + ph + mh + lti + hh_type + hiqual_dv + 
    age_group + hascar + eth_simplified

       Df Deviance   AIC
+ sex   1    19820 19874
&lt;none&gt;       19823 19875

Step:  AIC=19874.06
becomes_eilts ~ this_status + ph + mh + lti + hh_type + hiqual_dv + 
    age_group + hascar + eth_simplified + sex</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mdl_stepAIC_grown)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = becomes_eilts ~ this_status + ph + mh + lti + hh_type + 
    hiqual_dv + age_group + hascar + eth_simplified + sex, family = binomial, 
    data = complete_data)

Coefficients:
                                       Estimate Std. Error z value Pr(&gt;|z|)    
(Intercept)                           -1.489860   0.209268  -7.119 1.08e-12 ***
this_statusInactive care               1.383259   0.085565  16.166  &lt; 2e-16 ***
this_statusInactive long term sick     4.292131   0.064162  66.895  &lt; 2e-16 ***
this_statusInactive other              1.909042   0.174523  10.939  &lt; 2e-16 ***
this_statusInactive retired            1.189942   0.091990  12.936  &lt; 2e-16 ***
this_statusInactive student            0.911692   0.191369   4.764 1.90e-06 ***
this_statusUnemployed                  2.159479   0.070123  30.796  &lt; 2e-16 ***
ph                                    -0.059198   0.001737 -34.079  &lt; 2e-16 ***
mh                                    -0.037595   0.001659 -22.666  &lt; 2e-16 ***
ltiyes                                 1.227407   0.064173  19.126  &lt; 2e-16 ***
hh_typeSmall Adult                    -0.399958   0.060224  -6.641 3.11e-11 ***
hh_typeSingle Parent                  -0.468642   0.078288  -5.986 2.15e-09 ***
hh_typeFamily with 1-2 Children       -0.605696   0.067922  -8.918  &lt; 2e-16 ***
hh_typeFamily with 3 or more Children -0.824577   0.096063  -8.584  &lt; 2e-16 ***
hh_typeSingle Pensioner               -1.125580   0.116945  -9.625  &lt; 2e-16 ***
hh_typePensioner Couple               -0.951679   0.082292 -11.565  &lt; 2e-16 ***
hiqual_dvDegree                       -0.336249   0.073996  -4.544 5.52e-06 ***
hiqual_dvGCSE etc                      0.111043   0.061661   1.801  0.07173 .  
hiqual_dvNo qualification              0.342532   0.066037   5.187 2.14e-07 ***
hiqual_dvOther higher degree          -0.137846   0.080658  -1.709  0.08745 .  
hiqual_dvOther qualification           0.198179   0.071517   2.771  0.00559 ** 
age_group25-44                         0.714655   0.127377   5.611 2.02e-08 ***
age_group45-54                         0.922760   0.130662   7.062 1.64e-12 ***
age_group55-64                         0.545435   0.135433   4.027 5.64e-05 ***
hascar                                -0.395392   0.048482  -8.155 3.48e-16 ***
eth_simplifiedWhite                    0.182040   0.057622   3.159  0.00158 ** 
sexmale                                0.076283   0.044294   1.722  0.08503 .  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 55524  on 164773  degrees of freedom
Residual deviance: 19820  on 164747  degrees of freedom
AIC: 19874

Number of Fisher Scoring iterations: 8</code></pre>
</div>
</div>
<p>Once again we end up with the same model as we derived manually, so all variables appear essential.</p>
<p>Finally, for now, well look at just those who start off in the unemployed category. This means the history variable is no longer needed as everyones history is now the same</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>data_tidied_unemployed <span class="ot">&lt;-</span> data_tidied <span class="sc">|&gt;</span> <span class="fu">filter</span>(this_status <span class="sc">==</span> <span class="st">"Unemployed"</span>) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">complete.cases</span>(.))</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>mod_unemployed_null <span class="ot">&lt;-</span>  <span class="fu">glm</span>(becomes_eilts <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> data_tidied_unemployed, <span class="at">family =</span> binomial)</span>
<span id="cb67-4"><a href="#cb67-4" aria-hidden="true" tabindex="-1"></a>mod_unemployed_demographics <span class="ot">&lt;-</span> <span class="fu">glm</span>(becomes_eilts <span class="sc">~</span> age_group <span class="sc">+</span> sex <span class="sc">+</span> eth_simplified, <span class="at">data =</span> data_tidied_unemployed, <span class="at">family =</span> binomial)</span>
<span id="cb67-5"><a href="#cb67-5" aria-hidden="true" tabindex="-1"></a>mod_unemployed_full <span class="ot">&lt;-</span>  <span class="fu">glm</span>(becomes_eilts <span class="sc">~</span>  age_group <span class="sc">+</span> sex <span class="sc">+</span> hascar <span class="sc">+</span> eth_simplified <span class="sc">+</span> lti <span class="sc">+</span> mh <span class="sc">+</span> ph <span class="sc">+</span> hh_type <span class="sc">+</span> hiqual_dv <span class="sc">+</span> eq_net_income, <span class="at">data =</span> data_tidied_unemployed, <span class="at">family =</span> binomial) <span class="co"># this time with income </span></span>
<span id="cb67-6"><a href="#cb67-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-7"><a href="#cb67-7" aria-hidden="true" tabindex="-1"></a><span class="co"># first step backwards with the full model, </span></span>
<span id="cb67-8"><a href="#cb67-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb67-9"><a href="#cb67-9" aria-hidden="true" tabindex="-1"></a>mdl_stepAIC_unemployed_pruned <span class="ot">&lt;-</span> <span class="fu">step</span>(mod_unemployed_full, <span class="at">direction =</span> <span class="st">"backward"</span>, <span class="at">scope =</span> <span class="fu">list</span>(<span class="at">lower =</span> mod_unemployed_null, <span class="at">upper =</span> mod_unemployed_full))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=3454.01
becomes_eilts ~ age_group + sex + hascar + eth_simplified + lti + 
    mh + ph + hh_type + hiqual_dv + eq_net_income

                 Df Deviance    AIC
- sex             1   3410.2 3452.2
- eth_simplified  1   3410.6 3452.6
&lt;none&gt;                3410.0 3454.0
- eq_net_income   1   3418.9 3460.9
- hascar          1   3422.5 3464.5
- age_group       3   3427.3 3465.3
- hiqual_dv       5   3449.8 3483.8
- hh_type         6   3464.4 3496.4
- lti             1   3505.3 3547.3
- mh              1   3533.7 3575.7
- ph              1   3624.5 3666.5

Step:  AIC=3452.24
becomes_eilts ~ age_group + hascar + eth_simplified + lti + mh + 
    ph + hh_type + hiqual_dv + eq_net_income

                 Df Deviance    AIC
- eth_simplified  1   3410.8 3450.8
&lt;none&gt;                3410.2 3452.2
- eq_net_income   1   3419.0 3459.0
- hascar          1   3422.8 3462.8
- age_group       3   3427.6 3463.6
- hiqual_dv       5   3450.0 3482.0
- hh_type         6   3466.8 3496.8
- lti             1   3505.7 3545.7
- mh              1   3534.9 3574.9
- ph              1   3624.5 3664.5

Step:  AIC=3450.78
becomes_eilts ~ age_group + hascar + lti + mh + ph + hh_type + 
    hiqual_dv + eq_net_income

                Df Deviance    AIC
&lt;none&gt;               3410.8 3450.8
- eq_net_income  1   3419.4 3457.4
- hascar         1   3423.0 3461.0
- age_group      3   3427.9 3461.9
- hiqual_dv      5   3452.3 3482.3
- hh_type        6   3467.6 3495.6
- lti            1   3507.4 3545.4
- mh             1   3535.4 3573.4
- ph             1   3624.5 3662.5</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="co"># then step forwards from the null model</span></span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>mdl_stepAIC_unemployed_grown <span class="ot">&lt;-</span> <span class="fu">step</span>(mod_unemployed_null, <span class="at">direction =</span> <span class="st">"forward"</span>, <span class="at">scope =</span> <span class="fu">list</span>(<span class="at">lower =</span> mod_unemployed_null, <span class="at">upper =</span> mod_unemployed_full))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=4548.77
becomes_eilts ~ 1

                 Df Deviance    AIC
+ lti             1   3943.8 3947.8
+ ph              1   3955.5 3959.5
+ mh              1   4288.6 4292.6
+ hh_type         6   4378.1 4392.1
+ age_group       3   4415.0 4423.0
+ hiqual_dv       5   4428.9 4440.9
+ hascar          1   4477.3 4481.3
&lt;none&gt;                4546.8 4548.8
+ eth_simplified  1   4544.9 4548.9
+ eq_net_income   1   4546.4 4550.4
+ sex             1   4546.7 4550.7

Step:  AIC=3947.85
becomes_eilts ~ lti

                 Df Deviance    AIC
+ ph              1   3727.5 3733.5
+ mh              1   3845.1 3851.1
+ hiqual_dv       5   3858.6 3872.6
+ hh_type         6   3858.5 3874.5
+ hascar          1   3897.4 3903.4
+ age_group       3   3894.9 3904.9
&lt;none&gt;                3943.8 3947.8
+ eq_net_income   1   3942.8 3948.8
+ sex             1   3943.8 3949.8
+ eth_simplified  1   3943.8 3949.8

Step:  AIC=3733.46
becomes_eilts ~ lti + ph

                 Df Deviance    AIC
+ mh              1   3574.4 3582.4
+ hh_type         6   3633.1 3651.1
+ hascar          1   3676.2 3684.2
+ hiqual_dv       5   3676.2 3692.2
+ age_group       3   3701.4 3713.4
&lt;none&gt;                3727.5 3733.5
+ eq_net_income   1   3726.8 3734.8
+ eth_simplified  1   3727.3 3735.3
+ sex             1   3727.5 3735.5

Step:  AIC=3582.38
becomes_eilts ~ lti + ph + mh

                 Df Deviance    AIC
+ hh_type         6   3495.4 3515.4
+ hascar          1   3531.4 3541.4
+ hiqual_dv       5   3528.4 3546.4
+ age_group       3   3552.4 3566.4
+ sex             1   3571.6 3581.6
&lt;none&gt;                3574.4 3582.4
+ eq_net_income   1   3573.6 3583.6
+ eth_simplified  1   3573.9 3583.9

Step:  AIC=3515.45
becomes_eilts ~ lti + ph + mh + hh_type

                 Df Deviance    AIC
+ hiqual_dv       5   3446.5 3476.5
+ hascar          1   3477.3 3499.3
+ age_group       3   3479.8 3505.8
+ eq_net_income   1   3490.1 3512.1
&lt;none&gt;                3495.4 3515.4
+ eth_simplified  1   3494.7 3516.7
+ sex             1   3495.2 3517.2

Step:  AIC=3476.49
becomes_eilts ~ lti + ph + mh + hh_type + hiqual_dv

                 Df Deviance    AIC
+ age_group       3   3431.2 3467.2
+ hascar          1   3436.7 3468.7
+ eq_net_income   1   3438.2 3470.2
&lt;none&gt;                3446.5 3476.5
+ sex             1   3446.3 3478.3
+ eth_simplified  1   3446.5 3478.5

Step:  AIC=3467.16
becomes_eilts ~ lti + ph + mh + hh_type + hiqual_dv + age_group

                 Df Deviance    AIC
+ hascar          1   3419.4 3457.4
+ eq_net_income   1   3423.0 3461.0
&lt;none&gt;                3431.2 3467.2
+ sex             1   3431.0 3469.0
+ eth_simplified  1   3431.0 3469.0

Step:  AIC=3457.42
becomes_eilts ~ lti + ph + mh + hh_type + hiqual_dv + age_group + 
    hascar

                 Df Deviance    AIC
+ eq_net_income   1   3410.8 3450.8
&lt;none&gt;                3419.4 3457.4
+ eth_simplified  1   3419.0 3459.0
+ sex             1   3419.3 3459.3

Step:  AIC=3450.78
becomes_eilts ~ lti + ph + mh + hh_type + hiqual_dv + age_group + 
    hascar + eq_net_income

                 Df Deviance    AIC
&lt;none&gt;                3410.8 3450.8
+ eth_simplified  1   3410.2 3452.2
+ sex             1   3410.6 3452.6</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="co"># then allow stepping in either direction with the demographics model to start</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>mdl_stepAIC_unemployed_both <span class="ot">&lt;-</span> <span class="fu">step</span>(mod_unemployed_demographics, <span class="at">direction =</span> <span class="st">"both"</span>, <span class="at">scope =</span> <span class="fu">list</span>(<span class="at">lower =</span> mod_unemployed_null, <span class="at">upper =</span> mod_unemployed_full))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=4423.91
becomes_eilts ~ age_group + sex + eth_simplified

                 Df Deviance    AIC
+ lti             1   3894.5 3908.5
+ ph              1   3907.8 3921.8
+ mh              1   4148.9 4162.9
+ hh_type         6   4288.4 4312.4
+ hiqual_dv       5   4309.9 4331.9
+ hascar          1   4318.7 4332.7
- sex             1   4413.2 4423.2
- eth_simplified  1   4413.7 4423.7
&lt;none&gt;                4411.9 4423.9
+ eq_net_income   1   4411.6 4425.6
- age_group       3   4544.8 4550.8

Step:  AIC=3908.47
becomes_eilts ~ age_group + sex + eth_simplified + lti

                 Df Deviance    AIC
+ ph              1   3700.8 3716.8
+ mh              1   3786.4 3802.4
+ hiqual_dv       5   3813.1 3837.1
+ hh_type         6   3818.6 3844.6
+ hascar          1   3834.8 3850.8
- eth_simplified  1   3894.5 3906.5
- sex             1   3894.8 3906.8
&lt;none&gt;                3894.5 3908.5
+ eq_net_income   1   3893.6 3909.6
- age_group       3   3943.8 3951.8
- lti             1   4411.9 4423.9

Step:  AIC=3716.78
becomes_eilts ~ age_group + sex + eth_simplified + lti + ph

                 Df Deviance    AIC
+ mh              1   3549.7 3567.7
+ hh_type         6   3611.2 3639.2
+ hascar          1   3643.2 3661.2
+ hiqual_dv       5   3648.8 3674.8
- sex             1   3700.8 3714.8
- eth_simplified  1   3701.4 3715.4
&lt;none&gt;                3700.8 3716.8
+ eq_net_income   1   3700.2 3718.2
- age_group       3   3727.3 3737.3
- ph              1   3894.5 3908.5
- lti             1   3907.8 3921.8

Step:  AIC=3567.65
becomes_eilts ~ age_group + sex + eth_simplified + lti + ph + 
    mh

                 Df Deviance    AIC
+ hh_type         6   3478.3 3508.3
+ hascar          1   3499.5 3519.5
+ hiqual_dv       5   3505.2 3533.2
- eth_simplified  1   3550.4 3566.4
- sex             1   3551.6 3567.6
&lt;none&gt;                3549.7 3567.7
+ eq_net_income   1   3548.6 3568.6
- age_group       3   3571.2 3583.2
- lti             1   3657.6 3673.6
- mh              1   3700.8 3716.8
- ph              1   3786.4 3802.4

Step:  AIC=3508.33
becomes_eilts ~ age_group + sex + eth_simplified + lti + ph + 
    mh + hh_type

                 Df Deviance    AIC
+ hiqual_dv       5   3430.9 3470.9
+ hascar          1   3456.1 3488.1
+ eq_net_income   1   3472.9 3504.9
- sex             1   3478.6 3506.6
- eth_simplified  1   3479.6 3507.6
&lt;none&gt;                3478.3 3508.3
- age_group       3   3494.4 3518.4
- hh_type         6   3549.7 3567.7
- lti             1   3573.3 3601.3
- mh              1   3611.2 3639.2
- ph              1   3728.0 3756.0

Step:  AIC=3470.87
becomes_eilts ~ age_group + sex + eth_simplified + lti + ph + 
    mh + hh_type + hiqual_dv

                 Df Deviance    AIC
+ hascar          1   3418.9 3460.9
+ eq_net_income   1   3422.5 3464.5
- eth_simplified  1   3431.0 3469.0
- sex             1   3431.0 3469.0
&lt;none&gt;                3430.9 3470.9
- age_group       3   3446.3 3480.3
- hiqual_dv       5   3478.3 3508.3
- hh_type         6   3505.2 3533.2
- lti             1   3527.5 3565.5
- mh              1   3557.1 3595.1
- ph              1   3647.8 3685.8

Step:  AIC=3460.87
becomes_eilts ~ age_group + sex + eth_simplified + lti + ph + 
    mh + hh_type + hiqual_dv + hascar

                 Df Deviance    AIC
+ eq_net_income   1   3410.0 3454.0
- sex             1   3419.0 3459.0
- eth_simplified  1   3419.3 3459.3
&lt;none&gt;                3418.9 3460.9
- hascar          1   3430.9 3470.9
- age_group       3   3436.3 3472.3
- hiqual_dv       5   3456.1 3488.1
- hh_type         6   3469.9 3499.9
- lti             1   3514.7 3554.7
- mh              1   3543.6 3583.6
- ph              1   3635.6 3675.6

Step:  AIC=3454.01
becomes_eilts ~ age_group + sex + eth_simplified + lti + ph + 
    mh + hh_type + hiqual_dv + hascar + eq_net_income

                 Df Deviance    AIC
- sex             1   3410.2 3452.2
- eth_simplified  1   3410.6 3452.6
&lt;none&gt;                3410.0 3454.0
- eq_net_income   1   3418.9 3460.9
- hascar          1   3422.5 3464.5
- age_group       3   3427.3 3465.3
- hiqual_dv       5   3449.8 3483.8
- hh_type         6   3464.4 3496.4
- lti             1   3505.3 3547.3
- mh              1   3533.7 3575.7
- ph              1   3624.5 3666.5

Step:  AIC=3452.24
becomes_eilts ~ age_group + eth_simplified + lti + ph + mh + 
    hh_type + hiqual_dv + hascar + eq_net_income

                 Df Deviance    AIC
- eth_simplified  1   3410.8 3450.8
&lt;none&gt;                3410.2 3452.2
+ sex             1   3410.0 3454.0
- eq_net_income   1   3419.0 3459.0
- hascar          1   3422.8 3462.8
- age_group       3   3427.6 3463.6
- hiqual_dv       5   3450.0 3482.0
- hh_type         6   3466.8 3496.8
- lti             1   3505.7 3545.7
- mh              1   3534.9 3574.9
- ph              1   3624.5 3664.5

Step:  AIC=3450.78
becomes_eilts ~ age_group + lti + ph + mh + hh_type + hiqual_dv + 
    hascar + eq_net_income

                 Df Deviance    AIC
&lt;none&gt;                3410.8 3450.8
+ eth_simplified  1   3410.2 3452.2
+ sex             1   3410.6 3452.6
- eq_net_income   1   3419.4 3457.4
- hascar          1   3423.0 3461.0
- age_group       3   3427.9 3461.9
- hiqual_dv       5   3452.3 3482.3
- hh_type         6   3467.6 3495.6
- lti             1   3507.4 3545.4
- mh              1   3535.4 3573.4
- ph              1   3624.5 3662.5</code></pre>
</div>
</div>
<p>Lets look at the specifications arrived at by the three approaches</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mdl_stepAIC_unemployed_pruned)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = becomes_eilts ~ age_group + hascar + lti + mh + 
    ph + hh_type + hiqual_dv + eq_net_income, family = binomial, 
    data = data_tidied_unemployed)

Coefficients:
                                        Estimate Std. Error z value Pr(&gt;|z|)
(Intercept)                            8.877e-01  3.898e-01   2.277 0.022780
age_group25-44                         7.574e-01  2.179e-01   3.477 0.000508
age_group45-54                         8.538e-01  2.272e-01   3.759 0.000171
age_group55-64                         8.260e-01  2.414e-01   3.422 0.000621
hascar                                -3.590e-01  1.031e-01  -3.482 0.000498
ltiyes                                 1.159e+00  1.234e-01   9.393  &lt; 2e-16
mh                                    -4.102e-02  3.717e-03 -11.038  &lt; 2e-16
ph                                    -5.792e-02  4.063e-03 -14.257  &lt; 2e-16
hh_typeSmall Adult                    -5.687e-01  1.317e-01  -4.318 1.57e-05
hh_typeSingle Parent                  -5.648e-01  1.459e-01  -3.872 0.000108
hh_typeFamily with 1-2 Children       -5.435e-01  1.499e-01  -3.627 0.000287
hh_typeFamily with 3 or more Children -9.157e-01  2.011e-01  -4.554 5.27e-06
hh_typeSingle Pensioner               -1.012e+00  4.383e-01  -2.309 0.020971
hh_typePensioner Couple               -1.575e+00  3.534e-01  -4.456 8.37e-06
hiqual_dvDegree                       -6.812e-01  2.080e-01  -3.275 0.001056
hiqual_dvGCSE etc                     -8.099e-02  1.412e-01  -0.573 0.566364
hiqual_dvNo qualification              4.286e-01  1.470e-01   2.915 0.003558
hiqual_dvOther higher degree          -2.314e-01  1.893e-01  -1.222 0.221582
hiqual_dvOther qualification           1.889e-01  1.583e-01   1.194 0.232580
eq_net_income                          1.731e-04  4.833e-05   3.582 0.000341
                                         
(Intercept)                           *  
age_group25-44                        ***
age_group45-54                        ***
age_group55-64                        ***
hascar                                ***
ltiyes                                ***
mh                                    ***
ph                                    ***
hh_typeSmall Adult                    ***
hh_typeSingle Parent                  ***
hh_typeFamily with 1-2 Children       ***
hh_typeFamily with 3 or more Children ***
hh_typeSingle Pensioner               *  
hh_typePensioner Couple               ***
hiqual_dvDegree                       ** 
hiqual_dvGCSE etc                        
hiqual_dvNo qualification             ** 
hiqual_dvOther higher degree             
hiqual_dvOther qualification             
eq_net_income                         ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 4546.8  on 7883  degrees of freedom
Residual deviance: 3410.8  on 7864  degrees of freedom
AIC: 3450.8

Number of Fisher Scoring iterations: 6</code></pre>
</div>
</div>
<p>20 variables included Now the forward approach</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mdl_stepAIC_unemployed_grown)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = becomes_eilts ~ lti + ph + mh + hh_type + hiqual_dv + 
    age_group + hascar + eq_net_income, family = binomial, data = data_tidied_unemployed)

Coefficients:
                                        Estimate Std. Error z value Pr(&gt;|z|)
(Intercept)                            8.877e-01  3.898e-01   2.277 0.022780
ltiyes                                 1.159e+00  1.234e-01   9.393  &lt; 2e-16
ph                                    -5.792e-02  4.063e-03 -14.257  &lt; 2e-16
mh                                    -4.102e-02  3.717e-03 -11.038  &lt; 2e-16
hh_typeSmall Adult                    -5.687e-01  1.317e-01  -4.318 1.57e-05
hh_typeSingle Parent                  -5.648e-01  1.459e-01  -3.872 0.000108
hh_typeFamily with 1-2 Children       -5.435e-01  1.499e-01  -3.627 0.000287
hh_typeFamily with 3 or more Children -9.157e-01  2.011e-01  -4.554 5.27e-06
hh_typeSingle Pensioner               -1.012e+00  4.383e-01  -2.309 0.020971
hh_typePensioner Couple               -1.575e+00  3.534e-01  -4.456 8.37e-06
hiqual_dvDegree                       -6.812e-01  2.080e-01  -3.275 0.001056
hiqual_dvGCSE etc                     -8.099e-02  1.412e-01  -0.573 0.566364
hiqual_dvNo qualification              4.286e-01  1.470e-01   2.915 0.003558
hiqual_dvOther higher degree          -2.314e-01  1.893e-01  -1.222 0.221582
hiqual_dvOther qualification           1.889e-01  1.583e-01   1.194 0.232580
age_group25-44                         7.574e-01  2.179e-01   3.477 0.000508
age_group45-54                         8.538e-01  2.272e-01   3.759 0.000171
age_group55-64                         8.260e-01  2.414e-01   3.422 0.000621
hascar                                -3.590e-01  1.031e-01  -3.482 0.000498
eq_net_income                          1.731e-04  4.833e-05   3.582 0.000341
                                         
(Intercept)                           *  
ltiyes                                ***
ph                                    ***
mh                                    ***
hh_typeSmall Adult                    ***
hh_typeSingle Parent                  ***
hh_typeFamily with 1-2 Children       ***
hh_typeFamily with 3 or more Children ***
hh_typeSingle Pensioner               *  
hh_typePensioner Couple               ***
hiqual_dvDegree                       ** 
hiqual_dvGCSE etc                        
hiqual_dvNo qualification             ** 
hiqual_dvOther higher degree             
hiqual_dvOther qualification             
age_group25-44                        ***
age_group45-54                        ***
age_group55-64                        ***
hascar                                ***
eq_net_income                         ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 4546.8  on 7883  degrees of freedom
Residual deviance: 3410.8  on 7864  degrees of freedom
AIC: 3450.8

Number of Fisher Scoring iterations: 6</code></pre>
</div>
</div>
<p>Now starting in the middle</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mdl_stepAIC_unemployed_both)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = becomes_eilts ~ age_group + lti + ph + mh + hh_type + 
    hiqual_dv + hascar + eq_net_income, family = binomial, data = data_tidied_unemployed)

Coefficients:
                                        Estimate Std. Error z value Pr(&gt;|z|)
(Intercept)                            8.877e-01  3.898e-01   2.277 0.022780
age_group25-44                         7.574e-01  2.179e-01   3.477 0.000508
age_group45-54                         8.538e-01  2.272e-01   3.759 0.000171
age_group55-64                         8.260e-01  2.414e-01   3.422 0.000621
ltiyes                                 1.159e+00  1.234e-01   9.393  &lt; 2e-16
ph                                    -5.792e-02  4.063e-03 -14.257  &lt; 2e-16
mh                                    -4.102e-02  3.717e-03 -11.038  &lt; 2e-16
hh_typeSmall Adult                    -5.687e-01  1.317e-01  -4.318 1.57e-05
hh_typeSingle Parent                  -5.648e-01  1.459e-01  -3.872 0.000108
hh_typeFamily with 1-2 Children       -5.435e-01  1.499e-01  -3.627 0.000287
hh_typeFamily with 3 or more Children -9.157e-01  2.011e-01  -4.554 5.27e-06
hh_typeSingle Pensioner               -1.012e+00  4.383e-01  -2.309 0.020971
hh_typePensioner Couple               -1.575e+00  3.534e-01  -4.456 8.37e-06
hiqual_dvDegree                       -6.812e-01  2.080e-01  -3.275 0.001056
hiqual_dvGCSE etc                     -8.099e-02  1.412e-01  -0.573 0.566364
hiqual_dvNo qualification              4.286e-01  1.470e-01   2.915 0.003558
hiqual_dvOther higher degree          -2.314e-01  1.893e-01  -1.222 0.221582
hiqual_dvOther qualification           1.889e-01  1.583e-01   1.194 0.232580
hascar                                -3.590e-01  1.031e-01  -3.482 0.000498
eq_net_income                          1.731e-04  4.833e-05   3.582 0.000341
                                         
(Intercept)                           *  
age_group25-44                        ***
age_group45-54                        ***
age_group55-64                        ***
ltiyes                                ***
ph                                    ***
mh                                    ***
hh_typeSmall Adult                    ***
hh_typeSingle Parent                  ***
hh_typeFamily with 1-2 Children       ***
hh_typeFamily with 3 or more Children ***
hh_typeSingle Pensioner               *  
hh_typePensioner Couple               ***
hiqual_dvDegree                       ** 
hiqual_dvGCSE etc                        
hiqual_dvNo qualification             ** 
hiqual_dvOther higher degree             
hiqual_dvOther qualification             
hascar                                ***
eq_net_income                         ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 4546.8  on 7883  degrees of freedom
Residual deviance: 3410.8  on 7864  degrees of freedom
AIC: 3450.8

Number of Fisher Scoring iterations: 6</code></pre>
</div>
</div>
<p>Lets get the Nagelkerke R^2 for each of these models</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>fmsb<span class="sc">::</span><span class="fu">NagelkerkeR2</span>(mdl_stepAIC_unemployed_pruned)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$N
[1] 7884

$R2
[1] 0.3061868</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>fmsb<span class="sc">::</span><span class="fu">NagelkerkeR2</span>(mdl_stepAIC_unemployed_grown)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$N
[1] 7884

$R2
[1] 0.3061868</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>fmsb<span class="sc">::</span><span class="fu">NagelkerkeR2</span>(mdl_stepAIC_unemployed_both)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$N
[1] 7884

$R2
[1] 0.3061868</code></pre>
</div>
</div>
<p>Finally (finally?) lets do the same for people who start off employed</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb85"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>data_tidied_employed <span class="ot">&lt;-</span> data_tidied <span class="sc">|&gt;</span> <span class="fu">filter</span>(this_status <span class="sc">==</span> <span class="st">"Employed"</span>) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">complete.cases</span>(.))</span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a>mod_employed_null <span class="ot">&lt;-</span>  <span class="fu">glm</span>(becomes_eilts <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> data_tidied_employed, <span class="at">family =</span> binomial)</span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a>mod_employed_demographics <span class="ot">&lt;-</span> <span class="fu">glm</span>(becomes_eilts <span class="sc">~</span> age_group <span class="sc">+</span> sex <span class="sc">+</span> eth_simplified, <span class="at">data =</span> data_tidied_employed, <span class="at">family =</span> binomial)</span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a>mod_employed_full <span class="ot">&lt;-</span>  <span class="fu">glm</span>(becomes_eilts <span class="sc">~</span>  age_group <span class="sc">+</span> sex <span class="sc">+</span> hascar <span class="sc">+</span> eth_simplified <span class="sc">+</span> lti <span class="sc">+</span> mh <span class="sc">+</span> ph <span class="sc">+</span> hh_type <span class="sc">+</span> hiqual_dv <span class="sc">+</span> eq_net_income, <span class="at">data =</span> data_tidied_employed, <span class="at">family =</span> binomial) <span class="co"># this time with income </span></span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a><span class="co"># first step backwards with the full model, </span></span>
<span id="cb85-8"><a href="#cb85-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-9"><a href="#cb85-9" aria-hidden="true" tabindex="-1"></a>mdl_stepAIC_employed_pruned <span class="ot">&lt;-</span> <span class="fu">step</span>(mod_employed_full, <span class="at">direction =</span> <span class="st">"backward"</span>, <span class="at">scope =</span> <span class="fu">list</span>(<span class="at">lower =</span> mod_employed_null, <span class="at">upper =</span> mod_employed_full))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=4892.08
becomes_eilts ~ age_group + sex + hascar + eth_simplified + lti + 
    mh + ph + hh_type + hiqual_dv + eq_net_income

                 Df Deviance    AIC
- age_group       3   4851.7 4889.7
- sex             1   4848.9 4890.9
- eth_simplified  1   4849.4 4891.4
&lt;none&gt;                4848.1 4892.1
- hh_type         6   4862.4 4894.4
- hascar          1   4856.5 4898.5
- eq_net_income   1   4861.1 4903.1
- lti             1   4877.6 4919.6
- hiqual_dv       5   4908.7 4942.7
- mh              1   4970.9 5012.9
- ph              1   5237.0 5279.0

Step:  AIC=4889.7
becomes_eilts ~ sex + hascar + eth_simplified + lti + mh + ph + 
    hh_type + hiqual_dv + eq_net_income

                 Df Deviance    AIC
- sex             1   4852.3 4888.3
- eth_simplified  1   4853.0 4889.0
&lt;none&gt;                4851.7 4889.7
- hascar          1   4859.6 4895.6
- hh_type         6   4871.9 4897.9
- eq_net_income   1   4864.6 4900.6
- lti             1   4882.4 4918.4
- hiqual_dv       5   4917.3 4945.3
- mh              1   4973.3 5009.3
- ph              1   5246.2 5282.2

Step:  AIC=4888.34
becomes_eilts ~ hascar + eth_simplified + lti + mh + ph + hh_type + 
    hiqual_dv + eq_net_income

                 Df Deviance    AIC
- eth_simplified  1   4853.6 4887.6
&lt;none&gt;                4852.3 4888.3
- hascar          1   4860.5 4894.5
- hh_type         6   4872.4 4896.4
- eq_net_income   1   4865.3 4899.3
- lti             1   4883.0 4917.0
- hiqual_dv       5   4917.4 4943.4
- mh              1   4977.0 5011.0
- ph              1   5251.1 5285.1

Step:  AIC=4887.62
becomes_eilts ~ hascar + lti + mh + ph + hh_type + hiqual_dv + 
    eq_net_income

                Df Deviance    AIC
&lt;none&gt;               4853.6 4887.6
- hascar         1   4861.0 4893.0
- hh_type        6   4874.9 4896.9
- eq_net_income  1   4866.3 4898.3
- lti            1   4885.7 4917.7
- hiqual_dv      5   4920.3 4944.3
- mh             1   4977.7 5009.7
- ph             1   5251.2 5283.2</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb87"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a><span class="co"># then step forwards from the null model</span></span>
<span id="cb87-2"><a href="#cb87-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb87-3"><a href="#cb87-3" aria-hidden="true" tabindex="-1"></a>mdl_stepAIC_employed_grown <span class="ot">&lt;-</span> <span class="fu">step</span>(mod_employed_null, <span class="at">direction =</span> <span class="st">"forward"</span>, <span class="at">scope =</span> <span class="fu">list</span>(<span class="at">lower =</span> mod_employed_null, <span class="at">upper =</span> mod_employed_full))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=5935.56
becomes_eilts ~ 1

                 Df Deviance    AIC
+ ph              1   5201.0 5205.0
+ lti             1   5562.2 5566.2
+ hiqual_dv       5   5751.3 5763.3
+ mh              1   5795.5 5799.5
+ eq_net_income   1   5852.0 5856.0
+ hh_type         6   5844.5 5858.5
+ age_group       3   5861.3 5869.3
+ hascar          1   5891.5 5895.5
+ sex             1   5922.7 5926.7
&lt;none&gt;                5933.6 5935.6
+ eth_simplified  1   5933.1 5937.1

Step:  AIC=5205.02
becomes_eilts ~ ph

                 Df Deviance    AIC
+ mh              1   5042.8 5048.8
+ hiqual_dv       5   5102.2 5116.2
+ lti             1   5135.2 5141.2
+ eq_net_income   1   5154.4 5160.4
+ hh_type         6   5157.1 5173.1
+ hascar          1   5169.6 5175.6
+ age_group       3   5185.0 5195.0
+ sex             1   5198.2 5204.2
&lt;none&gt;                5201.0 5205.0
+ eth_simplified  1   5199.1 5205.1

Step:  AIC=5048.78
becomes_eilts ~ ph + mh

                 Df Deviance    AIC
+ hiqual_dv       5   4939.1 4955.1
+ lti             1   5004.9 5012.9
+ eq_net_income   1   5008.4 5016.4
+ hh_type         6   5001.5 5019.5
+ age_group       3   5014.0 5026.0
+ hascar          1   5018.4 5026.4
+ eth_simplified  1   5039.3 5047.3
&lt;none&gt;                5042.8 5048.8
+ sex             1   5042.6 5050.6

Step:  AIC=4955.12
becomes_eilts ~ ph + mh + hiqual_dv

                 Df Deviance    AIC
+ lti             1   4902.0 4920.0
+ hh_type         6   4907.3 4935.3
+ hascar          1   4922.0 4940.0
+ eq_net_income   1   4927.1 4945.1
+ age_group       3   4927.8 4949.8
&lt;none&gt;                4939.1 4955.1
+ eth_simplified  1   4937.4 4955.4
+ sex             1   4937.9 4955.9

Step:  AIC=4920.01
becomes_eilts ~ ph + mh + hiqual_dv + lti

                 Df Deviance    AIC
+ hascar          1   4884.4 4904.4
+ hh_type         6   4876.1 4906.1
+ eq_net_income   1   4888.6 4908.6
+ age_group       3   4895.0 4919.0
&lt;none&gt;                4902.0 4920.0
+ sex             1   4900.9 4920.9
+ eth_simplified  1   4901.6 4921.6

Step:  AIC=4904.38
becomes_eilts ~ ph + mh + hiqual_dv + lti + hascar

                 Df Deviance    AIC
+ eq_net_income   1   4874.9 4896.9
+ hh_type         6   4866.3 4898.3
+ age_group       3   4876.5 4902.5
&lt;none&gt;                4884.4 4904.4
+ eth_simplified  1   4882.6 4904.6
+ sex             1   4883.8 4905.8

Step:  AIC=4896.91
becomes_eilts ~ ph + mh + hiqual_dv + lti + hascar + eq_net_income

                 Df Deviance    AIC
+ hh_type         6   4853.6 4887.6
+ age_group       3   4865.0 4893.0
+ eth_simplified  1   4872.4 4896.4
&lt;none&gt;                4874.9 4896.9
+ sex             1   4874.3 4898.3

Step:  AIC=4887.62
becomes_eilts ~ ph + mh + hiqual_dv + lti + hascar + eq_net_income + 
    hh_type

                 Df Deviance    AIC
&lt;none&gt;                4853.6 4887.6
+ eth_simplified  1   4852.3 4888.3
+ sex             1   4853.0 4889.0
+ age_group       3   4850.2 4890.2</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb89"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a><span class="co"># then allow stepping in either direction with the demographics model to start</span></span>
<span id="cb89-2"><a href="#cb89-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb89-3"><a href="#cb89-3" aria-hidden="true" tabindex="-1"></a>mdl_stepAIC_employed_both <span class="ot">&lt;-</span> <span class="fu">step</span>(mod_employed_demographics, <span class="at">direction =</span> <span class="st">"both"</span>, <span class="at">scope =</span> <span class="fu">list</span>(<span class="at">lower =</span> mod_employed_null, <span class="at">upper =</span> mod_employed_full))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=5860.42
becomes_eilts ~ age_group + sex + eth_simplified

                 Df Deviance    AIC
+ ph              1   5180.3 5194.3
+ lti             1   5524.0 5538.0
+ mh              1   5694.2 5708.2
+ hiqual_dv       5   5703.7 5725.7
+ eq_net_income   1   5753.2 5767.2
+ hascar          1   5800.9 5814.9
+ hh_type         6   5804.2 5828.2
- eth_simplified  1   5848.5 5858.5
&lt;none&gt;                5848.4 5860.4
- sex             1   5861.2 5871.2
- age_group       3   5922.3 5928.3

Step:  AIC=5194.28
becomes_eilts ~ age_group + sex + eth_simplified + ph

                 Df Deviance    AIC
+ mh              1   5011.7 5027.7
+ hiqual_dv       5   5091.5 5115.5
+ lti             1   5122.5 5138.5
+ eq_net_income   1   5126.8 5142.8
+ hascar          1   5145.3 5161.3
+ hh_type         6   5147.8 5173.8
- eth_simplified  1   5181.2 5193.2
&lt;none&gt;                5180.3 5194.3
- sex             1   5184.1 5196.1
- age_group       3   5196.3 5204.3
- ph              1   5848.4 5860.4

Step:  AIC=5027.72
becomes_eilts ~ age_group + sex + eth_simplified + ph + mh

                 Df Deviance    AIC
+ hiqual_dv       5   4925.6 4951.6
+ eq_net_income   1   4970.8 4988.8
+ lti             1   4982.5 5000.5
+ hascar          1   4983.6 5001.6
+ hh_type         6   4988.7 5016.7
- sex             1   5012.1 5026.1
- eth_simplified  1   5013.6 5027.6
&lt;none&gt;                5011.7 5027.7
- age_group       3   5039.1 5049.1
- mh              1   5180.3 5194.3
- ph              1   5694.2 5708.2

Step:  AIC=4951.61
becomes_eilts ~ age_group + sex + eth_simplified + ph + mh + 
    hiqual_dv

                 Df Deviance    AIC
+ lti             1   4893.6 4921.6
+ hascar          1   4905.8 4933.8
+ eq_net_income   1   4909.4 4937.4
+ hh_type         6   4901.5 4939.5
- eth_simplified  1   4926.5 4950.5
- sex             1   4926.9 4950.9
&lt;none&gt;                4925.6 4951.6
- age_group       3   4936.2 4956.2
- hiqual_dv       5   5011.7 5027.7
- mh              1   5091.5 5115.5
- ph              1   5548.4 5572.4

Step:  AIC=4921.63
becomes_eilts ~ age_group + sex + eth_simplified + ph + mh + 
    hiqual_dv + lti

                 Df Deviance    AIC
+ hascar          1   4874.5 4904.5
+ eq_net_income   1   4877.5 4907.5
+ hh_type         6   4871.8 4911.8
- eth_simplified  1   4893.8 4919.8
- sex             1   4894.8 4920.8
&lt;none&gt;                4893.6 4921.6
- age_group       3   4900.5 4922.5
- lti             1   4925.6 4951.6
- hiqual_dv       5   4982.5 5000.5
- mh              1   5030.0 5056.0
- ph              1   5295.2 5321.2

Step:  AIC=4904.53
becomes_eilts ~ age_group + sex + eth_simplified + ph + mh + 
    hiqual_dv + lti + hascar

                 Df Deviance    AIC
+ eq_net_income   1   4862.4 4894.4
+ hh_type         6   4861.1 4903.1
- sex             1   4875.2 4903.2
- eth_simplified  1   4875.9 4903.9
&lt;none&gt;                4874.5 4904.5
- age_group       3   4882.0 4906.0
- hascar          1   4893.6 4921.6
- lti             1   4905.8 4933.8
- hiqual_dv       5   4955.2 4975.2
- mh              1   5006.8 5034.8
- ph              1   5275.8 5303.8

Step:  AIC=4894.41
becomes_eilts ~ age_group + sex + eth_simplified + ph + mh + 
    hiqual_dv + lti + hascar + eq_net_income

                 Df Deviance    AIC
+ hh_type         6   4848.1 4892.1
- sex             1   4863.0 4893.0
- eth_simplified  1   4864.4 4894.4
&lt;none&gt;                4862.4 4894.4
- age_group       3   4871.9 4897.9
- eq_net_income   1   4874.5 4904.5
- hascar          1   4877.5 4907.5
- lti             1   4893.8 4923.8
- hiqual_dv       5   4922.6 4944.6
- mh              1   4988.7 5018.7
- ph              1   5252.5 5282.5

Step:  AIC=4892.08
becomes_eilts ~ age_group + sex + eth_simplified + ph + mh + 
    hiqual_dv + lti + hascar + eq_net_income + hh_type

                 Df Deviance    AIC
- age_group       3   4851.7 4889.7
- sex             1   4848.9 4890.9
- eth_simplified  1   4849.4 4891.4
&lt;none&gt;                4848.1 4892.1
- hh_type         6   4862.4 4894.4
- hascar          1   4856.5 4898.5
- eq_net_income   1   4861.1 4903.1
- lti             1   4877.6 4919.6
- hiqual_dv       5   4908.7 4942.7
- mh              1   4970.9 5012.9
- ph              1   5237.0 5279.0

Step:  AIC=4889.7
becomes_eilts ~ sex + eth_simplified + ph + mh + hiqual_dv + 
    lti + hascar + eq_net_income + hh_type

                 Df Deviance    AIC
- sex             1   4852.3 4888.3
- eth_simplified  1   4853.0 4889.0
&lt;none&gt;                4851.7 4889.7
+ age_group       3   4848.1 4892.1
- hascar          1   4859.6 4895.6
- hh_type         6   4871.9 4897.9
- eq_net_income   1   4864.6 4900.6
- lti             1   4882.4 4918.4
- hiqual_dv       5   4917.3 4945.3
- mh              1   4973.3 5009.3
- ph              1   5246.2 5282.2

Step:  AIC=4888.34
becomes_eilts ~ eth_simplified + ph + mh + hiqual_dv + lti + 
    hascar + eq_net_income + hh_type

                 Df Deviance    AIC
- eth_simplified  1   4853.6 4887.6
&lt;none&gt;                4852.3 4888.3
+ sex             1   4851.7 4889.7
+ age_group       3   4848.9 4890.9
- hascar          1   4860.5 4894.5
- hh_type         6   4872.4 4896.4
- eq_net_income   1   4865.3 4899.3
- lti             1   4883.0 4917.0
- hiqual_dv       5   4917.4 4943.4
- mh              1   4977.0 5011.0
- ph              1   5251.1 5285.1

Step:  AIC=4887.62
becomes_eilts ~ ph + mh + hiqual_dv + lti + hascar + eq_net_income + 
    hh_type

                 Df Deviance    AIC
&lt;none&gt;                4853.6 4887.6
+ eth_simplified  1   4852.3 4888.3
+ sex             1   4853.0 4889.0
+ age_group       3   4850.2 4890.2
- hascar          1   4861.0 4893.0
- hh_type         6   4874.9 4896.9
- eq_net_income   1   4866.3 4898.3
- lti             1   4885.7 4917.7
- hiqual_dv       5   4920.3 4944.3
- mh              1   4977.7 5009.7
- ph              1   5251.2 5283.2</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb91"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mdl_stepAIC_employed_pruned)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = becomes_eilts ~ hascar + lti + mh + ph + hh_type + 
    hiqual_dv + eq_net_income, family = binomial, data = data_tidied_employed)

Coefficients:
                                        Estimate Std. Error z value Pr(&gt;|z|)
(Intercept)                            1.350e+00  3.454e-01   3.910 9.25e-05
hascar                                -3.701e-01  1.330e-01  -2.782 0.005396
ltiyes                                 6.635e-01  1.183e-01   5.610 2.02e-08
mh                                    -4.859e-02  4.200e-03 -11.569  &lt; 2e-16
ph                                    -8.511e-02  4.126e-03 -20.624  &lt; 2e-16
hh_typeSmall Adult                    -2.465e-01  1.420e-01  -1.737 0.082437
hh_typeSingle Parent                  -3.871e-01  2.037e-01  -1.900 0.057387
hh_typeFamily with 1-2 Children       -5.707e-01  1.461e-01  -3.906 9.38e-05
hh_typeFamily with 3 or more Children -5.948e-01  2.267e-01  -2.624 0.008692
hh_typeSingle Pensioner               -3.053e-01  3.400e-01  -0.898 0.369212
hh_typePensioner Couple               -2.709e-03  1.896e-01  -0.014 0.988603
hiqual_dvDegree                       -2.513e-01  1.618e-01  -1.553 0.120462
hiqual_dvGCSE etc                      3.410e-01  1.480e-01   2.304 0.021238
hiqual_dvNo qualification              1.120e+00  1.767e-01   6.342 2.26e-10
hiqual_dvOther higher degree           7.285e-02  1.748e-01   0.417 0.676852
hiqual_dvOther qualification           6.792e-01  1.723e-01   3.943 8.06e-05
eq_net_income                         -2.136e-04  6.354e-05  -3.362 0.000774
                                         
(Intercept)                           ***
hascar                                ** 
ltiyes                                ***
mh                                    ***
ph                                    ***
hh_typeSmall Adult                    .  
hh_typeSingle Parent                  .  
hh_typeFamily with 1-2 Children       ***
hh_typeFamily with 3 or more Children ** 
hh_typeSingle Pensioner                  
hh_typePensioner Couple                  
hiqual_dvDegree                          
hiqual_dvGCSE etc                     *  
hiqual_dvNo qualification             ***
hiqual_dvOther higher degree             
hiqual_dvOther qualification          ***
eq_net_income                         ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 5933.6  on 118097  degrees of freedom
Residual deviance: 4853.6  on 118081  degrees of freedom
AIC: 4887.6

Number of Fisher Scoring iterations: 9</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb93"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mdl_stepAIC_employed_grown)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = becomes_eilts ~ ph + mh + hiqual_dv + lti + hascar + 
    eq_net_income + hh_type, family = binomial, data = data_tidied_employed)

Coefficients:
                                        Estimate Std. Error z value Pr(&gt;|z|)
(Intercept)                            1.350e+00  3.454e-01   3.910 9.25e-05
ph                                    -8.511e-02  4.126e-03 -20.624  &lt; 2e-16
mh                                    -4.859e-02  4.200e-03 -11.569  &lt; 2e-16
hiqual_dvDegree                       -2.513e-01  1.618e-01  -1.553 0.120462
hiqual_dvGCSE etc                      3.410e-01  1.480e-01   2.304 0.021238
hiqual_dvNo qualification              1.120e+00  1.767e-01   6.342 2.26e-10
hiqual_dvOther higher degree           7.285e-02  1.748e-01   0.417 0.676852
hiqual_dvOther qualification           6.792e-01  1.723e-01   3.943 8.06e-05
ltiyes                                 6.635e-01  1.183e-01   5.610 2.02e-08
hascar                                -3.701e-01  1.330e-01  -2.782 0.005396
eq_net_income                         -2.136e-04  6.354e-05  -3.362 0.000774
hh_typeSmall Adult                    -2.465e-01  1.420e-01  -1.737 0.082437
hh_typeSingle Parent                  -3.871e-01  2.037e-01  -1.900 0.057387
hh_typeFamily with 1-2 Children       -5.707e-01  1.461e-01  -3.906 9.38e-05
hh_typeFamily with 3 or more Children -5.948e-01  2.267e-01  -2.624 0.008692
hh_typeSingle Pensioner               -3.053e-01  3.400e-01  -0.898 0.369212
hh_typePensioner Couple               -2.709e-03  1.896e-01  -0.014 0.988603
                                         
(Intercept)                           ***
ph                                    ***
mh                                    ***
hiqual_dvDegree                          
hiqual_dvGCSE etc                     *  
hiqual_dvNo qualification             ***
hiqual_dvOther higher degree             
hiqual_dvOther qualification          ***
ltiyes                                ***
hascar                                ** 
eq_net_income                         ***
hh_typeSmall Adult                    .  
hh_typeSingle Parent                  .  
hh_typeFamily with 1-2 Children       ***
hh_typeFamily with 3 or more Children ** 
hh_typeSingle Pensioner                  
hh_typePensioner Couple                  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 5933.6  on 118097  degrees of freedom
Residual deviance: 4853.6  on 118081  degrees of freedom
AIC: 4887.6

Number of Fisher Scoring iterations: 9</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb95"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mdl_stepAIC_employed_both)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = becomes_eilts ~ ph + mh + hiqual_dv + lti + hascar + 
    eq_net_income + hh_type, family = binomial, data = data_tidied_employed)

Coefficients:
                                        Estimate Std. Error z value Pr(&gt;|z|)
(Intercept)                            1.350e+00  3.454e-01   3.910 9.25e-05
ph                                    -8.511e-02  4.126e-03 -20.624  &lt; 2e-16
mh                                    -4.859e-02  4.200e-03 -11.569  &lt; 2e-16
hiqual_dvDegree                       -2.513e-01  1.618e-01  -1.553 0.120462
hiqual_dvGCSE etc                      3.410e-01  1.480e-01   2.304 0.021238
hiqual_dvNo qualification              1.120e+00  1.767e-01   6.342 2.26e-10
hiqual_dvOther higher degree           7.285e-02  1.748e-01   0.417 0.676852
hiqual_dvOther qualification           6.792e-01  1.723e-01   3.943 8.06e-05
ltiyes                                 6.635e-01  1.183e-01   5.610 2.02e-08
hascar                                -3.701e-01  1.330e-01  -2.782 0.005396
eq_net_income                         -2.136e-04  6.354e-05  -3.362 0.000774
hh_typeSmall Adult                    -2.465e-01  1.420e-01  -1.737 0.082437
hh_typeSingle Parent                  -3.871e-01  2.037e-01  -1.900 0.057387
hh_typeFamily with 1-2 Children       -5.707e-01  1.461e-01  -3.906 9.38e-05
hh_typeFamily with 3 or more Children -5.948e-01  2.267e-01  -2.624 0.008692
hh_typeSingle Pensioner               -3.053e-01  3.400e-01  -0.898 0.369212
hh_typePensioner Couple               -2.709e-03  1.896e-01  -0.014 0.988603
                                         
(Intercept)                           ***
ph                                    ***
mh                                    ***
hiqual_dvDegree                          
hiqual_dvGCSE etc                     *  
hiqual_dvNo qualification             ***
hiqual_dvOther higher degree             
hiqual_dvOther qualification          ***
ltiyes                                ***
hascar                                ** 
eq_net_income                         ***
hh_typeSmall Adult                    .  
hh_typeSingle Parent                  .  
hh_typeFamily with 1-2 Children       ***
hh_typeFamily with 3 or more Children ** 
hh_typeSingle Pensioner                  
hh_typePensioner Couple                  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 5933.6  on 118097  degrees of freedom
Residual deviance: 4853.6  on 118081  degrees of freedom
AIC: 4887.6

Number of Fisher Scoring iterations: 9</code></pre>
</div>
</div>
<p>Now Nagelkerke R^2 for each of these models</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb97"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>fmsb<span class="sc">::</span><span class="fu">NagelkerkeR2</span>(mdl_stepAIC_employed_pruned)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$N
[1] 118098

$R2
[1] 0.1857658</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb99"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>fmsb<span class="sc">::</span><span class="fu">NagelkerkeR2</span>(mdl_stepAIC_employed_grown)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$N
[1] 118098

$R2
[1] 0.1857658</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb101"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>fmsb<span class="sc">::</span><span class="fu">NagelkerkeR2</span>(mdl_stepAIC_employed_both)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$N
[1] 118098

$R2
[1] 0.1857658</code></pre>
</div>
</div>
<p>Now, finally (finally (finally)) we can look at flows out of EILTS from those who start in this state</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb103"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>data_tidied_eilts <span class="ot">&lt;-</span> data_tidied <span class="sc">|&gt;</span> <span class="fu">filter</span>(this_status <span class="sc">==</span> <span class="st">"Inactive long term sick"</span>) <span class="sc">%&gt;%</span> <span class="fu">filter</span>(<span class="fu">complete.cases</span>(.)) <span class="sc">|&gt;</span> </span>
<span id="cb103-2"><a href="#cb103-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">leaves_eilts =</span> <span class="fu">as.numeric</span>(<span class="sc">!</span>becomes_eilts))</span>
<span id="cb103-3"><a href="#cb103-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-4"><a href="#cb103-4" aria-hidden="true" tabindex="-1"></a>mod_eilts_null <span class="ot">&lt;-</span>  <span class="fu">glm</span>(leaves_eilts <span class="sc">~</span> <span class="dv">1</span>, <span class="at">data =</span> data_tidied_eilts, <span class="at">family =</span> binomial)</span>
<span id="cb103-5"><a href="#cb103-5" aria-hidden="true" tabindex="-1"></a>mod_eilts_demographics <span class="ot">&lt;-</span> <span class="fu">glm</span>(leaves_eilts <span class="sc">~</span> age_group <span class="sc">+</span> sex <span class="sc">+</span> eth_simplified, <span class="at">data =</span> data_tidied_eilts, <span class="at">family =</span> binomial)</span>
<span id="cb103-6"><a href="#cb103-6" aria-hidden="true" tabindex="-1"></a>mod_eilts_full <span class="ot">&lt;-</span>  <span class="fu">glm</span>(leaves_eilts <span class="sc">~</span>  age_group <span class="sc">+</span> sex <span class="sc">+</span> hascar <span class="sc">+</span> eth_simplified <span class="sc">+</span> lti <span class="sc">+</span> mh <span class="sc">+</span> ph <span class="sc">+</span> hh_type <span class="sc">+</span> hiqual_dv <span class="sc">+</span> eq_net_income, <span class="at">data =</span> data_tidied_eilts, <span class="at">family =</span> binomial) <span class="co"># this time with income </span></span>
<span id="cb103-7"><a href="#cb103-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-8"><a href="#cb103-8" aria-hidden="true" tabindex="-1"></a><span class="co"># first step backwards with the full model, </span></span>
<span id="cb103-9"><a href="#cb103-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-10"><a href="#cb103-10" aria-hidden="true" tabindex="-1"></a>mdl_stepAIC_eilts_pruned <span class="ot">&lt;-</span> <span class="fu">step</span>(mod_eilts_full, <span class="at">direction =</span> <span class="st">"backward"</span>, <span class="at">scope =</span> <span class="fu">list</span>(<span class="at">lower =</span> mod_eilts_null, <span class="at">upper =</span> mod_eilts_full))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=6959.08
leaves_eilts ~ age_group + sex + hascar + eth_simplified + lti + 
    mh + ph + hh_type + hiqual_dv + eq_net_income

                 Df Deviance    AIC
- sex             1   6915.3 6957.3
&lt;none&gt;                6915.1 6959.1
- hiqual_dv       5   6925.1 6959.1
- eth_simplified  1   6921.5 6963.5
- eq_net_income   1   6921.8 6963.8
- hascar          1   6933.4 6975.4
- lti             1   6943.9 6985.9
- age_group       3   6979.6 7017.6
- mh              1   6981.6 7023.6
- hh_type         6   6997.5 7029.5
- ph              1   7097.8 7139.8

Step:  AIC=6957.35
leaves_eilts ~ age_group + hascar + eth_simplified + lti + mh + 
    ph + hh_type + hiqual_dv + eq_net_income

                 Df Deviance    AIC
- hiqual_dv       5   6925.3 6957.3
&lt;none&gt;                6915.3 6957.3
- eth_simplified  1   6921.7 6961.7
- eq_net_income   1   6921.9 6961.9
- hascar          1   6933.7 6973.7
- lti             1   6944.2 6984.2
- age_group       3   6979.6 7015.6
- mh              1   6981.9 7021.9
- hh_type         6   7002.1 7032.1
- ph              1   7097.9 7137.9

Step:  AIC=6957.31
leaves_eilts ~ age_group + hascar + eth_simplified + lti + mh + 
    ph + hh_type + eq_net_income

                 Df Deviance    AIC
&lt;none&gt;                6925.3 6957.3
- eq_net_income   1   6930.8 6960.8
- eth_simplified  1   6932.5 6962.5
- hascar          1   6948.3 6978.3
- lti             1   6954.4 6984.4
- age_group       3   6988.2 7014.2
- mh              1   6992.7 7022.7
- hh_type         6   7010.8 7030.8
- ph              1   7109.5 7139.5</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb105"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a><span class="co"># then step forwards from the null model</span></span>
<span id="cb105-2"><a href="#cb105-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb105-3"><a href="#cb105-3" aria-hidden="true" tabindex="-1"></a>mdl_stepAIC_eilts_grown <span class="ot">&lt;-</span> <span class="fu">step</span>(mod_eilts_null, <span class="at">direction =</span> <span class="st">"forward"</span>, <span class="at">scope =</span> <span class="fu">list</span>(<span class="at">lower =</span> mod_eilts_null, <span class="at">upper =</span> mod_eilts_full))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=7412.71
leaves_eilts ~ 1

                 Df Deviance    AIC
+ ph              1   7297.2 7301.2
+ hh_type         6   7293.9 7307.9
+ age_group       3   7315.7 7323.7
+ lti             1   7333.6 7337.6
+ mh              1   7375.6 7379.6
+ hascar          1   7379.3 7383.3
+ hiqual_dv       5   7397.3 7409.3
+ eq_net_income   1   7407.5 7411.5
&lt;none&gt;                7410.7 7412.7
+ eth_simplified  1   7409.1 7413.1
+ sex             1   7410.7 7414.7

Step:  AIC=7301.17
leaves_eilts ~ ph

                 Df Deviance    AIC
+ hh_type         6   7139.3 7155.3
+ age_group       3   7196.1 7206.1
+ mh              1   7204.0 7210.0
+ hascar          1   7232.4 7238.4
+ lti             1   7247.0 7253.0
+ hiqual_dv       5   7284.4 7298.4
&lt;none&gt;                7297.2 7301.2
+ eth_simplified  1   7296.4 7302.4
+ sex             1   7296.8 7302.8
+ eq_net_income   1   7296.9 7302.9

Step:  AIC=7155.35
leaves_eilts ~ ph + hh_type

                 Df Deviance    AIC
+ mh              1   7051.4 7069.4
+ age_group       3   7067.7 7089.7
+ lti             1   7094.1 7112.1
+ hascar          1   7118.7 7136.7
+ eq_net_income   1   7135.0 7153.0
+ hiqual_dv       5   7127.1 7153.1
+ eth_simplified  1   7135.3 7153.3
&lt;none&gt;                7139.3 7155.3
+ sex             1   7138.1 7156.1

Step:  AIC=7069.44
leaves_eilts ~ ph + hh_type + mh

                 Df Deviance    AIC
+ age_group       3   6987.4 7011.4
+ lti             1   7020.4 7040.4
+ hascar          1   7031.7 7051.7
+ eq_net_income   1   7046.6 7066.6
+ eth_simplified  1   7046.8 7066.8
+ hiqual_dv       5   7039.9 7067.9
&lt;none&gt;                7051.4 7069.4
+ sex             1   7051.4 7071.4

Step:  AIC=7011.37
leaves_eilts ~ ph + hh_type + mh + age_group

                 Df Deviance    AIC
+ lti             1   6956.7 6982.7
+ hascar          1   6967.9 6993.9
+ hiqual_dv       5   6973.6 7007.6
+ eth_simplified  1   6982.4 7008.4
+ eq_net_income   1   6983.2 7009.2
&lt;none&gt;                6987.4 7011.4
+ sex             1   6987.2 7013.2

Step:  AIC=6982.7
leaves_eilts ~ ph + hh_type + mh + age_group + lti

                 Df Deviance    AIC
+ hascar          1   6937.8 6965.8
+ hiqual_dv       5   6943.1 6979.1
+ eth_simplified  1   6951.7 6979.7
+ eq_net_income   1   6953.3 6981.3
&lt;none&gt;                6956.7 6982.7
+ sex             1   6956.6 6984.6

Step:  AIC=6965.83
leaves_eilts ~ ph + hh_type + mh + age_group + lti + hascar

                 Df Deviance    AIC
+ eth_simplified  1   6930.8 6960.8
+ eq_net_income   1   6932.5 6962.5
&lt;none&gt;                6937.8 6965.8
+ hiqual_dv       5   6928.3 6966.3
+ sex             1   6937.8 6967.8

Step:  AIC=6960.76
leaves_eilts ~ ph + hh_type + mh + age_group + lti + hascar + 
    eth_simplified

                Df Deviance    AIC
+ eq_net_income  1   6925.3 6957.3
&lt;none&gt;               6930.8 6960.8
+ hiqual_dv      5   6921.9 6961.9
+ sex            1   6930.7 6962.7

Step:  AIC=6957.31
leaves_eilts ~ ph + hh_type + mh + age_group + lti + hascar + 
    eth_simplified + eq_net_income

            Df Deviance    AIC
&lt;none&gt;           6925.3 6957.3
+ hiqual_dv  5   6915.3 6957.3
+ sex        1   6925.1 6959.1</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb107"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="co"># then allow stepping in either direction with the demographics model to start</span></span>
<span id="cb107-2"><a href="#cb107-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb107-3"><a href="#cb107-3" aria-hidden="true" tabindex="-1"></a>mdl_stepAIC_eilts_both <span class="ot">&lt;-</span> <span class="fu">step</span>(mod_eilts_demographics, <span class="at">direction =</span> <span class="st">"both"</span>, <span class="at">scope =</span> <span class="fu">list</span>(<span class="at">lower =</span> mod_eilts_null, <span class="at">upper =</span> mod_eilts_full))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>Start:  AIC=7325.77
leaves_eilts ~ age_group + sex + eth_simplified

                 Df Deviance    AIC
+ ph              1   7193.8 7207.8
+ hh_type         6   7219.5 7243.5
+ lti             1   7238.4 7252.4
+ hascar          1   7279.4 7293.4
+ mh              1   7281.7 7295.7
+ hiqual_dv       5   7298.1 7320.1
- sex             1   7313.9 7323.9
+ eq_net_income   1   7310.4 7324.4
- eth_simplified  1   7315.6 7325.6
&lt;none&gt;                7313.8 7325.8
- age_group       3   7409.1 7415.1

Step:  AIC=7207.8
leaves_eilts ~ age_group + sex + eth_simplified + ph

                 Df Deviance    AIC
+ hh_type         6   7062.8 7088.8
+ mh              1   7108.7 7124.7
+ hascar          1   7124.9 7140.9
+ lti             1   7143.8 7159.8
+ hiqual_dv       5   7176.2 7200.2
- sex             1   7194.8 7206.8
- eth_simplified  1   7195.2 7207.2
&lt;none&gt;                7193.8 7207.8
+ eq_net_income   1   7193.4 7209.4
- age_group       3   7296.0 7304.0
- ph              1   7313.8 7325.8

Step:  AIC=7088.76
leaves_eilts ~ age_group + sex + eth_simplified + ph + hh_type

                 Df Deviance    AIC
+ mh              1   6982.3 7010.3
+ lti             1   7018.4 7046.4
+ hascar          1   7040.4 7068.4
+ hiqual_dv       5   7048.6 7084.6
+ eq_net_income   1   7059.1 7087.1
- sex             1   7063.2 7087.2
&lt;none&gt;                7062.8 7088.8
- eth_simplified  1   7067.2 7091.2
- age_group       3   7134.1 7154.1
- hh_type         6   7193.8 7207.8
- ph              1   7219.5 7243.5

Step:  AIC=7010.25
leaves_eilts ~ age_group + sex + eth_simplified + ph + hh_type + 
    mh

                 Df Deviance    AIC
+ lti             1   6951.5 6981.5
+ hascar          1   6960.9 6990.9
+ hiqual_dv       5   6969.2 7007.2
+ eq_net_income   1   6977.9 7007.9
- sex             1   6982.4 7008.4
&lt;none&gt;                6982.3 7010.3
- eth_simplified  1   6987.2 7013.2
- age_group       3   7046.8 7068.8
- mh              1   7062.8 7088.8
- hh_type         6   7108.7 7124.7
- ph              1   7193.9 7219.9

Step:  AIC=6981.53
leaves_eilts ~ age_group + sex + eth_simplified + ph + hh_type + 
    mh + lti

                 Df Deviance    AIC
+ hascar          1   6930.7 6962.7
+ hiqual_dv       5   6938.6 6978.6
- sex             1   6951.7 6979.7
+ eq_net_income   1   6948.0 6980.0
&lt;none&gt;                6951.5 6981.5
- eth_simplified  1   6956.6 6984.6
- lti             1   6982.3 7010.3
- age_group       3   7015.7 7039.7
- mh              1   7018.4 7046.4
- hh_type         6   7073.5 7091.5
- ph              1   7126.0 7154.0

Step:  AIC=6962.72
leaves_eilts ~ age_group + sex + eth_simplified + ph + hh_type + 
    mh + lti + hascar

                 Df Deviance    AIC
+ eq_net_income   1   6925.1 6959.1
- sex             1   6930.8 6960.8
&lt;none&gt;                6930.7 6962.7
+ hiqual_dv       5   6921.8 6963.8
- eth_simplified  1   6937.8 6967.8
- hascar          1   6951.5 6981.5
- lti             1   6960.9 6990.9
- age_group       3   6994.3 7020.3
- mh              1   6997.0 7027.0
- hh_type         6   7010.4 7030.4
- ph              1   7118.6 7148.6

Step:  AIC=6959.14
leaves_eilts ~ age_group + sex + eth_simplified + ph + hh_type + 
    mh + lti + hascar + eq_net_income

                 Df Deviance    AIC
- sex             1   6925.3 6957.3
+ hiqual_dv       5   6915.1 6959.1
&lt;none&gt;                6925.1 6959.1
- eq_net_income   1   6930.7 6962.7
- eth_simplified  1   6932.3 6964.3
- hascar          1   6948.0 6980.0
- lti             1   6954.2 6986.2
- age_group       3   6988.2 7016.2
- mh              1   6992.3 7024.3
- hh_type         6   7006.6 7028.6
- ph              1   7109.3 7141.3

Step:  AIC=6957.31
leaves_eilts ~ age_group + eth_simplified + ph + hh_type + mh + 
    lti + hascar + eq_net_income

                 Df Deviance    AIC
&lt;none&gt;                6925.3 6957.3
+ hiqual_dv       5   6915.3 6957.3
+ sex             1   6925.1 6959.1
- eq_net_income   1   6930.8 6960.8
- eth_simplified  1   6932.5 6962.5
- hascar          1   6948.3 6978.3
- lti             1   6954.4 6984.4
- age_group       3   6988.2 7014.2
- mh              1   6992.7 7022.7
- hh_type         6   7010.8 7030.8
- ph              1   7109.5 7139.5</code></pre>
</div>
</div>
<p>summaries</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb109"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mdl_stepAIC_eilts_pruned)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = leaves_eilts ~ age_group + hascar + eth_simplified + 
    lti + mh + ph + hh_type + eq_net_income, family = binomial, 
    data = data_tidied_eilts)

Coefficients:
                                        Estimate Std. Error z value Pr(&gt;|z|)
(Intercept)                           -2.0512063  0.3556240  -5.768 8.03e-09
age_group25-44                        -0.2192683  0.2417255  -0.907  0.36436
age_group45-54                        -0.5980716  0.2439143  -2.452  0.01421
age_group55-64                         0.0126202  0.2455833   0.051  0.95902
hascar                                 0.3332794  0.0696824   4.783 1.73e-06
eth_simplifiedWhite                   -0.2381612  0.0879782  -2.707  0.00679
ltiyes                                -0.8911596  0.1652373  -5.393 6.92e-08
mh                                     0.0199869  0.0024437   8.179 2.87e-16
ph                                     0.0362892  0.0026867  13.507  &lt; 2e-16
hh_typeSmall Adult                     0.3671511  0.0885362   4.147 3.37e-05
hh_typeSingle Parent                   0.5475556  0.1185595   4.618 3.87e-06
hh_typeFamily with 1-2 Children        0.5522897  0.1040624   5.307 1.11e-07
hh_typeFamily with 3 or more Children  0.4824734  0.1588577   3.037  0.00239
hh_typeSingle Pensioner                0.8279946  0.1510778   5.481 4.24e-08
hh_typePensioner Couple                0.7816120  0.1099629   7.108 1.18e-12
eq_net_income                         -0.0001207  0.0000529  -2.282  0.02249
                                         
(Intercept)                           ***
age_group25-44                           
age_group45-54                        *  
age_group55-64                           
hascar                                ***
eth_simplifiedWhite                   ** 
ltiyes                                ***
mh                                    ***
ph                                    ***
hh_typeSmall Adult                    ***
hh_typeSingle Parent                  ***
hh_typeFamily with 1-2 Children       ***
hh_typeFamily with 3 or more Children ** 
hh_typeSingle Pensioner               ***
hh_typePensioner Couple               ***
eq_net_income                         *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 7410.7  on 6548  degrees of freedom
Residual deviance: 6925.3  on 6533  degrees of freedom
AIC: 6957.3

Number of Fisher Scoring iterations: 4</code></pre>
</div>
</div>
<p>Next model summary</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb111"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mdl_stepAIC_eilts_grown)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = leaves_eilts ~ ph + hh_type + mh + age_group + 
    lti + hascar + eth_simplified + eq_net_income, family = binomial, 
    data = data_tidied_eilts)

Coefficients:
                                        Estimate Std. Error z value Pr(&gt;|z|)
(Intercept)                           -2.0512063  0.3556240  -5.768 8.03e-09
ph                                     0.0362892  0.0026867  13.507  &lt; 2e-16
hh_typeSmall Adult                     0.3671511  0.0885362   4.147 3.37e-05
hh_typeSingle Parent                   0.5475556  0.1185595   4.618 3.87e-06
hh_typeFamily with 1-2 Children        0.5522897  0.1040624   5.307 1.11e-07
hh_typeFamily with 3 or more Children  0.4824734  0.1588577   3.037  0.00239
hh_typeSingle Pensioner                0.8279946  0.1510778   5.481 4.24e-08
hh_typePensioner Couple                0.7816120  0.1099629   7.108 1.18e-12
mh                                     0.0199869  0.0024437   8.179 2.87e-16
age_group25-44                        -0.2192683  0.2417255  -0.907  0.36436
age_group45-54                        -0.5980716  0.2439143  -2.452  0.01421
age_group55-64                         0.0126202  0.2455833   0.051  0.95902
ltiyes                                -0.8911596  0.1652373  -5.393 6.92e-08
hascar                                 0.3332794  0.0696824   4.783 1.73e-06
eth_simplifiedWhite                   -0.2381612  0.0879782  -2.707  0.00679
eq_net_income                         -0.0001207  0.0000529  -2.282  0.02249
                                         
(Intercept)                           ***
ph                                    ***
hh_typeSmall Adult                    ***
hh_typeSingle Parent                  ***
hh_typeFamily with 1-2 Children       ***
hh_typeFamily with 3 or more Children ** 
hh_typeSingle Pensioner               ***
hh_typePensioner Couple               ***
mh                                    ***
age_group25-44                           
age_group45-54                        *  
age_group55-64                           
ltiyes                                ***
hascar                                ***
eth_simplifiedWhite                   ** 
eq_net_income                         *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 7410.7  on 6548  degrees of freedom
Residual deviance: 6925.3  on 6533  degrees of freedom
AIC: 6957.3

Number of Fisher Scoring iterations: 4</code></pre>
</div>
</div>
<p>Finally, both ways</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb113"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="fu">summary</span>(mdl_stepAIC_eilts_both)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
glm(formula = leaves_eilts ~ age_group + eth_simplified + ph + 
    hh_type + mh + lti + hascar + eq_net_income, family = binomial, 
    data = data_tidied_eilts)

Coefficients:
                                        Estimate Std. Error z value Pr(&gt;|z|)
(Intercept)                           -2.0512063  0.3556240  -5.768 8.03e-09
age_group25-44                        -0.2192683  0.2417255  -0.907  0.36436
age_group45-54                        -0.5980716  0.2439143  -2.452  0.01421
age_group55-64                         0.0126202  0.2455833   0.051  0.95902
eth_simplifiedWhite                   -0.2381612  0.0879782  -2.707  0.00679
ph                                     0.0362892  0.0026867  13.507  &lt; 2e-16
hh_typeSmall Adult                     0.3671511  0.0885362   4.147 3.37e-05
hh_typeSingle Parent                   0.5475556  0.1185595   4.618 3.87e-06
hh_typeFamily with 1-2 Children        0.5522897  0.1040624   5.307 1.11e-07
hh_typeFamily with 3 or more Children  0.4824734  0.1588577   3.037  0.00239
hh_typeSingle Pensioner                0.8279946  0.1510778   5.481 4.24e-08
hh_typePensioner Couple                0.7816120  0.1099629   7.108 1.18e-12
mh                                     0.0199869  0.0024437   8.179 2.87e-16
ltiyes                                -0.8911596  0.1652373  -5.393 6.92e-08
hascar                                 0.3332794  0.0696824   4.783 1.73e-06
eq_net_income                         -0.0001207  0.0000529  -2.282  0.02249
                                         
(Intercept)                           ***
age_group25-44                           
age_group45-54                        *  
age_group55-64                           
eth_simplifiedWhite                   ** 
ph                                    ***
hh_typeSmall Adult                    ***
hh_typeSingle Parent                  ***
hh_typeFamily with 1-2 Children       ***
hh_typeFamily with 3 or more Children ** 
hh_typeSingle Pensioner               ***
hh_typePensioner Couple               ***
mh                                    ***
ltiyes                                ***
hascar                                ***
eq_net_income                         *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

(Dispersion parameter for binomial family taken to be 1)

    Null deviance: 7410.7  on 6548  degrees of freedom
Residual deviance: 6925.3  on 6533  degrees of freedom
AIC: 6957.3

Number of Fisher Scoring iterations: 4</code></pre>
</div>
</div>
<p>Now Nagelkerke R^2 for each of these models</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb115"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>fmsb<span class="sc">::</span><span class="fu">NagelkerkeR2</span>(mdl_stepAIC_eilts_pruned)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$N
[1] 6549

$R2
[1] 0.1054462</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb117"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a>fmsb<span class="sc">::</span><span class="fu">NagelkerkeR2</span>(mdl_stepAIC_eilts_grown)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$N
[1] 6549

$R2
[1] 0.1054462</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb119"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a>fmsb<span class="sc">::</span><span class="fu">NagelkerkeR2</span>(mdl_stepAIC_eilts_both)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code>$N
[1] 6549

$R2
[1] 0.1054462</code></pre>
</div>
</div>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>
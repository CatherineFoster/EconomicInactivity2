<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.450">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Jon Minton">
<meta name="author" content="Martin Taulbut">
<meta name="author" content="Neil Chalmers">
<meta name="author" content="Debs Shipton">

<title>Assessing the impact of health on health-related economic inactivity</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="paper_01b__health_only_files/libs/clipboard/clipboard.min.js"></script>
<script src="paper_01b__health_only_files/libs/quarto-html/quarto.js"></script>
<script src="paper_01b__health_only_files/libs/quarto-html/popper.min.js"></script>
<script src="paper_01b__health_only_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="paper_01b__health_only_files/libs/quarto-html/anchor.min.js"></script>
<link href="paper_01b__health_only_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="paper_01b__health_only_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="paper_01b__health_only_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="paper_01b__health_only_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="paper_01b__health_only_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body>

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">
<div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
<div class="quarto-alternate-formats"><h2>Other Formats</h2><ul><li><a href="paper_01b__health_only.docx"><i class="bi bi-file-word"></i>MS Word</a></li></ul></div></div>
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Assessing the impact of health on health-related economic inactivity</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Authors</div>
    <div class="quarto-title-meta-contents">
             <p>Jon Minton </p>
             <p>Martin Taulbut </p>
             <p>Neil Chalmers </p>
             <p>Debs Shipton </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">load_all</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">'R'</span>))</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>base_dir_location <span class="ot">&lt;-</span> <span class="st">"big_data/UKDA-6614-stata/stata/stata13_se/ukhls"</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nnet)</span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(knitr)</span>
<span id="cb1-7"><a href="#cb1-7" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(kableExtra)</span>
<span id="cb1-8"><a href="#cb1-8" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(DiagrammeR)</span>
<span id="cb1-9"><a href="#cb1-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-10"><a href="#cb1-10" aria-hidden="true" tabindex="-1"></a>varnames <span class="ot">&lt;-</span>  <span class="fu">c</span>(</span>
<span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>  <span class="st">"jbstat"</span>, <span class="st">"dvage"</span>, <span class="st">"sex"</span>, <span class="st">"sf12mcs_dv"</span>, <span class="st">"sf12pcs_dv"</span></span>
<span id="cb1-12"><a href="#cb1-12" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb1-13"><a href="#cb1-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-14"><a href="#cb1-14" aria-hidden="true" tabindex="-1"></a>extract_what <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb1-15"><a href="#cb1-15" aria-hidden="true" tabindex="-1"></a>  <span class="st">"labels"</span>, <span class="st">"values"</span>, <span class="st">"labels"</span>, <span class="st">"values"</span>, <span class="st">"values"</span></span>
<span id="cb1-16"><a href="#cb1-16" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-hash="paper_01b__health_only_cache/html/unnamed-chunk-2_43fab5bddaf44bb325be8358cbef24ce">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>ind_data <span class="ot">&lt;-</span> <span class="fu">get_ind_level_vars_for_selected_waves</span>(</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a>  <span class="at">varnames =</span> varnames, <span class="at">vartypes =</span> extract_what</span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a>ind_data_standardised <span class="ot">&lt;-</span> </span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>  ind_data <span class="sc">|&gt;</span> </span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rename</span>(<span class="at">age =</span> dvage) <span class="sc">|&gt;</span> </span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(age, sf12mcs_dv, sf12pcs_dv), <span class="cf">function</span>(x) <span class="fu">ifelse</span>(x <span class="sc">&lt;</span> <span class="dv">0</span>, <span class="cn">NA</span>, x))) <span class="sc">%&gt;%</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="fu">across</span>(<span class="fu">c</span>(sf12mcs_dv, sf12pcs_dv), standardise_scores)) <span class="sc">|&gt;</span> </span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">between</span>(age, <span class="dv">16</span>, <span class="dv">64</span>)) <span class="sc">%&gt;%</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="fu">complete.cases</span>(.))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<section id="abstract" class="level1">
<h1>Abstract</h1>
<p><strong>Introduction</strong> The UK has comparatively high rates of working age economic inactivity (EI) due to poor health.</p>
<p><strong>Methods</strong> This paper uses a novel modelling framework, and data from the UKHLS, to estimate how much of this health-related EI (HREI) may be ‘due to’ i) poor general health directly. We modelled the individual transition probabilities between seven economic (in)activity states for a broadly representative population from the UKHLS observed pre-pandemic, who were between 16 and 64 years of age when interviewed. We projected how many move between states both under observed circumstances and in a scenario where an adverse driver was fully or largely mitigated, and compared how many more or fewer people were in the economically inactive long term sick state in both scenarios. From this we were able to produce estimates of the amount of HREI that may be ‘explained by’ these specific drivers.</p>
<p><strong>Findings</strong> …</p>
<p><strong>Discussion</strong> …</p>
</section>
<section id="notestodos" class="level1">
<h1><span style="color:blue">Notes/Todos</span></h1>
<ul style="color:blue; font-style:italic;">
<ul class="task-list">
<li><input type="checkbox" checked="">Adapt health code and run</li>
<li><input type="checkbox">Add discrete health variable example</li>
<li><input type="checkbox">Add biased/weighted unit change examples (biased to MH or PH)</li>
<li><input type="checkbox">Look at subpopulations e.g.&nbsp;by household type/lone parent cf two parent hh</li>
</ul>
</ul>
</section>
<section id="key-findingscontributions" class="level1">
<h1>Key Findings/Contributions</h1>
</section>
<section id="introduction" class="level1">
<h1>Introduction</h1>
<p>For working-age people, being employed or retired is associated with relatively good health, while being unemployment and long-term sickness) are associated with relatively poor health. Other economic states occupy an intermediate position. There is evidence to say that good quality work (e.g.&nbsp;insecure, high job-strain) is beneficial for health. There is also evidence that unemployment itself increases the risk of poor health (especially poor mental health) and premature mortality, rather than bad health being part of a broader selection effect.</p>
<p>From a policy perspective, there has been long-standing interest in increasing the share of the population in paid employment, and lowering the proportion who are unemployed, long-term sick and looking after home and family. Measures to achieve this have usually focused on moving people out of the detrimental states, rather than preventing them moving into them in the first place. They have tended to focus on the sub-groups of the population in these states and claiming out-of-work benefits. The policy mix has included public employment support, increased conditionality (including sanctions and changes to benefit eligibility) as well as increasing the financial support for working. In addition, some policies have provided financial help to meet the costs of working (e.g.&nbsp;childcare, Access to Work). While the overall approach has moved some people into work, it also appears to have pushed others into long-term sickness and other forms of economic inactivity.</p>
<section id="structure" class="level2">
<h2 class="anchored" data-anchor-id="structure">Structure</h2>
<p>The first part of the results section of this paper present model-based projections of how the size of each of the seven economic activity and economic inactivity states might change as a result of i) a discrete adverse health related exposure being ‘turned off’ in a UK population; and ii) two related continuous health states changed by one standard unit.</p>
<p>The second part of the results section will consider how these projections differ by a) males and females; b) younger and older persons of working age; and c) household composition, with an emphasis on identifying any additional barriers out of economic inactivity and into employment for single parents.</p>
</section>
</section>
<section id="methods" class="level1">
<h1>Methods</h1>
<section id="the-data" class="level2">
<h2 class="anchored" data-anchor-id="the-data">The data</h2>
<p>The data used to fit the models are all observations from wave a to j of the UKHLS, excluding observations where data was missing on any of the predictor and outcome variables.</p>
</section>
<section id="the-model" class="level2">
<h2 class="anchored" data-anchor-id="the-model">The model</h2>
<p>The model uses multinomial logistic regression to predict the economic (in)activity state in the next time period (approximately one year) based on the economic activity state in the current time period, the individual’s age, sex, and those specific drivers of interest.</p>
</section>
<section id="foundational-model" class="level2">
<h2 class="anchored" data-anchor-id="foundational-model">Foundational Model</h2>
<p>The foundational model specification aims to adequately control for the effects that age, current state and sex have on transition probabilities between states. To recap, we know the following:</p>
<ul>
<li>That state at time T influences state at time T+1, including that there is path dependence.</li>
<li>That transition propensities between states vary systematically by sex (in particular regarding the long-term carer state)</li>
<li>That transitions between states vary by age, but in different ways for different states, and in ways that aren’t linear with age.</li>
</ul>
<p>The foundational model specification operationalises the above knowledge as follows:</p>
<p><span class="math display">\[
S_{T+1}  \sim multinom(S_T \beta_S + male\beta_m + (S_T * male) \beta_I + bspline(x, 5)\beta_X)  
\]</span></p>
<p>i.e.&nbsp;that next state <span class="math inline">\(S_{T+1}\)</span> is predicted on the current state <span class="math inline">\(S_T\)</span>, sex (the <span class="math inline">\(male\)</span> term so female is the reference category), the interaction of current state and sex <span class="math inline">\(S_T * male\)</span> , and a flexible function of age <span class="math inline">\(bspline(x, 5)\)</span> .</p>
<p>The model is implemented using the multinom function of the nnet package as follows</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>  nnet<span class="sc">::</span><span class="fu">multinom</span>(</span>
<span id="cb3-2"><a href="#cb3-2" aria-hidden="true" tabindex="-1"></a>    next_status <span class="sc">~</span> this_status <span class="sc">*</span> sex <span class="sc">+</span> splines<span class="sc">::</span><span class="fu">bs</span>(age, <span class="dv">5</span>),</span>
<span id="cb3-3"><a href="#cb3-3" aria-hidden="true" tabindex="-1"></a>    ...</span>
<span id="cb3-4"><a href="#cb3-4" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="exposure-models" class="level2">
<h2 class="anchored" data-anchor-id="exposure-models">Exposure Models</h2>
<p>Exposure models extend the foundation with one or more additional variables. These variables are the exposures of interest, and for which we want to estimate the influence on economic activity levels and flows.</p>
<p>For a single exposure <span class="math inline">\(Z\)</span>, the equation simply extends the foundational model specification as follows:</p>
<p><span class="math display">\[
S_{T+1}  \sim multinom(S_T \beta_S + male\beta_m + (S_T * male) \beta_I + bspline(x, 5)\beta_X + Z \beta_Z)  
\]</span></p>
<p>Which is specified in R as follows</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>nnet<span class="sc">::</span><span class="fu">multinom</span>(</span>
<span id="cb4-2"><a href="#cb4-2" aria-hidden="true" tabindex="-1"></a>  next_status <span class="sc">~</span> this_status <span class="sc">*</span> sex <span class="sc">+</span> splines<span class="sc">::</span><span class="fu">bs</span>(age, <span class="dv">5</span>) <span class="sc">+</span> Z,</span>
<span id="cb4-3"><a href="#cb4-3" aria-hidden="true" tabindex="-1"></a>  ...</span>
<span id="cb4-4"><a href="#cb4-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>For two exposures, <span class="math inline">\(Z_1\)</span> and <span class="math inline">\(Z_2\)</span>, this simply becomes</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>nnet<span class="sc">::</span><span class="fu">multinom</span>(</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a>  next_status <span class="sc">~</span> this_status <span class="sc">*</span> sex <span class="sc">+</span> splines<span class="sc">::</span><span class="fu">bs</span>(age, <span class="dv">5</span>) <span class="sc">+</span> Z1 <span class="sc">+</span> Z2,</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a>  ...</span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>and so on.</p>
<p>In some cases (as with estimating the effects of health as an exposure) interaction terms are included between exposure variables as well. The decision about whether to include such interactions is made based on both our understanding of the extent to which factors are likely to interact in practice, and the penalised model fit as assessed using metrics like AIC and BIC.</p>
</section>
<section id="the-simulation" class="level2">
<h2 class="anchored" data-anchor-id="the-simulation">The simulation</h2>
<p>We estimate the effect that health drivers have on the composition of economic activity and inactivity in the general working age population by creating a model that… does stuff.</p>
<p>We create scenarios where adverse drivers are either, i) as observed or ii) ‘turned off’, and compare the proportion of people estimated to be in each economic (in)activity state between scenarios, in order to produce estimates of how much of HREI is ‘due to’ the driver/exposure of interest.</p>
</section>
</section>
<section id="results" class="level1">
<h1>Results</h1>
<section id="part-one-effects-of-discrete-and-continous-health-outcomes-on-populations-in-general" class="level2">
<h2 class="anchored" data-anchor-id="part-one-effects-of-discrete-and-continous-health-outcomes-on-populations-in-general">Part one: Effects of discrete and continous health outcomes on populations in general</h2>
<section id="modelling-discrete-health-state-lltino-llti-people-aged-16-64" class="level3">
<h3 class="anchored" data-anchor-id="modelling-discrete-health-state-lltino-llti-people-aged-16-64">Modelling discrete health state (LLTI/No LLTI), people aged 16-64</h3>
<p>In each wave of the UKHLS, respondents are asked the following question</p>
<blockquote class="blockquote">
<p>Do you have any long-standing physical or mental impairment, illness or disability? By ‘long-standing’ I mean anything that has troubled you over a period of at least 12 months or that is likely to trouble you over a period of at least 12 months.</p>
</blockquote>
<p><strong>Should I do the following?</strong></p>
<ul>
<li><strong>DESCRIPTIVE STATS</strong></li>
<li>SEX DIFFERENCES</li>
<li>DIFFERENCES BY AGE GROUP</li>
<li>ANY DIFFERENCES BETWEEN WAVES</li>
</ul>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>devtools<span class="sc">::</span><span class="fu">load_all</span>(here<span class="sc">::</span><span class="fu">here</span>(<span class="st">'R'</span>))</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a><span class="co"># library(haven)</span></span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a><span class="co"># library(here)</span></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(nnet)</span>
<span id="cb6-6"><a href="#cb6-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-7"><a href="#cb6-7" aria-hidden="true" tabindex="-1"></a><span class="co"># devtools::load_all(here('R'))</span></span>
<span id="cb6-8"><a href="#cb6-8" aria-hidden="true" tabindex="-1"></a><span class="co"># base_dir_location &lt;- "big_data/UKDA-6614-stata/stata/stata13_se/ukhls"</span></span>
<span id="cb6-9"><a href="#cb6-9" aria-hidden="true" tabindex="-1"></a><span class="co"># indresp_files &lt;- dir(here(base_dir_location), pattern = "[a-z]_indresp.dta", full.names = TRUE)</span></span>
<span id="cb6-10"><a href="#cb6-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-11"><a href="#cb6-11" aria-hidden="true" tabindex="-1"></a>varnames <span class="ot">&lt;-</span>  <span class="fu">c</span>(</span>
<span id="cb6-12"><a href="#cb6-12" aria-hidden="true" tabindex="-1"></a>  <span class="st">"jbstat"</span>, <span class="st">"dvage"</span>, <span class="st">"sex"</span>, <span class="st">"health"</span></span>
<span id="cb6-13"><a href="#cb6-13" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb6-14"><a href="#cb6-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-15"><a href="#cb6-15" aria-hidden="true" tabindex="-1"></a>vartypes <span class="ot">&lt;-</span> <span class="fu">c</span>(</span>
<span id="cb6-16"><a href="#cb6-16" aria-hidden="true" tabindex="-1"></a>  <span class="st">"labels"</span>, <span class="st">"values"</span>, <span class="st">"labels"</span>, <span class="st">"labels"</span></span>
<span id="cb6-17"><a href="#cb6-17" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb6-18"><a href="#cb6-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-19"><a href="#cb6-19" aria-hidden="true" tabindex="-1"></a>df_ind_llti <span class="ot">&lt;-</span> <span class="fu">get_ind_level_vars_for_selected_waves</span>(<span class="at">varnames =</span> varnames, <span class="at">vartypes =</span> vartypes, <span class="at">waves =</span> letters[<span class="dv">1</span><span class="sc">:</span><span class="dv">11</span>])</span>
<span id="cb6-20"><a href="#cb6-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-21"><a href="#cb6-21" aria-hidden="true" tabindex="-1"></a><span class="co"># Clean the data </span></span>
<span id="cb6-22"><a href="#cb6-22" aria-hidden="true" tabindex="-1"></a>df_ind_llti_standardised <span class="ot">&lt;-</span> </span>
<span id="cb6-23"><a href="#cb6-23" aria-hidden="true" tabindex="-1"></a>  df_ind_llti <span class="sc">|&gt;</span> </span>
<span id="cb6-24"><a href="#cb6-24" aria-hidden="true" tabindex="-1"></a>  <span class="co"># dvage uses negative values to indicate missing. The code below explicitly turns them all to missing values</span></span>
<span id="cb6-25"><a href="#cb6-25" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="fu">across</span>(dvage, <span class="cf">function</span>(x) <span class="fu">ifelse</span>(x <span class="sc">&lt;</span> <span class="dv">0</span>, <span class="cn">NA</span>, x))) <span class="sc">|&gt;</span> </span>
<span id="cb6-26"><a href="#cb6-26" aria-hidden="true" tabindex="-1"></a>  <span class="co"># This renames dvage to age</span></span>
<span id="cb6-27"><a href="#cb6-27" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rename</span>(<span class="at">age =</span> dvage) <span class="sc">|&gt;</span> </span>
<span id="cb6-28"><a href="#cb6-28" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="fu">between</span>(age, <span class="dv">16</span>, <span class="dv">64</span>))  <span class="sc">|&gt;</span> </span>
<span id="cb6-29"><a href="#cb6-29" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb6-30"><a href="#cb6-30" aria-hidden="true" tabindex="-1"></a>      <span class="at">lt_condition =</span> <span class="fu">case_when</span>(</span>
<span id="cb6-31"><a href="#cb6-31" aria-hidden="true" tabindex="-1"></a>        health <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"No"</span>, <span class="st">"no"</span>) <span class="sc">~</span> <span class="cn">FALSE</span>,</span>
<span id="cb6-32"><a href="#cb6-32" aria-hidden="true" tabindex="-1"></a>        health <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Yes"</span>, <span class="st">"yes"</span>) <span class="sc">~</span> <span class="cn">TRUE</span>,</span>
<span id="cb6-33"><a href="#cb6-33" aria-hidden="true" tabindex="-1"></a>        <span class="cn">TRUE</span> <span class="sc">~</span> <span class="cn">NA_integer_</span></span>
<span id="cb6-34"><a href="#cb6-34" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">|&gt;</span> <span class="fu">as.logical</span>()</span>
<span id="cb6-35"><a href="#cb6-35" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">%&gt;%</span> </span>
<span id="cb6-36"><a href="#cb6-36" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(<span class="fu">complete.cases</span>(.)) </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<div class="cell" data-hash="paper_01b__health_only_cache/html/unnamed-chunk-5_fefc19ce1abaa8f3fcf3481746f8bb61">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb7"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>mod_00_llti <span class="ot">&lt;-</span> </span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>  nnet<span class="sc">::</span><span class="fu">multinom</span>(</span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a>    next_status <span class="sc">~</span> this_status <span class="sc">*</span> sex <span class="sc">+</span> splines<span class="sc">::</span><span class="fu">bs</span>(age, <span class="dv">5</span>),</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> df_ind_llti_standardised <span class="sc">|&gt;</span> </span>
<span id="cb7-5"><a href="#cb7-5" aria-hidden="true" tabindex="-1"></a>      <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(lt_condition)),</span>
<span id="cb7-6"><a href="#cb7-6" aria-hidden="true" tabindex="-1"></a>    <span class="at">maxit =</span> <span class="dv">200</span></span>
<span id="cb7-7"><a href="#cb7-7" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># weights:  238 (198 variable)
initial  value 593459.785440 
iter  10 value 217065.229935
iter  20 value 181835.205003
iter  30 value 176173.701928
iter  40 value 169054.073365
iter  50 value 162622.177139
iter  60 value 158455.088600
iter  70 value 154995.077286
iter  80 value 153202.192527
iter  90 value 150817.463737
iter 100 value 147188.232683
iter 110 value 144869.729481
iter 120 value 144353.815392
iter 130 value 144208.112001
iter 140 value 144201.656766
iter 150 value 144200.269008
iter 160 value 144200.150263
final  value 144200.130290 
converged</code></pre>
</div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb9"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>mod_llti <span class="ot">&lt;-</span> </span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>  nnet<span class="sc">::</span><span class="fu">multinom</span>(</span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a>    next_status <span class="sc">~</span> this_status <span class="sc">*</span> sex <span class="sc">+</span> splines<span class="sc">::</span><span class="fu">bs</span>(age, <span class="dv">5</span>) <span class="sc">+</span> lt_condition,</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> df_ind_llti_standardised,</span>
<span id="cb9-5"><a href="#cb9-5" aria-hidden="true" tabindex="-1"></a>    <span class="at">maxit =</span> <span class="dv">200</span></span>
<span id="cb9-6"><a href="#cb9-6" aria-hidden="true" tabindex="-1"></a>  )</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output cell-output-stdout">
<pre><code># weights:  245 (204 variable)
initial  value 593459.785440 
iter  10 value 191760.039731
iter  20 value 184082.812596
iter  30 value 178733.279863
iter  40 value 158204.780390
iter  50 value 152963.660689
iter  60 value 150905.271984
iter  70 value 145439.304192
iter  80 value 143925.206548
iter  90 value 143354.046183
iter 100 value 142852.336483
iter 110 value 142582.530287
iter 120 value 142464.747406
iter 130 value 142419.416446
iter 140 value 142363.195144
iter 150 value 142360.107659
iter 160 value 142359.303880
iter 170 value 142359.246225
final  value 142359.228993 
converged</code></pre>
</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>aics <span class="ot">&lt;-</span> <span class="fu">AIC</span>(mod_00_llti, mod_llti)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>bics <span class="ot">&lt;-</span> <span class="fu">BIC</span>(mod_00_llti, mod_llti)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a>aics <span class="sc">|&gt;</span> </span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">"model"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a>    bics <span class="sc">|&gt;</span> <span class="fu">rownames_to_column</span>(<span class="at">var=</span><span class="st">"model"</span>)    </span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb11-9"><a href="#cb11-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb11-10"><a href="#cb11-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">aic_rank =</span> <span class="fu">rank</span>(AIC),</span>
<span id="cb11-11"><a href="#cb11-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">bic_rank =</span> <span class="fu">rank</span>(BIC)</span>
<span id="cb11-12"><a href="#cb11-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb11-13"><a href="#cb11-13" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">model</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">df</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">AIC</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">BIC</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">aic_rank</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">bic_rank</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">mod_00_llti</td>
<td style="text-align: right;">126</td>
<td style="text-align: right;">288652.3</td>
<td style="text-align: right;">289991.4</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">mod_llti</td>
<td style="text-align: right;">132</td>
<td style="text-align: right;">284982.5</td>
<td style="text-align: right;">286385.4</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
</tr>
</tbody>
</table>


</div>
</div>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>econ_cat_levels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Employed"</span>, <span class="st">"Unemployed"</span>, <span class="st">"Inactive student"</span>, <span class="st">"Inactive care"</span>, <span class="st">"Inactive long term sick"</span>, <span class="st">"Inactive retired"</span>, <span class="st">"Inactive other"</span>)</span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-4"><a href="#cb12-4" aria-hidden="true" tabindex="-1"></a>df_ind_ltcondition_wave_j_baseline <span class="ot">&lt;-</span> </span>
<span id="cb12-5"><a href="#cb12-5" aria-hidden="true" tabindex="-1"></a>  df_ind_llti_standardised <span class="sc">|&gt;</span> </span>
<span id="cb12-6"><a href="#cb12-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(<span class="sc">!</span><span class="fu">is.na</span>(lt_condition)) <span class="sc">|&gt;</span> </span>
<span id="cb12-7"><a href="#cb12-7" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(wave <span class="sc">==</span> <span class="st">'j'</span>)</span>
<span id="cb12-8"><a href="#cb12-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-9"><a href="#cb12-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-10"><a href="#cb12-10" aria-hidden="true" tabindex="-1"></a>df_ind_ltcondition_wave_j_counterfactual <span class="ot">&lt;-</span> </span>
<span id="cb12-11"><a href="#cb12-11" aria-hidden="true" tabindex="-1"></a>  df_ind_ltcondition_wave_j_baseline  <span class="sc">|&gt;</span> </span>
<span id="cb12-12"><a href="#cb12-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">lt_condition =</span> <span class="cn">FALSE</span>)</span>
<span id="cb12-13"><a href="#cb12-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-14"><a href="#cb12-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-15"><a href="#cb12-15" aria-hidden="true" tabindex="-1"></a>preds_baseline <span class="ot">&lt;-</span> <span class="fu">predict</span>(mod_llti, <span class="at">newdata =</span> df_ind_ltcondition_wave_j_baseline, <span class="at">type =</span> <span class="st">"probs"</span>)</span>
<span id="cb12-16"><a href="#cb12-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-17"><a href="#cb12-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-18"><a href="#cb12-18" aria-hidden="true" tabindex="-1"></a>preds_counterfactual <span class="ot">&lt;-</span> <span class="fu">predict</span>(mod_llti, <span class="at">newdata =</span> df_ind_ltcondition_wave_j_counterfactual, <span class="at">type =</span> <span class="st">"probs"</span>)</span>
<span id="cb12-19"><a href="#cb12-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-20"><a href="#cb12-20" aria-hidden="true" tabindex="-1"></a>predictions_summary_matrix <span class="ot">&lt;-</span> <span class="fu">cbind</span>(</span>
<span id="cb12-21"><a href="#cb12-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># The number 2 indicates do the sum function for each column.</span></span>
<span id="cb12-22"><a href="#cb12-22" aria-hidden="true" tabindex="-1"></a>  <span class="co"># If it were 1 then this would sum for each row (which should add up to 1 in call cases)</span></span>
<span id="cb12-23"><a href="#cb12-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">apply</span>(preds_baseline, <span class="dv">2</span>, sum),</span>
<span id="cb12-24"><a href="#cb12-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">apply</span>(preds_counterfactual, <span class="dv">2</span>, sum)</span>
<span id="cb12-25"><a href="#cb12-25" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb12-26"><a href="#cb12-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-27"><a href="#cb12-27" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(predictions_summary_matrix) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"baseline"</span>, <span class="st">"counterfactual"</span>)</span>
<span id="cb12-28"><a href="#cb12-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-29"><a href="#cb12-29" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-30"><a href="#cb12-30" aria-hidden="true" tabindex="-1"></a>predictions_summary_matrix <span class="ot">&lt;-</span> <span class="fu">cbind</span>(</span>
<span id="cb12-31"><a href="#cb12-31" aria-hidden="true" tabindex="-1"></a>  <span class="co"># The number 2 indicates do the sum function for each column.</span></span>
<span id="cb12-32"><a href="#cb12-32" aria-hidden="true" tabindex="-1"></a>  <span class="co"># If it were 1 then this would sum for each row (which should add up to 1 in call cases)</span></span>
<span id="cb12-33"><a href="#cb12-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">apply</span>(preds_baseline, <span class="dv">2</span>, <span class="cf">function</span>(x) <span class="fu">round</span>(<span class="fu">sum</span>(x), <span class="dv">0</span>)),</span>
<span id="cb12-34"><a href="#cb12-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">apply</span>(preds_counterfactual, <span class="dv">2</span>, <span class="cf">function</span>(x) <span class="fu">round</span>(<span class="fu">sum</span>(x), <span class="dv">0</span>))</span>
<span id="cb12-35"><a href="#cb12-35" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb12-36"><a href="#cb12-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-37"><a href="#cb12-37" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(predictions_summary_matrix) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"base"</span>, <span class="st">"counterfactual"</span>)</span>
<span id="cb12-38"><a href="#cb12-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-39"><a href="#cb12-39" aria-hidden="true" tabindex="-1"></a>tbl_mod_llti <span class="ot">&lt;-</span> </span>
<span id="cb12-40"><a href="#cb12-40" aria-hidden="true" tabindex="-1"></a>  predictions_summary_matrix <span class="sc">|&gt;</span> </span>
<span id="cb12-41"><a href="#cb12-41" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span> </span>
<span id="cb12-42"><a href="#cb12-42" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">"State"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb12-43"><a href="#cb12-43" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb12-44"><a href="#cb12-44" aria-hidden="true" tabindex="-1"></a>        <span class="at">State =</span> <span class="fu">factor</span>(</span>
<span id="cb12-45"><a href="#cb12-45" aria-hidden="true" tabindex="-1"></a>          State, </span>
<span id="cb12-46"><a href="#cb12-46" aria-hidden="true" tabindex="-1"></a>          <span class="at">ordered =</span> <span class="cn">TRUE</span>, </span>
<span id="cb12-47"><a href="#cb12-47" aria-hidden="true" tabindex="-1"></a>          <span class="at">levels =</span> econ_cat_levels</span>
<span id="cb12-48"><a href="#cb12-48" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb12-49"><a href="#cb12-49" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">|&gt;</span> </span>
<span id="cb12-50"><a href="#cb12-50" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(State) <span class="sc">|&gt;</span> </span>
<span id="cb12-51"><a href="#cb12-51" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb12-52"><a href="#cb12-52" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Absolute Change</span><span class="st">`</span> <span class="ot">=</span> counterfactual <span class="sc">-</span> base,</span>
<span id="cb12-53"><a href="#cb12-53" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Relative Change</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">Absolute Change</span><span class="st">`</span> <span class="sc">/</span> base</span>
<span id="cb12-54"><a href="#cb12-54" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb12-55"><a href="#cb12-55" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb12-56"><a href="#cb12-56" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Relative Change</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">ifelse</span>(</span>
<span id="cb12-57"><a href="#cb12-57" aria-hidden="true" tabindex="-1"></a>        <span class="st">`</span><span class="at">Relative Change</span><span class="st">`</span> <span class="sc">&gt;</span> <span class="dv">0</span>, </span>
<span id="cb12-58"><a href="#cb12-58" aria-hidden="true" tabindex="-1"></a>        glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">"{round(100 * `Relative Change`, 1)}% up"</span> ),</span>
<span id="cb12-59"><a href="#cb12-59" aria-hidden="true" tabindex="-1"></a>        glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">"{round(-100 * `Relative Change`, 1)}% down"</span>)</span>
<span id="cb12-60"><a href="#cb12-60" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb12-61"><a href="#cb12-61" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb12-62"><a href="#cb12-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-63"><a href="#cb12-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb12-64"><a href="#cb12-64" aria-hidden="true" tabindex="-1"></a>tbl_mod_llti <span class="sc">|&gt;</span> knitr<span class="sc">::</span><span class="fu">kable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="tbl-llti" class="anchored">
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<caption>Table&nbsp;1: Estimated effect of Limiting Long-term Illnesses (LLTI) on Economic (In)activity states</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">State</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">base</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">counterfactual</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Absolute Change</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Relative Change</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Employed</td>
<td style="text-align: right;">15481</td>
<td style="text-align: right;">15764</td>
<td style="text-align: right;">283</td>
<td style="text-align: left;">1.8% up</td>
</tr>
<tr class="even">
<td style="text-align: left;">Unemployed</td>
<td style="text-align: right;">1041</td>
<td style="text-align: right;">1097</td>
<td style="text-align: right;">56</td>
<td style="text-align: left;">5.4% up</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Inactive student</td>
<td style="text-align: right;">1256</td>
<td style="text-align: right;">1267</td>
<td style="text-align: right;">11</td>
<td style="text-align: left;">0.9% up</td>
</tr>
<tr class="even">
<td style="text-align: left;">Inactive care</td>
<td style="text-align: right;">1103</td>
<td style="text-align: right;">1198</td>
<td style="text-align: right;">95</td>
<td style="text-align: left;">8.6% up</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Inactive long term sick</td>
<td style="text-align: right;">920</td>
<td style="text-align: right;">366</td>
<td style="text-align: right;">-554</td>
<td style="text-align: left;">60.2% down</td>
</tr>
<tr class="even">
<td style="text-align: left;">Inactive retired</td>
<td style="text-align: right;">1437</td>
<td style="text-align: right;">1544</td>
<td style="text-align: right;">107</td>
<td style="text-align: left;">7.4% up</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Inactive other</td>
<td style="text-align: right;">137</td>
<td style="text-align: right;">139</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">1.5% up</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<p><a href="#tbl-llti">Table&nbsp;1</a> indicates that, if everyone with a LLTI ceased to have one, the proportion of the population who are inactive for reasons of long-term sickness would be reduced by 60%. The proportion of the population in each of the other states, both economically inactive and active, would then increase. This includes a predicted 5.4% increase in unemployment, an 8.6% increase in long-term carers, and a 7.4% increase in those of working age who retire.</p>
<p>The finding that removing LLTI would greatly decrease the economically inactive long-term sick population should, of course, not be surprising. We can interpret these results, broadly, as suggesting that the majority of inactivity due to long-term sickness is caused by LLTI. We might in fact consider the 40% or so who remain in this category even in a scenario in which no one has LLTI to be more surprising.</p>
</section>
<section id="modelling-continuous-health-effects-people-aged-16-64" class="level3">
<h3 class="anchored" data-anchor-id="modelling-continuous-health-effects-people-aged-16-64">Modelling continuous health effects, people aged 16-64</h3>
<p>The effect of suboptimal health as an exposure was assessed using SF-12 scores, subdivided into the physical health (PH) and mental health (MH) subdomains, and then standardised over the observed population to have a mean of 0 and standard deviation of 1.</p>
<p>Four different exposure model specifications were considered:</p>
<ul>
<li><code>mod_mh</code>: MH only</li>
<li><code>mod_ph</code>: PH only</li>
<li><code>mod_ph_mh</code>: MH and PH as independent effects</li>
<li><code>mod_phmh</code>: MH and PH including an interaction term</li>
</ul>
<p>Each of these was compared for penalised model fit against the foundational model specification using AIC and BIC, with lower scores preferred. (1 = most preferred; 5 = least preferred)</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>aics <span class="ot">&lt;-</span> <span class="fu">AIC</span>(mod_00, mod_ph, mod_mh, mod_ph_mh, mod_phmh)</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>bics <span class="ot">&lt;-</span> <span class="fu">BIC</span>(mod_00, mod_ph, mod_mh, mod_ph_mh, mod_phmh)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>aics <span class="sc">|&gt;</span> </span>
<span id="cb13-5"><a href="#cb13-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">"model"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb13-6"><a href="#cb13-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(</span>
<span id="cb13-7"><a href="#cb13-7" aria-hidden="true" tabindex="-1"></a>    bics <span class="sc">|&gt;</span> <span class="fu">rownames_to_column</span>(<span class="at">var=</span><span class="st">"model"</span>)    </span>
<span id="cb13-8"><a href="#cb13-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb13-9"><a href="#cb13-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb13-10"><a href="#cb13-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">aic_rank =</span> <span class="fu">rank</span>(AIC),</span>
<span id="cb13-11"><a href="#cb13-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">bic_rank =</span> <span class="fu">rank</span>(BIC)</span>
<span id="cb13-12"><a href="#cb13-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb13-13"><a href="#cb13-13" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="tbl-model_fit_ghq12" class="anchored">
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<caption>Table&nbsp;2: AIC and BIC for different model specifications for including health as an exposure</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">model</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">df</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">AIC</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">BIC</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">aic_rank</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">bic_rank</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">mod_00</td>
<td style="text-align: right;">126</td>
<td style="text-align: right;">249265.2</td>
<td style="text-align: right;">250588.8</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="even">
<td style="text-align: left;">mod_ph</td>
<td style="text-align: right;">132</td>
<td style="text-align: right;">245398.4</td>
<td style="text-align: right;">246785.1</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">3</td>
</tr>
<tr class="odd">
<td style="text-align: left;">mod_mh</td>
<td style="text-align: right;">132</td>
<td style="text-align: right;">247752.0</td>
<td style="text-align: right;">249138.7</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: left;">mod_ph_mh</td>
<td style="text-align: right;">138</td>
<td style="text-align: right;">243527.6</td>
<td style="text-align: right;">244977.3</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="odd">
<td style="text-align: left;">mod_phmh</td>
<td style="text-align: right;">144</td>
<td style="text-align: right;">243420.4</td>
<td style="text-align: right;">244933.1</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">1</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<p><a href="#tbl-model_fit_ghq12">Table&nbsp;2</a> shows that the specification with an interaction between MH and PH is preferred by both AIC and BIC. Of models including only MH or PH, the model specification for PH is preferred.</p>
<p>Based on this, we will consider the following scenarios, each with the best performing model, <code>mod_phmh</code>:</p>
<ul>
<li>Scenario 1: Mental health only is improved (but physical health is unchanged)</li>
<li>Scenario 2: Physical health only is improved (but mental health is unchanged)</li>
<li>Scenario 3: Both mental health and physical health are changed by equal amounts</li>
<li>Scenario 4: Both mental health and physical health are changed, but mental health is changed more.</li>
<li>Scenario 5: Both mental health and physical health are changed, but physical health is changed more.</li>
</ul>
<p>These scenarios are represented graphically in <a href="#fig-genhealth">Figure&nbsp;1</a>. All interventions on the unit circle (grey curve) represent equal change over both dimensions, but the scenarios differ in terms of how the two components, mental health and physical health, contribute to the overall health change.<a href="#fn1" class="footnote-ref" id="fnref1" role="doc-noteref"><sup>1</sup></a></p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(geomtextpath)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a>pos_y <span class="ot">&lt;-</span> <span class="cf">function</span>(x) {<span class="fu">sqrt</span>(<span class="dv">1</span> <span class="sc">-</span> x<span class="sc">^</span><span class="dv">2</span>)}</span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">by =</span> <span class="fl">0.001</span>)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a>dta <span class="ot">&lt;-</span> <span class="fu">tibble</span>(</span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>  <span class="at">x =</span> x</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>) <span class="sc">|&gt;</span> </span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a>    <span class="at">y =</span> <span class="fu">pos_y</span>(x)</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>dta <span class="sc">|&gt;</span> </span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">ggplot</span>(<span class="fu">aes</span>(<span class="at">x =</span> x, <span class="at">y =</span> y)) <span class="sc">+</span> </span>
<span id="cb14-14"><a href="#cb14-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">geom_line</span>(<span class="at">color =</span> <span class="st">"grey"</span>) <span class="sc">+</span> </span>
<span id="cb14-15"><a href="#cb14-15" aria-hidden="true" tabindex="-1"></a>    <span class="fu">coord_equal</span>() <span class="sc">+</span> </span>
<span id="cb14-16"><a href="#cb14-16" aria-hidden="true" tabindex="-1"></a>    <span class="fu">labs</span>(<span class="at">x =</span> <span class="st">"Physical Health (Standardised)"</span>,</span>
<span id="cb14-17"><a href="#cb14-17" aria-hidden="true" tabindex="-1"></a>         <span class="at">y =</span> <span class="st">"Mental Health (Standardised)"</span>,</span>
<span id="cb14-18"><a href="#cb14-18" aria-hidden="true" tabindex="-1"></a>         <span class="at">title =</span> <span class="st">"Health improvement scenarios modelled"</span>) <span class="sc">+</span> </span>
<span id="cb14-19"><a href="#cb14-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">theme_minimal</span>() <span class="sc">+</span> </span>
<span id="cb14-20"><a href="#cb14-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"point"</span>, <span class="at">x =</span> <span class="dv">1</span>, <span class="at">y =</span> <span class="dv">0</span>) <span class="sc">+</span> </span>
<span id="cb14-21"><a href="#cb14-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"point"</span>, <span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="dv">1</span>) <span class="sc">+</span> </span>
<span id="cb14-22"><a href="#cb14-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"point"</span>, <span class="at">x =</span> <span class="dv">1</span><span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">2</span>), <span class="at">y =</span> <span class="dv">1</span><span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">2</span>)) <span class="sc">+</span> </span>
<span id="cb14-23"><a href="#cb14-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"point"</span>, <span class="at">x =</span>  <span class="dv">2</span> <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">5</span>), <span class="at">y =</span> <span class="dv">1</span> <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">5</span>)) <span class="sc">+</span> </span>
<span id="cb14-24"><a href="#cb14-24" aria-hidden="true" tabindex="-1"></a>  <span class="fu">annotate</span>(<span class="st">"point"</span>, <span class="at">x =</span> <span class="dv">1</span> <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">5</span>), <span class="at">y =</span> <span class="dv">2</span> <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">5</span>)) <span class="sc">+</span> </span>
<span id="cb14-25"><a href="#cb14-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_textcurve</span>(</span>
<span id="cb14-26"><a href="#cb14-26" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="dv">0</span>, <span class="at">xend =</span> <span class="dv">0</span>, <span class="at">yend =</span> <span class="dv">1</span>), </span>
<span id="cb14-27"><a href="#cb14-27" aria-hidden="true" tabindex="-1"></a>                      <span class="at">mapping =</span> <span class="fu">aes</span>(x, y, <span class="at">xend =</span> xend,  <span class="at">yend =</span> yend), </span>
<span id="cb14-28"><a href="#cb14-28" aria-hidden="true" tabindex="-1"></a>                      <span class="at">label =</span> <span class="st">"S1: MH Only"</span>, </span>
<span id="cb14-29"><a href="#cb14-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">curvature =</span> <span class="dv">0</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">arrow =</span> <span class="fu">arrow</span>(),</span>
<span id="cb14-30"><a href="#cb14-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">vjust =</span> <span class="fl">0.5</span></span>
<span id="cb14-31"><a href="#cb14-31" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb14-32"><a href="#cb14-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_textcurve</span>(</span>
<span id="cb14-33"><a href="#cb14-33" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="dv">0</span>, <span class="at">xend =</span> <span class="dv">1</span>, <span class="at">yend =</span> <span class="dv">0</span>), </span>
<span id="cb14-34"><a href="#cb14-34" aria-hidden="true" tabindex="-1"></a>                      <span class="at">mapping =</span> <span class="fu">aes</span>(x, y, <span class="at">xend =</span> xend,  <span class="at">yend =</span> yend), </span>
<span id="cb14-35"><a href="#cb14-35" aria-hidden="true" tabindex="-1"></a>                      <span class="at">label =</span> <span class="st">"S2: PH Only"</span>, </span>
<span id="cb14-36"><a href="#cb14-36" aria-hidden="true" tabindex="-1"></a>    <span class="at">curvature =</span> <span class="dv">0</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">arrow =</span> <span class="fu">arrow</span>(),</span>
<span id="cb14-37"><a href="#cb14-37" aria-hidden="true" tabindex="-1"></a>    <span class="at">vjust =</span> <span class="fl">0.5</span></span>
<span id="cb14-38"><a href="#cb14-38" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb14-39"><a href="#cb14-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_textcurve</span>(</span>
<span id="cb14-40"><a href="#cb14-40" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="dv">0</span>, <span class="at">xend =</span> <span class="dv">1</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span>), <span class="at">yend =</span> <span class="dv">1</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">2</span>)), </span>
<span id="cb14-41"><a href="#cb14-41" aria-hidden="true" tabindex="-1"></a>                      <span class="at">mapping =</span> <span class="fu">aes</span>(x, y, <span class="at">xend =</span> xend,  <span class="at">yend =</span> yend), </span>
<span id="cb14-42"><a href="#cb14-42" aria-hidden="true" tabindex="-1"></a>                      <span class="at">label =</span> <span class="st">"S3: Equal Gain"</span>, </span>
<span id="cb14-43"><a href="#cb14-43" aria-hidden="true" tabindex="-1"></a>    <span class="at">curvature =</span> <span class="dv">0</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">arrow =</span> <span class="fu">arrow</span>(),</span>
<span id="cb14-44"><a href="#cb14-44" aria-hidden="true" tabindex="-1"></a>    <span class="at">vjust =</span> <span class="fl">0.5</span></span>
<span id="cb14-45"><a href="#cb14-45" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">+</span> </span>
<span id="cb14-46"><a href="#cb14-46" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_textcurve</span>(</span>
<span id="cb14-47"><a href="#cb14-47" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="dv">0</span>, <span class="at">yend =</span> <span class="dv">2</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">5</span>), <span class="at">xend =</span> <span class="dv">1</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">5</span>)), </span>
<span id="cb14-48"><a href="#cb14-48" aria-hidden="true" tabindex="-1"></a>                      <span class="at">mapping =</span> <span class="fu">aes</span>(x, y, <span class="at">xend =</span> xend,  <span class="at">yend =</span> yend), </span>
<span id="cb14-49"><a href="#cb14-49" aria-hidden="true" tabindex="-1"></a>                      <span class="at">label =</span> <span class="st">"S4: MH Bias"</span>, </span>
<span id="cb14-50"><a href="#cb14-50" aria-hidden="true" tabindex="-1"></a>    <span class="at">curvature =</span> <span class="dv">0</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">arrow =</span> <span class="fu">arrow</span>(),</span>
<span id="cb14-51"><a href="#cb14-51" aria-hidden="true" tabindex="-1"></a>    <span class="at">vjust =</span> <span class="fl">0.5</span></span>
<span id="cb14-52"><a href="#cb14-52" aria-hidden="true" tabindex="-1"></a>  )  <span class="sc">+</span></span>
<span id="cb14-53"><a href="#cb14-53" aria-hidden="true" tabindex="-1"></a>  <span class="fu">geom_textcurve</span>(</span>
<span id="cb14-54"><a href="#cb14-54" aria-hidden="true" tabindex="-1"></a>    <span class="at">data =</span> <span class="fu">data.frame</span>(<span class="at">x =</span> <span class="dv">0</span>, <span class="at">y =</span> <span class="dv">0</span>, <span class="at">yend =</span> <span class="dv">1</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">5</span>), <span class="at">xend =</span> <span class="dv">2</span><span class="sc">/</span><span class="fu">sqrt</span>(<span class="dv">5</span>)), </span>
<span id="cb14-55"><a href="#cb14-55" aria-hidden="true" tabindex="-1"></a>                      <span class="at">mapping =</span> <span class="fu">aes</span>(x, y, <span class="at">xend =</span> xend,  <span class="at">yend =</span> yend), </span>
<span id="cb14-56"><a href="#cb14-56" aria-hidden="true" tabindex="-1"></a>                      <span class="at">label =</span> <span class="st">"S5: PH Bias"</span>, </span>
<span id="cb14-57"><a href="#cb14-57" aria-hidden="true" tabindex="-1"></a>    <span class="at">curvature =</span> <span class="dv">0</span>, <span class="at">hjust =</span> <span class="fl">0.5</span>, <span class="at">arrow =</span> <span class="fu">arrow</span>(),</span>
<span id="cb14-58"><a href="#cb14-58" aria-hidden="true" tabindex="-1"></a>    <span class="at">vjust =</span> <span class="fl">0.5</span></span>
<span id="cb14-59"><a href="#cb14-59" aria-hidden="true" tabindex="-1"></a>  )  </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="fig-genhealth" class="quarto-figure quarto-figure-center anchored">
<figure class="figure">
<p><img src="paper_01b__health_only_files/figure-html/fig-genhealth-1.png" class="img-fluid figure-img" width="672"></p>
<figcaption class="figure-caption">Figure&nbsp;1: Schematic representation of continuous health improvement scenarios modelled</figcaption>
</figure>
</div>
</div>
</div>
<section id="scenario-1-improving-mental-health-only" class="level4">
<h4 class="anchored" data-anchor-id="scenario-1-improving-mental-health-only">Scenario 1: Improving mental health only</h4>
<p><a href="#tbl-mh_scenarios">Table&nbsp;3</a> shows the predicted effects on the number of people in each economic category of increasing each individual’s mental health by a substantial amount, one standard deviation. The baseline model shows the distribution of the population aged 25-64 before health was improved; the counterfactual shows it after health was improved. The results are based on UKHLS participants for whom relevant information was observed in wave j, the last pre-COVID wave in the dataset. <strong>?@tbl-mh_scenarios-1</strong> is based on the model which includes MH as a driver only, whereas <strong>?@tbl-mh_scenarios-2</strong> is based on the model in which PH is also included as a driver, but in this scenario is not modified.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>econ_cat_levels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Employed"</span>, <span class="st">"Unemployed"</span>, <span class="st">"Inactive student"</span>, <span class="st">"Inactive care"</span>, <span class="st">"Inactive long term sick"</span>, <span class="st">"Inactive retired"</span>, <span class="st">"Inactive other"</span>)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-4"><a href="#cb15-4" aria-hidden="true" tabindex="-1"></a>df_baseline <span class="ot">&lt;-</span> ind_data_standardised <span class="sc">|&gt;</span> </span>
<span id="cb15-5"><a href="#cb15-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(wave <span class="sc">==</span> <span class="st">'j'</span>)</span>
<span id="cb15-6"><a href="#cb15-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-7"><a href="#cb15-7" aria-hidden="true" tabindex="-1"></a>df_counterfactual <span class="ot">&lt;-</span> </span>
<span id="cb15-8"><a href="#cb15-8" aria-hidden="true" tabindex="-1"></a>  df_baseline <span class="sc">|&gt;</span> </span>
<span id="cb15-9"><a href="#cb15-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sf12mcs_dv =</span> sf12mcs_dv <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb15-10"><a href="#cb15-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-11"><a href="#cb15-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-12"><a href="#cb15-12" aria-hidden="true" tabindex="-1"></a>preds_df_baseline <span class="ot">&lt;-</span> </span>
<span id="cb15-13"><a href="#cb15-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predict</span>(mod_phmh, <span class="at">newdata =</span> df_baseline, <span class="at">type =</span> <span class="st">"probs"</span>)</span>
<span id="cb15-14"><a href="#cb15-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-15"><a href="#cb15-15" aria-hidden="true" tabindex="-1"></a>preds_df_counterfactual <span class="ot">&lt;-</span> </span>
<span id="cb15-16"><a href="#cb15-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predict</span>(mod_phmh, <span class="at">newdata =</span> df_counterfactual, <span class="at">type =</span> <span class="st">"probs"</span>)</span>
<span id="cb15-17"><a href="#cb15-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-18"><a href="#cb15-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-19"><a href="#cb15-19" aria-hidden="true" tabindex="-1"></a>predictions_summary_matrix <span class="ot">&lt;-</span> <span class="fu">cbind</span>(</span>
<span id="cb15-20"><a href="#cb15-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># The number 2 indicates do the sum function for each column.</span></span>
<span id="cb15-21"><a href="#cb15-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># If it were 1 then this would sum for each row (which should add up to 1 in call cases)</span></span>
<span id="cb15-22"><a href="#cb15-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">apply</span>(preds_df_baseline, <span class="dv">2</span>, <span class="cf">function</span>(x) <span class="fu">round</span>(<span class="fu">sum</span>(x), <span class="dv">0</span>)),</span>
<span id="cb15-23"><a href="#cb15-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">apply</span>(preds_df_counterfactual, <span class="dv">2</span>, <span class="cf">function</span>(x) <span class="fu">round</span>(<span class="fu">sum</span>(x), <span class="dv">0</span>))</span>
<span id="cb15-24"><a href="#cb15-24" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb15-25"><a href="#cb15-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-26"><a href="#cb15-26" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(predictions_summary_matrix) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"base"</span>, <span class="st">"counterfactual"</span>)</span>
<span id="cb15-27"><a href="#cb15-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-28"><a href="#cb15-28" aria-hidden="true" tabindex="-1"></a>tbl_mod_mh <span class="ot">&lt;-</span> </span>
<span id="cb15-29"><a href="#cb15-29" aria-hidden="true" tabindex="-1"></a>  predictions_summary_matrix <span class="sc">|&gt;</span> </span>
<span id="cb15-30"><a href="#cb15-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span> </span>
<span id="cb15-31"><a href="#cb15-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">"State"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb15-32"><a href="#cb15-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb15-33"><a href="#cb15-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">State =</span> <span class="fu">factor</span>(</span>
<span id="cb15-34"><a href="#cb15-34" aria-hidden="true" tabindex="-1"></a>          State, </span>
<span id="cb15-35"><a href="#cb15-35" aria-hidden="true" tabindex="-1"></a>          <span class="at">ordered =</span> <span class="cn">TRUE</span>, </span>
<span id="cb15-36"><a href="#cb15-36" aria-hidden="true" tabindex="-1"></a>          <span class="at">levels =</span> econ_cat_levels</span>
<span id="cb15-37"><a href="#cb15-37" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb15-38"><a href="#cb15-38" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">|&gt;</span> </span>
<span id="cb15-39"><a href="#cb15-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(State) <span class="sc">|&gt;</span> </span>
<span id="cb15-40"><a href="#cb15-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb15-41"><a href="#cb15-41" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Absolute Change</span><span class="st">`</span> <span class="ot">=</span> counterfactual <span class="sc">-</span> base,</span>
<span id="cb15-42"><a href="#cb15-42" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Relative Change</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">Absolute Change</span><span class="st">`</span> <span class="sc">/</span> base</span>
<span id="cb15-43"><a href="#cb15-43" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb15-44"><a href="#cb15-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb15-45"><a href="#cb15-45" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Relative Change</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">ifelse</span>(</span>
<span id="cb15-46"><a href="#cb15-46" aria-hidden="true" tabindex="-1"></a>        <span class="st">`</span><span class="at">Relative Change</span><span class="st">`</span> <span class="sc">&gt;</span> <span class="dv">0</span>, </span>
<span id="cb15-47"><a href="#cb15-47" aria-hidden="true" tabindex="-1"></a>        glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">"{round(100 * `Relative Change`, 1)}% up"</span> ),</span>
<span id="cb15-48"><a href="#cb15-48" aria-hidden="true" tabindex="-1"></a>        glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">"{round(-100 * `Relative Change`, 1)}% down"</span>)</span>
<span id="cb15-49"><a href="#cb15-49" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb15-50"><a href="#cb15-50" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb15-51"><a href="#cb15-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-52"><a href="#cb15-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-53"><a href="#cb15-53" aria-hidden="true" tabindex="-1"></a>tbl_mod_mh <span class="sc">|&gt;</span> knitr<span class="sc">::</span><span class="fu">kable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="tbl-mh_scenarios" class="anchored">
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<caption>Table&nbsp;3: Estimates of substantially improving Mental Health</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">State</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">base</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">counterfactual</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Absolute Change</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Relative Change</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Employed</td>
<td style="text-align: right;">14812</td>
<td style="text-align: right;">15023</td>
<td style="text-align: right;">211</td>
<td style="text-align: left;">1.4% up</td>
</tr>
<tr class="even">
<td style="text-align: left;">Unemployed</td>
<td style="text-align: right;">972</td>
<td style="text-align: right;">854</td>
<td style="text-align: right;">-118</td>
<td style="text-align: left;">12.1% down</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Inactive student</td>
<td style="text-align: right;">1186</td>
<td style="text-align: right;">1193</td>
<td style="text-align: right;">7</td>
<td style="text-align: left;">0.6% up</td>
</tr>
<tr class="even">
<td style="text-align: left;">Inactive care</td>
<td style="text-align: right;">975</td>
<td style="text-align: right;">985</td>
<td style="text-align: right;">10</td>
<td style="text-align: left;">1% up</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Inactive long term sick</td>
<td style="text-align: right;">830</td>
<td style="text-align: right;">699</td>
<td style="text-align: right;">-131</td>
<td style="text-align: left;">15.8% down</td>
</tr>
<tr class="even">
<td style="text-align: left;">Inactive retired</td>
<td style="text-align: right;">1392</td>
<td style="text-align: right;">1424</td>
<td style="text-align: right;">32</td>
<td style="text-align: left;">2.3% up</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Inactive other</td>
<td style="text-align: right;">128</td>
<td style="text-align: right;">116</td>
<td style="text-align: right;">-12</td>
<td style="text-align: left;">9.4% down</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<p>In this scenario, in which mental health was improved but physical health unaffected, unemployment is projected to fall by 12%, and economic inactivity due to long-term sickness by almost 16%. Small relative (but large absolute) increases in Employment are projected too, along with a small increase in early retirement.</p>
</section>
<section id="scenario-2-improving-physical-health-only" class="level4">
<h4 class="anchored" data-anchor-id="scenario-2-improving-physical-health-only">Scenario 2: Improving physical health only</h4>
<p><a href="#tbl-ph_scenario">Table&nbsp;4</a> shows the estimated impact on state sizes of substantially improving PH. As with the MH intervention scenarios, in the counterfactual scenario PH scores were improved by one standardised unit for all valid wave J observations. The model <code>mod_ph_mh</code> was used for this scenario calculation.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb16"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>econ_cat_levels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Employed"</span>, <span class="st">"Unemployed"</span>, <span class="st">"Inactive student"</span>, <span class="st">"Inactive care"</span>, <span class="st">"Inactive long term sick"</span>, <span class="st">"Inactive retired"</span>, <span class="st">"Inactive other"</span>)</span>
<span id="cb16-2"><a href="#cb16-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-3"><a href="#cb16-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-4"><a href="#cb16-4" aria-hidden="true" tabindex="-1"></a>df_baseline <span class="ot">&lt;-</span> ind_data_standardised <span class="sc">|&gt;</span> </span>
<span id="cb16-5"><a href="#cb16-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(wave <span class="sc">==</span> <span class="st">'j'</span>)</span>
<span id="cb16-6"><a href="#cb16-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-7"><a href="#cb16-7" aria-hidden="true" tabindex="-1"></a>df_counterfactual <span class="ot">&lt;-</span> </span>
<span id="cb16-8"><a href="#cb16-8" aria-hidden="true" tabindex="-1"></a>  df_baseline <span class="sc">|&gt;</span> </span>
<span id="cb16-9"><a href="#cb16-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sf12pcs_dv =</span> sf12pcs_dv <span class="sc">+</span> <span class="dv">1</span>)</span>
<span id="cb16-10"><a href="#cb16-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-11"><a href="#cb16-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-12"><a href="#cb16-12" aria-hidden="true" tabindex="-1"></a>preds_df_baseline <span class="ot">&lt;-</span> </span>
<span id="cb16-13"><a href="#cb16-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predict</span>(mod_phmh, <span class="at">newdata =</span> df_baseline, <span class="at">type =</span> <span class="st">"probs"</span>)</span>
<span id="cb16-14"><a href="#cb16-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-15"><a href="#cb16-15" aria-hidden="true" tabindex="-1"></a>preds_df_counterfactual <span class="ot">&lt;-</span> </span>
<span id="cb16-16"><a href="#cb16-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predict</span>(mod_phmh, <span class="at">newdata =</span> df_counterfactual, <span class="at">type =</span> <span class="st">"probs"</span>)</span>
<span id="cb16-17"><a href="#cb16-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-18"><a href="#cb16-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-19"><a href="#cb16-19" aria-hidden="true" tabindex="-1"></a>predictions_summary_matrix <span class="ot">&lt;-</span> <span class="fu">cbind</span>(</span>
<span id="cb16-20"><a href="#cb16-20" aria-hidden="true" tabindex="-1"></a>  <span class="co"># The number 2 indicates do the sum function for each column.</span></span>
<span id="cb16-21"><a href="#cb16-21" aria-hidden="true" tabindex="-1"></a>  <span class="co"># If it were 1 then this would sum for each row (which should add up to 1 in call cases)</span></span>
<span id="cb16-22"><a href="#cb16-22" aria-hidden="true" tabindex="-1"></a>  <span class="fu">apply</span>(preds_df_baseline, <span class="dv">2</span>, <span class="cf">function</span>(x) <span class="fu">round</span>(<span class="fu">sum</span>(x), <span class="dv">0</span>)),</span>
<span id="cb16-23"><a href="#cb16-23" aria-hidden="true" tabindex="-1"></a>  <span class="fu">apply</span>(preds_df_counterfactual, <span class="dv">2</span>, <span class="cf">function</span>(x) <span class="fu">round</span>(<span class="fu">sum</span>(x), <span class="dv">0</span>))</span>
<span id="cb16-24"><a href="#cb16-24" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb16-25"><a href="#cb16-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-26"><a href="#cb16-26" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(predictions_summary_matrix) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"base"</span>, <span class="st">"counterfactual"</span>)</span>
<span id="cb16-27"><a href="#cb16-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-28"><a href="#cb16-28" aria-hidden="true" tabindex="-1"></a>tbl_mod_ph <span class="ot">&lt;-</span> </span>
<span id="cb16-29"><a href="#cb16-29" aria-hidden="true" tabindex="-1"></a>  predictions_summary_matrix <span class="sc">|&gt;</span> </span>
<span id="cb16-30"><a href="#cb16-30" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span> </span>
<span id="cb16-31"><a href="#cb16-31" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">"State"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb16-32"><a href="#cb16-32" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb16-33"><a href="#cb16-33" aria-hidden="true" tabindex="-1"></a>        <span class="at">State =</span> <span class="fu">factor</span>(</span>
<span id="cb16-34"><a href="#cb16-34" aria-hidden="true" tabindex="-1"></a>          State, </span>
<span id="cb16-35"><a href="#cb16-35" aria-hidden="true" tabindex="-1"></a>          <span class="at">ordered =</span> <span class="cn">TRUE</span>, </span>
<span id="cb16-36"><a href="#cb16-36" aria-hidden="true" tabindex="-1"></a>          <span class="at">levels =</span> econ_cat_levels</span>
<span id="cb16-37"><a href="#cb16-37" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb16-38"><a href="#cb16-38" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">|&gt;</span> </span>
<span id="cb16-39"><a href="#cb16-39" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(State) <span class="sc">|&gt;</span> </span>
<span id="cb16-40"><a href="#cb16-40" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb16-41"><a href="#cb16-41" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Absolute Change</span><span class="st">`</span> <span class="ot">=</span> counterfactual <span class="sc">-</span> base,</span>
<span id="cb16-42"><a href="#cb16-42" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Relative Change</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">Absolute Change</span><span class="st">`</span> <span class="sc">/</span> base</span>
<span id="cb16-43"><a href="#cb16-43" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb16-44"><a href="#cb16-44" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb16-45"><a href="#cb16-45" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Relative Change</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">ifelse</span>(</span>
<span id="cb16-46"><a href="#cb16-46" aria-hidden="true" tabindex="-1"></a>        <span class="st">`</span><span class="at">Relative Change</span><span class="st">`</span> <span class="sc">&gt;</span> <span class="dv">0</span>, </span>
<span id="cb16-47"><a href="#cb16-47" aria-hidden="true" tabindex="-1"></a>        glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">"{round(100 * `Relative Change`, 1)}% up"</span> ),</span>
<span id="cb16-48"><a href="#cb16-48" aria-hidden="true" tabindex="-1"></a>        glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">"{round(-100 * `Relative Change`, 1)}% down"</span>)</span>
<span id="cb16-49"><a href="#cb16-49" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb16-50"><a href="#cb16-50" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb16-51"><a href="#cb16-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-52"><a href="#cb16-52" aria-hidden="true" tabindex="-1"></a>tbl_mod_ph <span class="sc">|&gt;</span> knitr<span class="sc">::</span><span class="fu">kable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="tbl-ph_scenario" class="anchored">
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<caption>Table&nbsp;4: Estimates of substantially improving Physical Health</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">State</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">base</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">counterfactual</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Absolute Change</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Relative Change</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Employed</td>
<td style="text-align: right;">14812</td>
<td style="text-align: right;">15175</td>
<td style="text-align: right;">363</td>
<td style="text-align: left;">2.5% up</td>
</tr>
<tr class="even">
<td style="text-align: left;">Unemployed</td>
<td style="text-align: right;">972</td>
<td style="text-align: right;">823</td>
<td style="text-align: right;">-149</td>
<td style="text-align: left;">15.3% down</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Inactive student</td>
<td style="text-align: right;">1186</td>
<td style="text-align: right;">1243</td>
<td style="text-align: right;">57</td>
<td style="text-align: left;">4.8% up</td>
</tr>
<tr class="even">
<td style="text-align: left;">Inactive care</td>
<td style="text-align: right;">975</td>
<td style="text-align: right;">933</td>
<td style="text-align: right;">-42</td>
<td style="text-align: left;">4.3% down</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Inactive long term sick</td>
<td style="text-align: right;">830</td>
<td style="text-align: right;">613</td>
<td style="text-align: right;">-217</td>
<td style="text-align: left;">26.1% down</td>
</tr>
<tr class="even">
<td style="text-align: left;">Inactive retired</td>
<td style="text-align: right;">1392</td>
<td style="text-align: right;">1384</td>
<td style="text-align: right;">-8</td>
<td style="text-align: left;">0.6% down</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Inactive other</td>
<td style="text-align: right;">128</td>
<td style="text-align: right;">123</td>
<td style="text-align: right;">-5</td>
<td style="text-align: left;">3.9% down</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<p>In this scenario, economic inactivity due to long-term sickess is projected to fall by 26%, and unemployment by 15%. A 2.5% increase in employment - due largely to transfers from unemployment and long-term sickness - is also project. Unlike</p>
<p>Comparing <a href="#tbl-ph_scenario">Table&nbsp;4</a> with <a href="#tbl-mh_scenarios">Table&nbsp;3</a> we can see that a hypothetical intervention purely on physical health is therefore likely to lead to a larger effect on those economic categories of most interest than an equivalently sized intervention on mental health only.</p>
</section>
<section id="scenario-3-improving-mental-and-physical-health-by-equal-amounts" class="level4">
<h4 class="anchored" data-anchor-id="scenario-3-improving-mental-and-physical-health-by-equal-amounts">Scenario 3: Improving mental and physical health by equal amounts</h4>
<p>The results of running this scenario are shown in <a href="#tbl-genhealth">Table&nbsp;5</a></p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>econ_cat_levels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Employed"</span>, <span class="st">"Unemployed"</span>, <span class="st">"Inactive student"</span>, <span class="st">"Inactive care"</span>, <span class="st">"Inactive long term sick"</span>, <span class="st">"Inactive retired"</span>, <span class="st">"Inactive other"</span>)</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-4"><a href="#cb17-4" aria-hidden="true" tabindex="-1"></a>df_baseline <span class="ot">&lt;-</span> ind_data_standardised <span class="sc">|&gt;</span> </span>
<span id="cb17-5"><a href="#cb17-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(wave <span class="sc">==</span> <span class="st">'j'</span>)</span>
<span id="cb17-6"><a href="#cb17-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-7"><a href="#cb17-7" aria-hidden="true" tabindex="-1"></a>df_counterfactual <span class="ot">&lt;-</span> </span>
<span id="cb17-8"><a href="#cb17-8" aria-hidden="true" tabindex="-1"></a>  df_baseline <span class="sc">|&gt;</span> </span>
<span id="cb17-9"><a href="#cb17-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb17-10"><a href="#cb17-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">sf12mcs_dv =</span> sf12mcs_dv <span class="sc">+</span> <span class="dv">1</span> <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">2</span>),</span>
<span id="cb17-11"><a href="#cb17-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">sf12pcs_dv =</span> sf12pcs_dv <span class="sc">+</span> <span class="dv">1</span> <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">2</span>)</span>
<span id="cb17-12"><a href="#cb17-12" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb17-13"><a href="#cb17-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-14"><a href="#cb17-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-15"><a href="#cb17-15" aria-hidden="true" tabindex="-1"></a>preds_df_baseline <span class="ot">&lt;-</span> </span>
<span id="cb17-16"><a href="#cb17-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predict</span>(mod_phmh, <span class="at">newdata =</span> df_baseline, <span class="at">type =</span> <span class="st">"probs"</span>)</span>
<span id="cb17-17"><a href="#cb17-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-18"><a href="#cb17-18" aria-hidden="true" tabindex="-1"></a>preds_df_counterfactual <span class="ot">&lt;-</span> </span>
<span id="cb17-19"><a href="#cb17-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predict</span>(mod_phmh, <span class="at">newdata =</span> df_counterfactual, <span class="at">type =</span> <span class="st">"probs"</span>)</span>
<span id="cb17-20"><a href="#cb17-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-21"><a href="#cb17-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-22"><a href="#cb17-22" aria-hidden="true" tabindex="-1"></a>predictions_summary_matrix <span class="ot">&lt;-</span> <span class="fu">cbind</span>(</span>
<span id="cb17-23"><a href="#cb17-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># The number 2 indicates do the sum function for each column.</span></span>
<span id="cb17-24"><a href="#cb17-24" aria-hidden="true" tabindex="-1"></a>  <span class="co"># If it were 1 then this would sum for each row (which should add up to 1 in call cases)</span></span>
<span id="cb17-25"><a href="#cb17-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">apply</span>(preds_df_baseline, <span class="dv">2</span>, <span class="cf">function</span>(x) <span class="fu">round</span>(<span class="fu">sum</span>(x), <span class="dv">0</span>)),</span>
<span id="cb17-26"><a href="#cb17-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">apply</span>(preds_df_counterfactual, <span class="dv">2</span>, <span class="cf">function</span>(x) <span class="fu">round</span>(<span class="fu">sum</span>(x), <span class="dv">0</span>))</span>
<span id="cb17-27"><a href="#cb17-27" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb17-28"><a href="#cb17-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-29"><a href="#cb17-29" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(predictions_summary_matrix) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"base"</span>, <span class="st">"counterfactual"</span>)</span>
<span id="cb17-30"><a href="#cb17-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-31"><a href="#cb17-31" aria-hidden="true" tabindex="-1"></a>tbl_mod_both <span class="ot">&lt;-</span> </span>
<span id="cb17-32"><a href="#cb17-32" aria-hidden="true" tabindex="-1"></a>  predictions_summary_matrix <span class="sc">|&gt;</span> </span>
<span id="cb17-33"><a href="#cb17-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span> </span>
<span id="cb17-34"><a href="#cb17-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">"State"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb17-35"><a href="#cb17-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb17-36"><a href="#cb17-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">State =</span> <span class="fu">factor</span>(</span>
<span id="cb17-37"><a href="#cb17-37" aria-hidden="true" tabindex="-1"></a>          State, </span>
<span id="cb17-38"><a href="#cb17-38" aria-hidden="true" tabindex="-1"></a>          <span class="at">ordered =</span> <span class="cn">TRUE</span>, </span>
<span id="cb17-39"><a href="#cb17-39" aria-hidden="true" tabindex="-1"></a>          <span class="at">levels =</span> econ_cat_levels</span>
<span id="cb17-40"><a href="#cb17-40" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb17-41"><a href="#cb17-41" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">|&gt;</span> </span>
<span id="cb17-42"><a href="#cb17-42" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(State) <span class="sc">|&gt;</span> </span>
<span id="cb17-43"><a href="#cb17-43" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb17-44"><a href="#cb17-44" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Absolute Change</span><span class="st">`</span> <span class="ot">=</span> counterfactual <span class="sc">-</span> base,</span>
<span id="cb17-45"><a href="#cb17-45" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Relative Change</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">Absolute Change</span><span class="st">`</span> <span class="sc">/</span> base</span>
<span id="cb17-46"><a href="#cb17-46" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb17-47"><a href="#cb17-47" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb17-48"><a href="#cb17-48" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Relative Change</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">ifelse</span>(</span>
<span id="cb17-49"><a href="#cb17-49" aria-hidden="true" tabindex="-1"></a>        <span class="st">`</span><span class="at">Relative Change</span><span class="st">`</span> <span class="sc">&gt;</span> <span class="dv">0</span>, </span>
<span id="cb17-50"><a href="#cb17-50" aria-hidden="true" tabindex="-1"></a>        glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">"{round(100 * `Relative Change`, 1)}% up"</span> ),</span>
<span id="cb17-51"><a href="#cb17-51" aria-hidden="true" tabindex="-1"></a>        glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">"{round(-100 * `Relative Change`, 1)}% down"</span>)</span>
<span id="cb17-52"><a href="#cb17-52" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb17-53"><a href="#cb17-53" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb17-54"><a href="#cb17-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-55"><a href="#cb17-55" aria-hidden="true" tabindex="-1"></a>kbl_health <span class="ot">&lt;-</span> tbl_mod_both <span class="sc">|&gt;</span> knitr<span class="sc">::</span><span class="fu">kable</span>()</span>
<span id="cb17-56"><a href="#cb17-56" aria-hidden="true" tabindex="-1"></a><span class="co"># save_kable(kbl_health, file = here::here("presentations/health_table.html"))</span></span>
<span id="cb17-57"><a href="#cb17-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-58"><a href="#cb17-58" aria-hidden="true" tabindex="-1"></a>kbl_health</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="tbl-genhealth" class="anchored">
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<caption>Table&nbsp;5: Estimates of substantially improving health via equal improvements in mental health and physical health</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">State</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">base</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">counterfactual</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Absolute Change</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Relative Change</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Employed</td>
<td style="text-align: right;">14812</td>
<td style="text-align: right;">15186</td>
<td style="text-align: right;">374</td>
<td style="text-align: left;">2.5% up</td>
</tr>
<tr class="even">
<td style="text-align: left;">Unemployed</td>
<td style="text-align: right;">972</td>
<td style="text-align: right;">792</td>
<td style="text-align: right;">-180</td>
<td style="text-align: left;">18.5% down</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Inactive student</td>
<td style="text-align: right;">1186</td>
<td style="text-align: right;">1241</td>
<td style="text-align: right;">55</td>
<td style="text-align: left;">4.6% up</td>
</tr>
<tr class="even">
<td style="text-align: left;">Inactive care</td>
<td style="text-align: right;">975</td>
<td style="text-align: right;">955</td>
<td style="text-align: right;">-20</td>
<td style="text-align: left;">2.1% down</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Inactive long term sick</td>
<td style="text-align: right;">830</td>
<td style="text-align: right;">582</td>
<td style="text-align: right;">-248</td>
<td style="text-align: left;">29.9% down</td>
</tr>
<tr class="even">
<td style="text-align: left;">Inactive retired</td>
<td style="text-align: right;">1392</td>
<td style="text-align: right;">1422</td>
<td style="text-align: right;">30</td>
<td style="text-align: left;">2.2% up</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Inactive other</td>
<td style="text-align: right;">128</td>
<td style="text-align: right;">115</td>
<td style="text-align: right;">-13</td>
<td style="text-align: left;">10.2% down</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<p><a href="#tbl-genhealth">Table&nbsp;5</a> suggests that, if mental and physical health were intervened on equally effectively, then a near 30% fall in inactivity due to long-term sickness is projected to result, as well as an 18.5% fall in unemployment. As with <strong>?@tbl-ph-scenario</strong> and <strong>?@tbl-mh-scenario</strong>, the majority of the reduction in these categories is projected to translate into increased in the number of people in employment. Inactivity due to full time study and early retirement are also project to increase, but by more modest amounts.</p>
<p>Comparing <a href="#tbl-genhealth">Table&nbsp;5</a> with <a href="#tbl-ph_scenario">Table&nbsp;4</a>, which had the larger of the two single component intervention scenarios on economic inactivity due to long-term sickness, we can see that, at 30%, the projected effect of intervening on both mental and physical health equally is slightly larger than the 26% relative change projected in the physical health only scenario.</p>
</section>
<section id="scenario-4-both-mh-and-ph-improved-but-mh-changed-more" class="level4">
<h4 class="anchored" data-anchor-id="scenario-4-both-mh-and-ph-improved-but-mh-changed-more">Scenario 4: Both MH and PH improved, but MH changed more</h4>
<p>In this scenario, both MH and PHS are affected, but the size of the change in MH is modelled to be twice as large as the effect on PH. The results are shown in <a href="#tbl-genhealth_mhbias">Table&nbsp;6</a></p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb18"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>econ_cat_levels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Employed"</span>, <span class="st">"Unemployed"</span>, <span class="st">"Inactive student"</span>, <span class="st">"Inactive care"</span>, <span class="st">"Inactive long term sick"</span>, <span class="st">"Inactive retired"</span>, <span class="st">"Inactive other"</span>)</span>
<span id="cb18-2"><a href="#cb18-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-3"><a href="#cb18-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-4"><a href="#cb18-4" aria-hidden="true" tabindex="-1"></a>df_baseline <span class="ot">&lt;-</span> ind_data_standardised <span class="sc">|&gt;</span> </span>
<span id="cb18-5"><a href="#cb18-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(wave <span class="sc">==</span> <span class="st">'j'</span>)</span>
<span id="cb18-6"><a href="#cb18-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-7"><a href="#cb18-7" aria-hidden="true" tabindex="-1"></a>df_counterfactual <span class="ot">&lt;-</span> </span>
<span id="cb18-8"><a href="#cb18-8" aria-hidden="true" tabindex="-1"></a>  df_baseline <span class="sc">|&gt;</span> </span>
<span id="cb18-9"><a href="#cb18-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb18-10"><a href="#cb18-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">sf12mcs_dv =</span> sf12mcs_dv <span class="sc">+</span> <span class="dv">2</span> <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">5</span>),</span>
<span id="cb18-11"><a href="#cb18-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">sf12pcs_dv =</span> sf12pcs_dv <span class="sc">+</span> <span class="dv">1</span> <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">5</span>)</span>
<span id="cb18-12"><a href="#cb18-12" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb18-13"><a href="#cb18-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-14"><a href="#cb18-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-15"><a href="#cb18-15" aria-hidden="true" tabindex="-1"></a>preds_df_baseline <span class="ot">&lt;-</span> </span>
<span id="cb18-16"><a href="#cb18-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predict</span>(mod_phmh, <span class="at">newdata =</span> df_baseline, <span class="at">type =</span> <span class="st">"probs"</span>)</span>
<span id="cb18-17"><a href="#cb18-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-18"><a href="#cb18-18" aria-hidden="true" tabindex="-1"></a>preds_df_counterfactual <span class="ot">&lt;-</span> </span>
<span id="cb18-19"><a href="#cb18-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predict</span>(mod_phmh, <span class="at">newdata =</span> df_counterfactual, <span class="at">type =</span> <span class="st">"probs"</span>)</span>
<span id="cb18-20"><a href="#cb18-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-21"><a href="#cb18-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-22"><a href="#cb18-22" aria-hidden="true" tabindex="-1"></a>predictions_summary_matrix <span class="ot">&lt;-</span> <span class="fu">cbind</span>(</span>
<span id="cb18-23"><a href="#cb18-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># The number 2 indicates do the sum function for each column.</span></span>
<span id="cb18-24"><a href="#cb18-24" aria-hidden="true" tabindex="-1"></a>  <span class="co"># If it were 1 then this would sum for each row (which should add up to 1 in call cases)</span></span>
<span id="cb18-25"><a href="#cb18-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">apply</span>(preds_df_baseline, <span class="dv">2</span>, <span class="cf">function</span>(x) <span class="fu">round</span>(<span class="fu">sum</span>(x), <span class="dv">0</span>)),</span>
<span id="cb18-26"><a href="#cb18-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">apply</span>(preds_df_counterfactual, <span class="dv">2</span>, <span class="cf">function</span>(x) <span class="fu">round</span>(<span class="fu">sum</span>(x), <span class="dv">0</span>))</span>
<span id="cb18-27"><a href="#cb18-27" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb18-28"><a href="#cb18-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-29"><a href="#cb18-29" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(predictions_summary_matrix) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"base"</span>, <span class="st">"counterfactual"</span>)</span>
<span id="cb18-30"><a href="#cb18-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-31"><a href="#cb18-31" aria-hidden="true" tabindex="-1"></a>tbl_mod_both <span class="ot">&lt;-</span> </span>
<span id="cb18-32"><a href="#cb18-32" aria-hidden="true" tabindex="-1"></a>  predictions_summary_matrix <span class="sc">|&gt;</span> </span>
<span id="cb18-33"><a href="#cb18-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span> </span>
<span id="cb18-34"><a href="#cb18-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">"State"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb18-35"><a href="#cb18-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb18-36"><a href="#cb18-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">State =</span> <span class="fu">factor</span>(</span>
<span id="cb18-37"><a href="#cb18-37" aria-hidden="true" tabindex="-1"></a>          State, </span>
<span id="cb18-38"><a href="#cb18-38" aria-hidden="true" tabindex="-1"></a>          <span class="at">ordered =</span> <span class="cn">TRUE</span>, </span>
<span id="cb18-39"><a href="#cb18-39" aria-hidden="true" tabindex="-1"></a>          <span class="at">levels =</span> econ_cat_levels</span>
<span id="cb18-40"><a href="#cb18-40" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb18-41"><a href="#cb18-41" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">|&gt;</span> </span>
<span id="cb18-42"><a href="#cb18-42" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(State) <span class="sc">|&gt;</span> </span>
<span id="cb18-43"><a href="#cb18-43" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb18-44"><a href="#cb18-44" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Absolute Change</span><span class="st">`</span> <span class="ot">=</span> counterfactual <span class="sc">-</span> base,</span>
<span id="cb18-45"><a href="#cb18-45" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Relative Change</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">Absolute Change</span><span class="st">`</span> <span class="sc">/</span> base</span>
<span id="cb18-46"><a href="#cb18-46" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb18-47"><a href="#cb18-47" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb18-48"><a href="#cb18-48" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Relative Change</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">ifelse</span>(</span>
<span id="cb18-49"><a href="#cb18-49" aria-hidden="true" tabindex="-1"></a>        <span class="st">`</span><span class="at">Relative Change</span><span class="st">`</span> <span class="sc">&gt;</span> <span class="dv">0</span>, </span>
<span id="cb18-50"><a href="#cb18-50" aria-hidden="true" tabindex="-1"></a>        glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">"{round(100 * `Relative Change`, 1)}% up"</span> ),</span>
<span id="cb18-51"><a href="#cb18-51" aria-hidden="true" tabindex="-1"></a>        glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">"{round(-100 * `Relative Change`, 1)}% down"</span>)</span>
<span id="cb18-52"><a href="#cb18-52" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb18-53"><a href="#cb18-53" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb18-54"><a href="#cb18-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-55"><a href="#cb18-55" aria-hidden="true" tabindex="-1"></a>kbl_health_mhbias <span class="ot">&lt;-</span> tbl_mod_both <span class="sc">|&gt;</span> knitr<span class="sc">::</span><span class="fu">kable</span>()</span>
<span id="cb18-56"><a href="#cb18-56" aria-hidden="true" tabindex="-1"></a><span class="co"># save_kable(kbl_health, file = here::here("presentations/health_table.html"))</span></span>
<span id="cb18-57"><a href="#cb18-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb18-58"><a href="#cb18-58" aria-hidden="true" tabindex="-1"></a>kbl_health_mhbias</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="tbl-genhealth_mhbias" class="anchored">
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<caption>Table&nbsp;6: Estimates of substantially improving health via disproprtionate improvement in mental health</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">State</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">base</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">counterfactual</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Absolute Change</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Relative Change</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Employed</td>
<td style="text-align: right;">14812</td>
<td style="text-align: right;">15139</td>
<td style="text-align: right;">327</td>
<td style="text-align: left;">2.2% up</td>
</tr>
<tr class="even">
<td style="text-align: left;">Unemployed</td>
<td style="text-align: right;">972</td>
<td style="text-align: right;">807</td>
<td style="text-align: right;">-165</td>
<td style="text-align: left;">17% down</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Inactive student</td>
<td style="text-align: right;">1186</td>
<td style="text-align: right;">1226</td>
<td style="text-align: right;">40</td>
<td style="text-align: left;">3.4% up</td>
</tr>
<tr class="even">
<td style="text-align: left;">Inactive care</td>
<td style="text-align: right;">975</td>
<td style="text-align: right;">967</td>
<td style="text-align: right;">-8</td>
<td style="text-align: left;">0.8% down</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Inactive long term sick</td>
<td style="text-align: right;">830</td>
<td style="text-align: right;">613</td>
<td style="text-align: right;">-217</td>
<td style="text-align: left;">26.1% down</td>
</tr>
<tr class="even">
<td style="text-align: left;">Inactive retired</td>
<td style="text-align: right;">1392</td>
<td style="text-align: right;">1428</td>
<td style="text-align: right;">36</td>
<td style="text-align: left;">2.6% up</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Inactive other</td>
<td style="text-align: right;">128</td>
<td style="text-align: right;">114</td>
<td style="text-align: right;">-14</td>
<td style="text-align: left;">10.9% down</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<p><a href="#tbl-genhealth_mhbias">Table&nbsp;6</a> projects a fall in economic inactivity due to long-term sickness of around 26%, which is similar to the effect of scenario 2, as shown in <a href="#tbl-ph_scenario">Table&nbsp;4</a>.</p>
</section>
<section id="scenario-5-health-improved-but-ph-improved-more" class="level4">
<h4 class="anchored" data-anchor-id="scenario-5-health-improved-but-ph-improved-more">Scenario 5: Health improved, but PH improved more</h4>
<p>In this scenario, both MH and PH are changed, but the change in PH modelled to be twice as large as for MH. The projections are shown in <a href="#tbl-genhealth_phbias">Table&nbsp;7</a>.</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>econ_cat_levels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Employed"</span>, <span class="st">"Unemployed"</span>, <span class="st">"Inactive student"</span>, <span class="st">"Inactive care"</span>, <span class="st">"Inactive long term sick"</span>, <span class="st">"Inactive retired"</span>, <span class="st">"Inactive other"</span>)</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-4"><a href="#cb19-4" aria-hidden="true" tabindex="-1"></a>df_baseline <span class="ot">&lt;-</span> ind_data_standardised <span class="sc">|&gt;</span> </span>
<span id="cb19-5"><a href="#cb19-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(wave <span class="sc">==</span> <span class="st">'j'</span>)</span>
<span id="cb19-6"><a href="#cb19-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-7"><a href="#cb19-7" aria-hidden="true" tabindex="-1"></a>df_counterfactual <span class="ot">&lt;-</span> </span>
<span id="cb19-8"><a href="#cb19-8" aria-hidden="true" tabindex="-1"></a>  df_baseline <span class="sc">|&gt;</span> </span>
<span id="cb19-9"><a href="#cb19-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb19-10"><a href="#cb19-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">sf12mcs_dv =</span> sf12mcs_dv <span class="sc">+</span> <span class="dv">1</span> <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">5</span>),</span>
<span id="cb19-11"><a href="#cb19-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">sf12pcs_dv =</span> sf12pcs_dv <span class="sc">+</span> <span class="dv">2</span> <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">5</span>)</span>
<span id="cb19-12"><a href="#cb19-12" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb19-13"><a href="#cb19-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-14"><a href="#cb19-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-15"><a href="#cb19-15" aria-hidden="true" tabindex="-1"></a>preds_df_baseline <span class="ot">&lt;-</span> </span>
<span id="cb19-16"><a href="#cb19-16" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predict</span>(mod_phmh, <span class="at">newdata =</span> df_baseline, <span class="at">type =</span> <span class="st">"probs"</span>)</span>
<span id="cb19-17"><a href="#cb19-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-18"><a href="#cb19-18" aria-hidden="true" tabindex="-1"></a>preds_df_counterfactual <span class="ot">&lt;-</span> </span>
<span id="cb19-19"><a href="#cb19-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predict</span>(mod_phmh, <span class="at">newdata =</span> df_counterfactual, <span class="at">type =</span> <span class="st">"probs"</span>)</span>
<span id="cb19-20"><a href="#cb19-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-21"><a href="#cb19-21" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-22"><a href="#cb19-22" aria-hidden="true" tabindex="-1"></a>predictions_summary_matrix <span class="ot">&lt;-</span> <span class="fu">cbind</span>(</span>
<span id="cb19-23"><a href="#cb19-23" aria-hidden="true" tabindex="-1"></a>  <span class="co"># The number 2 indicates do the sum function for each column.</span></span>
<span id="cb19-24"><a href="#cb19-24" aria-hidden="true" tabindex="-1"></a>  <span class="co"># If it were 1 then this would sum for each row (which should add up to 1 in call cases)</span></span>
<span id="cb19-25"><a href="#cb19-25" aria-hidden="true" tabindex="-1"></a>  <span class="fu">apply</span>(preds_df_baseline, <span class="dv">2</span>, <span class="cf">function</span>(x) <span class="fu">round</span>(<span class="fu">sum</span>(x), <span class="dv">0</span>)),</span>
<span id="cb19-26"><a href="#cb19-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">apply</span>(preds_df_counterfactual, <span class="dv">2</span>, <span class="cf">function</span>(x) <span class="fu">round</span>(<span class="fu">sum</span>(x), <span class="dv">0</span>))</span>
<span id="cb19-27"><a href="#cb19-27" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb19-28"><a href="#cb19-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-29"><a href="#cb19-29" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(predictions_summary_matrix) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"base"</span>, <span class="st">"counterfactual"</span>)</span>
<span id="cb19-30"><a href="#cb19-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-31"><a href="#cb19-31" aria-hidden="true" tabindex="-1"></a>tbl_mod_both <span class="ot">&lt;-</span> </span>
<span id="cb19-32"><a href="#cb19-32" aria-hidden="true" tabindex="-1"></a>  predictions_summary_matrix <span class="sc">|&gt;</span> </span>
<span id="cb19-33"><a href="#cb19-33" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span> </span>
<span id="cb19-34"><a href="#cb19-34" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">"State"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb19-35"><a href="#cb19-35" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb19-36"><a href="#cb19-36" aria-hidden="true" tabindex="-1"></a>        <span class="at">State =</span> <span class="fu">factor</span>(</span>
<span id="cb19-37"><a href="#cb19-37" aria-hidden="true" tabindex="-1"></a>          State, </span>
<span id="cb19-38"><a href="#cb19-38" aria-hidden="true" tabindex="-1"></a>          <span class="at">ordered =</span> <span class="cn">TRUE</span>, </span>
<span id="cb19-39"><a href="#cb19-39" aria-hidden="true" tabindex="-1"></a>          <span class="at">levels =</span> econ_cat_levels</span>
<span id="cb19-40"><a href="#cb19-40" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb19-41"><a href="#cb19-41" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">|&gt;</span> </span>
<span id="cb19-42"><a href="#cb19-42" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(State) <span class="sc">|&gt;</span> </span>
<span id="cb19-43"><a href="#cb19-43" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb19-44"><a href="#cb19-44" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Absolute Change</span><span class="st">`</span> <span class="ot">=</span> counterfactual <span class="sc">-</span> base,</span>
<span id="cb19-45"><a href="#cb19-45" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Relative Change</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">Absolute Change</span><span class="st">`</span> <span class="sc">/</span> base</span>
<span id="cb19-46"><a href="#cb19-46" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb19-47"><a href="#cb19-47" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb19-48"><a href="#cb19-48" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Relative Change</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">ifelse</span>(</span>
<span id="cb19-49"><a href="#cb19-49" aria-hidden="true" tabindex="-1"></a>        <span class="st">`</span><span class="at">Relative Change</span><span class="st">`</span> <span class="sc">&gt;</span> <span class="dv">0</span>, </span>
<span id="cb19-50"><a href="#cb19-50" aria-hidden="true" tabindex="-1"></a>        glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">"{round(100 * `Relative Change`, 1)}% up"</span> ),</span>
<span id="cb19-51"><a href="#cb19-51" aria-hidden="true" tabindex="-1"></a>        glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">"{round(-100 * `Relative Change`, 1)}% down"</span>)</span>
<span id="cb19-52"><a href="#cb19-52" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb19-53"><a href="#cb19-53" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb19-54"><a href="#cb19-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-55"><a href="#cb19-55" aria-hidden="true" tabindex="-1"></a>kbl_health_phbias <span class="ot">&lt;-</span> tbl_mod_both <span class="sc">|&gt;</span> knitr<span class="sc">::</span><span class="fu">kable</span>()</span>
<span id="cb19-56"><a href="#cb19-56" aria-hidden="true" tabindex="-1"></a><span class="co"># save_kable(kbl_health, file = here::here("presentations/health_table.html"))</span></span>
<span id="cb19-57"><a href="#cb19-57" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb19-58"><a href="#cb19-58" aria-hidden="true" tabindex="-1"></a>kbl_health_phbias</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="tbl-genhealth_phbias" class="anchored">
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<caption>Table&nbsp;7: Estimates of substantially improving health via disproprtionate improvement in physical health</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">State</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">base</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">counterfactual</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Absolute Change</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Relative Change</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Employed</td>
<td style="text-align: right;">14812</td>
<td style="text-align: right;">15205</td>
<td style="text-align: right;">393</td>
<td style="text-align: left;">2.7% up</td>
</tr>
<tr class="even">
<td style="text-align: left;">Unemployed</td>
<td style="text-align: right;">972</td>
<td style="text-align: right;">794</td>
<td style="text-align: right;">-178</td>
<td style="text-align: left;">18.3% down</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Inactive student</td>
<td style="text-align: right;">1186</td>
<td style="text-align: right;">1248</td>
<td style="text-align: right;">62</td>
<td style="text-align: left;">5.2% up</td>
</tr>
<tr class="even">
<td style="text-align: left;">Inactive care</td>
<td style="text-align: right;">975</td>
<td style="text-align: right;">944</td>
<td style="text-align: right;">-31</td>
<td style="text-align: left;">3.2% down</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Inactive long term sick</td>
<td style="text-align: right;">830</td>
<td style="text-align: right;">577</td>
<td style="text-align: right;">-253</td>
<td style="text-align: left;">30.5% down</td>
</tr>
<tr class="even">
<td style="text-align: left;">Inactive retired</td>
<td style="text-align: right;">1392</td>
<td style="text-align: right;">1410</td>
<td style="text-align: right;">18</td>
<td style="text-align: left;">1.3% up</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Inactive other</td>
<td style="text-align: right;">128</td>
<td style="text-align: right;">117</td>
<td style="text-align: right;">-11</td>
<td style="text-align: left;">8.6% down</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<p><a href="#tbl-genhealth_phbias">Table&nbsp;7</a> shows that, in this scenario, a 30.5% reduction in inactivity due to long-term sickness is projected to result. This is slightly larger than the previous maximum relative reduction in this category, of 29.9%, but not appreciably so.</p>
</section>
</section>
</section>
<section id="part-two-effects-of-discrete-and-continuous-changes-to-health-in-distinct-subpopulations" class="level2">
<h2 class="anchored" data-anchor-id="part-two-effects-of-discrete-and-continuous-changes-to-health-in-distinct-subpopulations">Part two: Effects of discrete and continuous changes to health in distinct subpopulations</h2>
<p>In part one of this paper, we looked at a range of scenarios in which deleterious health was ‘switched off’ or ‘mitigated’. When looking at health as a continuous quantity, based on SF-12 MH and PH components, we found that improving both PH and MH, but improving PH more so, led to the largest estimated reductions in the size of economic inactivity due to long-term sickness and unemployment.</p>
<p>In part two of this paper, we explore whether these estimates which apply to the general population are similar in distinct subpopulations. Our subpopulations of interest are:</p>
<ol type="1">
<li>Males and females</li>
<li>Older and younger working age populations</li>
<li>Household types, focusing on households with children, and within this single parent households</li>
</ol>
<p>If there are substantive differences between the estimated effects of poor health in these subpopulations, then it suggests additional influencers and drivers may need to be considered, and also that the effects of improving health on improving labour market outcomes will not be felt equally in all subpopulations.</p>
<p>For each subpopulation we model the effect of the health change scenario which was associated with the greatest relative change in sickness-related economic inactivity and unemployment, namely scenario 5: the scenario in which MH and PH are both improved, but PH is improved twice as much as MH. This represents the most ‘efficient’ change to health, in terms of the expected outcomes, of those scenarios considered.</p>
<section id="differences-by-sex" class="level3">
<h3 class="anchored" data-anchor-id="differences-by-sex">Differences by sex</h3>
<p>We consider two approaches to looking at differences by sex in the effects of changing health as per scenario 5:</p>
<ul>
<li><ol type="i">
<li>Running the models separately for the observed male and female subpopulations in wave J of the UKHLS.</li>
</ol></li>
<li><ol start="2" type="i">
<li>Using all observations in the UKHLS, but artificially ‘changing’ the sex of the observations to male or female for all observations.</li>
</ol></li>
</ul>
<p>The first approach has the advantage of only using real data, but reduced the number of observations in each subpopulation group; the second approach uses the same number of observations for both subpopulations, but relies more heavily on the assumptions built into the best-fitting model.</p>
<p>The projected results based on approach i) are shown in <a href="#tbl-male_female_separately_observed">Table&nbsp;8</a>, and the projected results based on approach ii) are shown in <a href="#tbl-male_female_separately_modelled">Table&nbsp;9</a>.</p>
<div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb20"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>econ_cat_levels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Employed"</span>, <span class="st">"Unemployed"</span>, <span class="st">"Inactive student"</span>, <span class="st">"Inactive care"</span>, <span class="st">"Inactive long term sick"</span>, <span class="st">"Inactive retired"</span>, <span class="st">"Inactive other"</span>)</span>
<span id="cb20-2"><a href="#cb20-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-3"><a href="#cb20-3" aria-hidden="true" tabindex="-1"></a>df_baseline_females <span class="ot">&lt;-</span> </span>
<span id="cb20-4"><a href="#cb20-4" aria-hidden="true" tabindex="-1"></a>  ind_data_standardised <span class="sc">|&gt;</span> </span>
<span id="cb20-5"><a href="#cb20-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb20-6"><a href="#cb20-6" aria-hidden="true" tabindex="-1"></a>    wave <span class="sc">==</span> <span class="st">"j"</span>,</span>
<span id="cb20-7"><a href="#cb20-7" aria-hidden="true" tabindex="-1"></a>    sex <span class="sc">==</span> <span class="st">"female"</span></span>
<span id="cb20-8"><a href="#cb20-8" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb20-9"><a href="#cb20-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-10"><a href="#cb20-10" aria-hidden="true" tabindex="-1"></a>df_baseline_males <span class="ot">&lt;-</span> </span>
<span id="cb20-11"><a href="#cb20-11" aria-hidden="true" tabindex="-1"></a>  ind_data_standardised <span class="sc">|&gt;</span> </span>
<span id="cb20-12"><a href="#cb20-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb20-13"><a href="#cb20-13" aria-hidden="true" tabindex="-1"></a>    wave <span class="sc">==</span> <span class="st">"j"</span>,</span>
<span id="cb20-14"><a href="#cb20-14" aria-hidden="true" tabindex="-1"></a>    sex <span class="sc">==</span> <span class="st">"male"</span></span>
<span id="cb20-15"><a href="#cb20-15" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb20-16"><a href="#cb20-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-17"><a href="#cb20-17" aria-hidden="true" tabindex="-1"></a>df_counter_females <span class="ot">&lt;-</span></span>
<span id="cb20-18"><a href="#cb20-18" aria-hidden="true" tabindex="-1"></a>  df_baseline_females <span class="sc">|&gt;</span> </span>
<span id="cb20-19"><a href="#cb20-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb20-20"><a href="#cb20-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">sf12mcs_dv =</span> sf12mcs_dv <span class="sc">+</span> <span class="dv">1</span> <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">5</span>),</span>
<span id="cb20-21"><a href="#cb20-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">sf12pcs_dv =</span> sf12pcs_dv <span class="sc">+</span> <span class="dv">2</span> <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">5</span>)</span>
<span id="cb20-22"><a href="#cb20-22" aria-hidden="true" tabindex="-1"></a>  )  </span>
<span id="cb20-23"><a href="#cb20-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-24"><a href="#cb20-24" aria-hidden="true" tabindex="-1"></a>df_counter_males <span class="ot">&lt;-</span></span>
<span id="cb20-25"><a href="#cb20-25" aria-hidden="true" tabindex="-1"></a>  df_baseline_males <span class="sc">|&gt;</span> </span>
<span id="cb20-26"><a href="#cb20-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb20-27"><a href="#cb20-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">sf12mcs_dv =</span> sf12mcs_dv <span class="sc">+</span> <span class="dv">1</span> <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">5</span>),</span>
<span id="cb20-28"><a href="#cb20-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">sf12pcs_dv =</span> sf12pcs_dv <span class="sc">+</span> <span class="dv">2</span> <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">5</span>)</span>
<span id="cb20-29"><a href="#cb20-29" aria-hidden="true" tabindex="-1"></a>  ) </span>
<span id="cb20-30"><a href="#cb20-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-31"><a href="#cb20-31" aria-hidden="true" tabindex="-1"></a>preds_df_base_females <span class="ot">&lt;-</span> </span>
<span id="cb20-32"><a href="#cb20-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predict</span>(mod_phmh, <span class="at">newdata =</span> df_baseline_females, <span class="at">type =</span> <span class="st">"probs"</span>)</span>
<span id="cb20-33"><a href="#cb20-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-34"><a href="#cb20-34" aria-hidden="true" tabindex="-1"></a>preds_df_base_males <span class="ot">&lt;-</span> </span>
<span id="cb20-35"><a href="#cb20-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predict</span>(mod_phmh, <span class="at">newdata =</span> df_baseline_males, <span class="at">type =</span> <span class="st">"probs"</span>)</span>
<span id="cb20-36"><a href="#cb20-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-37"><a href="#cb20-37" aria-hidden="true" tabindex="-1"></a>preds_df_counter_females <span class="ot">&lt;-</span> </span>
<span id="cb20-38"><a href="#cb20-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predict</span>(mod_phmh, <span class="at">newdata =</span> df_counter_females, <span class="at">type =</span> <span class="st">"probs"</span>)</span>
<span id="cb20-39"><a href="#cb20-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-40"><a href="#cb20-40" aria-hidden="true" tabindex="-1"></a>preds_df_counter_males <span class="ot">&lt;-</span> </span>
<span id="cb20-41"><a href="#cb20-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predict</span>(mod_phmh, <span class="at">newdata =</span> df_counter_males, <span class="at">type =</span> <span class="st">"probs"</span>)</span>
<span id="cb20-42"><a href="#cb20-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-43"><a href="#cb20-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-44"><a href="#cb20-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-45"><a href="#cb20-45" aria-hidden="true" tabindex="-1"></a>predictions_summary_matrix_females <span class="ot">&lt;-</span> <span class="fu">cbind</span>(</span>
<span id="cb20-46"><a href="#cb20-46" aria-hidden="true" tabindex="-1"></a>  <span class="co"># The number 2 indicates do the sum function for each column.</span></span>
<span id="cb20-47"><a href="#cb20-47" aria-hidden="true" tabindex="-1"></a>  <span class="co"># If it were 1 then this would sum for each row (which should add up to 1 in call cases)</span></span>
<span id="cb20-48"><a href="#cb20-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">apply</span>(preds_df_base_females, <span class="dv">2</span>, <span class="cf">function</span>(x) <span class="fu">round</span>(<span class="fu">sum</span>(x), <span class="dv">0</span>)),</span>
<span id="cb20-49"><a href="#cb20-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">apply</span>(preds_df_counter_females, <span class="dv">2</span>, <span class="cf">function</span>(x) <span class="fu">round</span>(<span class="fu">sum</span>(x), <span class="dv">0</span>))</span>
<span id="cb20-50"><a href="#cb20-50" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb20-51"><a href="#cb20-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-52"><a href="#cb20-52" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(predictions_summary_matrix_females) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"base"</span>, <span class="st">"counterfactual"</span>)</span>
<span id="cb20-53"><a href="#cb20-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-54"><a href="#cb20-54" aria-hidden="true" tabindex="-1"></a>tbl_mod_females <span class="ot">&lt;-</span> </span>
<span id="cb20-55"><a href="#cb20-55" aria-hidden="true" tabindex="-1"></a>  predictions_summary_matrix_females <span class="sc">|&gt;</span> </span>
<span id="cb20-56"><a href="#cb20-56" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span> </span>
<span id="cb20-57"><a href="#cb20-57" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">"State"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb20-58"><a href="#cb20-58" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb20-59"><a href="#cb20-59" aria-hidden="true" tabindex="-1"></a>        <span class="at">State =</span> <span class="fu">factor</span>(</span>
<span id="cb20-60"><a href="#cb20-60" aria-hidden="true" tabindex="-1"></a>          State, </span>
<span id="cb20-61"><a href="#cb20-61" aria-hidden="true" tabindex="-1"></a>          <span class="at">ordered =</span> <span class="cn">TRUE</span>, </span>
<span id="cb20-62"><a href="#cb20-62" aria-hidden="true" tabindex="-1"></a>          <span class="at">levels =</span> econ_cat_levels</span>
<span id="cb20-63"><a href="#cb20-63" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb20-64"><a href="#cb20-64" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">|&gt;</span> </span>
<span id="cb20-65"><a href="#cb20-65" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(State) <span class="sc">|&gt;</span> </span>
<span id="cb20-66"><a href="#cb20-66" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb20-67"><a href="#cb20-67" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Absolute Change</span><span class="st">`</span> <span class="ot">=</span> counterfactual <span class="sc">-</span> base,</span>
<span id="cb20-68"><a href="#cb20-68" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Relative Change</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">Absolute Change</span><span class="st">`</span> <span class="sc">/</span> base</span>
<span id="cb20-69"><a href="#cb20-69" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb20-70"><a href="#cb20-70" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb20-71"><a href="#cb20-71" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Relative Change</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">ifelse</span>(</span>
<span id="cb20-72"><a href="#cb20-72" aria-hidden="true" tabindex="-1"></a>        <span class="st">`</span><span class="at">Relative Change</span><span class="st">`</span> <span class="sc">&gt;</span> <span class="dv">0</span>, </span>
<span id="cb20-73"><a href="#cb20-73" aria-hidden="true" tabindex="-1"></a>        glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">"{round(100 * `Relative Change`, 1)}% up"</span> ),</span>
<span id="cb20-74"><a href="#cb20-74" aria-hidden="true" tabindex="-1"></a>        glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">"{round(-100 * `Relative Change`, 1)}% down"</span>)</span>
<span id="cb20-75"><a href="#cb20-75" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb20-76"><a href="#cb20-76" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb20-77"><a href="#cb20-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-78"><a href="#cb20-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-79"><a href="#cb20-79" aria-hidden="true" tabindex="-1"></a>predictions_summary_matrix_males <span class="ot">&lt;-</span> <span class="fu">cbind</span>(</span>
<span id="cb20-80"><a href="#cb20-80" aria-hidden="true" tabindex="-1"></a>  <span class="co"># The number 2 indicates do the sum function for each column.</span></span>
<span id="cb20-81"><a href="#cb20-81" aria-hidden="true" tabindex="-1"></a>  <span class="co"># If it were 1 then this would sum for each row (which should add up to 1 in call cases)</span></span>
<span id="cb20-82"><a href="#cb20-82" aria-hidden="true" tabindex="-1"></a>  <span class="fu">apply</span>(preds_df_base_males, <span class="dv">2</span>, <span class="cf">function</span>(x) <span class="fu">round</span>(<span class="fu">sum</span>(x), <span class="dv">0</span>)),</span>
<span id="cb20-83"><a href="#cb20-83" aria-hidden="true" tabindex="-1"></a>  <span class="fu">apply</span>(preds_df_counter_males, <span class="dv">2</span>, <span class="cf">function</span>(x) <span class="fu">round</span>(<span class="fu">sum</span>(x), <span class="dv">0</span>))</span>
<span id="cb20-84"><a href="#cb20-84" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb20-85"><a href="#cb20-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-86"><a href="#cb20-86" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(predictions_summary_matrix_males) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"base"</span>, <span class="st">"counterfactual"</span>)</span>
<span id="cb20-87"><a href="#cb20-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-88"><a href="#cb20-88" aria-hidden="true" tabindex="-1"></a>tbl_mod_males <span class="ot">&lt;-</span> </span>
<span id="cb20-89"><a href="#cb20-89" aria-hidden="true" tabindex="-1"></a>  predictions_summary_matrix_males <span class="sc">|&gt;</span> </span>
<span id="cb20-90"><a href="#cb20-90" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span> </span>
<span id="cb20-91"><a href="#cb20-91" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">"State"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb20-92"><a href="#cb20-92" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb20-93"><a href="#cb20-93" aria-hidden="true" tabindex="-1"></a>        <span class="at">State =</span> <span class="fu">factor</span>(</span>
<span id="cb20-94"><a href="#cb20-94" aria-hidden="true" tabindex="-1"></a>          State, </span>
<span id="cb20-95"><a href="#cb20-95" aria-hidden="true" tabindex="-1"></a>          <span class="at">ordered =</span> <span class="cn">TRUE</span>, </span>
<span id="cb20-96"><a href="#cb20-96" aria-hidden="true" tabindex="-1"></a>          <span class="at">levels =</span> econ_cat_levels</span>
<span id="cb20-97"><a href="#cb20-97" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb20-98"><a href="#cb20-98" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">|&gt;</span> </span>
<span id="cb20-99"><a href="#cb20-99" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(State) <span class="sc">|&gt;</span> </span>
<span id="cb20-100"><a href="#cb20-100" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb20-101"><a href="#cb20-101" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Absolute Change</span><span class="st">`</span> <span class="ot">=</span> counterfactual <span class="sc">-</span> base,</span>
<span id="cb20-102"><a href="#cb20-102" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Relative Change</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">Absolute Change</span><span class="st">`</span> <span class="sc">/</span> base</span>
<span id="cb20-103"><a href="#cb20-103" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb20-104"><a href="#cb20-104" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb20-105"><a href="#cb20-105" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Relative Change</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">ifelse</span>(</span>
<span id="cb20-106"><a href="#cb20-106" aria-hidden="true" tabindex="-1"></a>        <span class="st">`</span><span class="at">Relative Change</span><span class="st">`</span> <span class="sc">&gt;</span> <span class="dv">0</span>, </span>
<span id="cb20-107"><a href="#cb20-107" aria-hidden="true" tabindex="-1"></a>        glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">"{round(100 * `Relative Change`, 1)}% up"</span> ),</span>
<span id="cb20-108"><a href="#cb20-108" aria-hidden="true" tabindex="-1"></a>        glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">"{round(-100 * `Relative Change`, 1)}% down"</span>)</span>
<span id="cb20-109"><a href="#cb20-109" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb20-110"><a href="#cb20-110" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb20-111"><a href="#cb20-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-112"><a href="#cb20-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-113"><a href="#cb20-113" aria-hidden="true" tabindex="-1"></a>kbl_health_phbias_females <span class="ot">&lt;-</span> tbl_mod_females <span class="sc">|&gt;</span> knitr<span class="sc">::</span><span class="fu">kable</span>()</span>
<span id="cb20-114"><a href="#cb20-114" aria-hidden="true" tabindex="-1"></a><span class="co"># save_kable(kbl_health, file = here::here("presentations/health_table.html"))</span></span>
<span id="cb20-115"><a href="#cb20-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-116"><a href="#cb20-116" aria-hidden="true" tabindex="-1"></a>kbl_health_phbias_males <span class="ot">&lt;-</span> tbl_mod_males <span class="sc">|&gt;</span> knitr<span class="sc">::</span><span class="fu">kable</span>()</span>
<span id="cb20-117"><a href="#cb20-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb20-118"><a href="#cb20-118" aria-hidden="true" tabindex="-1"></a>kbl_health_phbias_females</span>
<span id="cb20-119"><a href="#cb20-119" aria-hidden="true" tabindex="-1"></a>kbl_health_phbias_males</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="tbl-male_female_separately_observed" class="cell tbl-parent quarto-layout-panel anchored">
<div class="panel-caption table-caption">
<p>Table&nbsp;8: Differences in effects of improving health (biased towards physical health improvements) from observed male and female populations</p>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div id="tbl-male_female_separately_observed-1" class="quarto-layout-cell quarto-layout-cell-subref anchored" data-ref-parent="tbl-male_female_separately_observed" style="flex-basis: 100.0%;justify-content: center;">
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<caption>(a) Females</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">State</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">base</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">counterfactual</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Absolute Change</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Relative Change</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Employed</td>
<td style="text-align: right;">8038</td>
<td style="text-align: right;">8275</td>
<td style="text-align: right;">237</td>
<td style="text-align: left;">2.9% up</td>
</tr>
<tr class="even">
<td style="text-align: left;">Unemployed</td>
<td style="text-align: right;">499</td>
<td style="text-align: right;">408</td>
<td style="text-align: right;">-91</td>
<td style="text-align: left;">18.2% down</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Inactive student</td>
<td style="text-align: right;">696</td>
<td style="text-align: right;">729</td>
<td style="text-align: right;">33</td>
<td style="text-align: left;">4.7% up</td>
</tr>
<tr class="even">
<td style="text-align: left;">Inactive care</td>
<td style="text-align: right;">910</td>
<td style="text-align: right;">881</td>
<td style="text-align: right;">-29</td>
<td style="text-align: left;">3.2% down</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Inactive long term sick</td>
<td style="text-align: right;">492</td>
<td style="text-align: right;">339</td>
<td style="text-align: right;">-153</td>
<td style="text-align: left;">31.1% down</td>
</tr>
<tr class="even">
<td style="text-align: left;">Inactive retired</td>
<td style="text-align: right;">799</td>
<td style="text-align: right;">809</td>
<td style="text-align: right;">10</td>
<td style="text-align: left;">1.3% up</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Inactive other</td>
<td style="text-align: right;">78</td>
<td style="text-align: right;">72</td>
<td style="text-align: right;">-6</td>
<td style="text-align: left;">7.7% down</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">


</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div id="tbl-male_female_separately_observed-2" class="quarto-layout-cell quarto-layout-cell-subref anchored" data-ref-parent="tbl-male_female_separately_observed" style="flex-basis: 100.0%;justify-content: center;">
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<caption>(b) Males</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">State</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">base</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">counterfactual</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Absolute Change</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Relative Change</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Employed</td>
<td style="text-align: right;">6774</td>
<td style="text-align: right;">6930</td>
<td style="text-align: right;">156</td>
<td style="text-align: left;">2.3% up</td>
</tr>
<tr class="even">
<td style="text-align: left;">Unemployed</td>
<td style="text-align: right;">473</td>
<td style="text-align: right;">386</td>
<td style="text-align: right;">-87</td>
<td style="text-align: left;">18.4% down</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Inactive student</td>
<td style="text-align: right;">490</td>
<td style="text-align: right;">519</td>
<td style="text-align: right;">29</td>
<td style="text-align: left;">5.9% up</td>
</tr>
<tr class="even">
<td style="text-align: left;">Inactive care</td>
<td style="text-align: right;">64</td>
<td style="text-align: right;">63</td>
<td style="text-align: right;">-1</td>
<td style="text-align: left;">1.6% down</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Inactive long term sick</td>
<td style="text-align: right;">338</td>
<td style="text-align: right;">238</td>
<td style="text-align: right;">-100</td>
<td style="text-align: left;">29.6% down</td>
</tr>
<tr class="even">
<td style="text-align: left;">Inactive retired</td>
<td style="text-align: right;">593</td>
<td style="text-align: right;">600</td>
<td style="text-align: right;">7</td>
<td style="text-align: left;">1.2% up</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Inactive other</td>
<td style="text-align: right;">49</td>
<td style="text-align: right;">45</td>
<td style="text-align: right;">-4</td>
<td style="text-align: left;">8.2% down</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">


</div>
</div>
</div>
</div>
<p>Overall, there appear to be few substantive differences between males and females, in terms of the relative effects of this optimal health improvement scenario on the changing size of the economic (in)activity states. The model is not currently set up to determine if the differences observed are statistically significant, as they do not include credible intervals. But substantively, all relatively effects appear to be quite similar. The possible exception to this is the relative change to the size of the inactive care category, which is 3.2% down for females, and 1.6% down for males. However there are very few males observed in this category, and the 1.6% estimate is based on only one male fewer in the counterfactual than the baseline inactive care pool.</p>
<p>The equivalent results using the more model-based approach is shown in <a href="#tbl-male_female_separately_modelled">Table&nbsp;9</a></p>
<div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>econ_cat_levels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Employed"</span>, <span class="st">"Unemployed"</span>, <span class="st">"Inactive student"</span>, <span class="st">"Inactive care"</span>, <span class="st">"Inactive long term sick"</span>, <span class="st">"Inactive retired"</span>, <span class="st">"Inactive other"</span>)</span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>df_baseline_females <span class="ot">&lt;-</span> </span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a>  ind_data_standardised <span class="sc">|&gt;</span> </span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb21-6"><a href="#cb21-6" aria-hidden="true" tabindex="-1"></a>    wave <span class="sc">==</span> <span class="st">"j"</span></span>
<span id="cb21-7"><a href="#cb21-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb21-8"><a href="#cb21-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sex =</span> <span class="st">"female"</span>)</span>
<span id="cb21-9"><a href="#cb21-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-10"><a href="#cb21-10" aria-hidden="true" tabindex="-1"></a>df_baseline_males <span class="ot">&lt;-</span> </span>
<span id="cb21-11"><a href="#cb21-11" aria-hidden="true" tabindex="-1"></a>  ind_data_standardised <span class="sc">|&gt;</span> </span>
<span id="cb21-12"><a href="#cb21-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb21-13"><a href="#cb21-13" aria-hidden="true" tabindex="-1"></a>    wave <span class="sc">==</span> <span class="st">"j"</span></span>
<span id="cb21-14"><a href="#cb21-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb21-15"><a href="#cb21-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">sex =</span> <span class="st">"male"</span>)</span>
<span id="cb21-16"><a href="#cb21-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-17"><a href="#cb21-17" aria-hidden="true" tabindex="-1"></a>df_counter_females <span class="ot">&lt;-</span></span>
<span id="cb21-18"><a href="#cb21-18" aria-hidden="true" tabindex="-1"></a>  df_baseline_females <span class="sc">|&gt;</span> </span>
<span id="cb21-19"><a href="#cb21-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb21-20"><a href="#cb21-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">sf12mcs_dv =</span> sf12mcs_dv <span class="sc">+</span> <span class="dv">1</span> <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">5</span>),</span>
<span id="cb21-21"><a href="#cb21-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">sf12pcs_dv =</span> sf12pcs_dv <span class="sc">+</span> <span class="dv">2</span> <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">5</span>)</span>
<span id="cb21-22"><a href="#cb21-22" aria-hidden="true" tabindex="-1"></a>  )  </span>
<span id="cb21-23"><a href="#cb21-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-24"><a href="#cb21-24" aria-hidden="true" tabindex="-1"></a>df_counter_males <span class="ot">&lt;-</span></span>
<span id="cb21-25"><a href="#cb21-25" aria-hidden="true" tabindex="-1"></a>  df_baseline_males <span class="sc">|&gt;</span> </span>
<span id="cb21-26"><a href="#cb21-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb21-27"><a href="#cb21-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">sf12mcs_dv =</span> sf12mcs_dv <span class="sc">+</span> <span class="dv">1</span> <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">5</span>),</span>
<span id="cb21-28"><a href="#cb21-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">sf12pcs_dv =</span> sf12pcs_dv <span class="sc">+</span> <span class="dv">2</span> <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">5</span>)</span>
<span id="cb21-29"><a href="#cb21-29" aria-hidden="true" tabindex="-1"></a>  ) </span>
<span id="cb21-30"><a href="#cb21-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-31"><a href="#cb21-31" aria-hidden="true" tabindex="-1"></a>preds_df_base_females <span class="ot">&lt;-</span> </span>
<span id="cb21-32"><a href="#cb21-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predict</span>(mod_phmh, <span class="at">newdata =</span> df_baseline_females, <span class="at">type =</span> <span class="st">"probs"</span>)</span>
<span id="cb21-33"><a href="#cb21-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-34"><a href="#cb21-34" aria-hidden="true" tabindex="-1"></a>preds_df_base_males <span class="ot">&lt;-</span> </span>
<span id="cb21-35"><a href="#cb21-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predict</span>(mod_phmh, <span class="at">newdata =</span> df_baseline_males, <span class="at">type =</span> <span class="st">"probs"</span>)</span>
<span id="cb21-36"><a href="#cb21-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-37"><a href="#cb21-37" aria-hidden="true" tabindex="-1"></a>preds_df_counter_females <span class="ot">&lt;-</span> </span>
<span id="cb21-38"><a href="#cb21-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predict</span>(mod_phmh, <span class="at">newdata =</span> df_counter_females, <span class="at">type =</span> <span class="st">"probs"</span>)</span>
<span id="cb21-39"><a href="#cb21-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-40"><a href="#cb21-40" aria-hidden="true" tabindex="-1"></a>preds_df_counter_males <span class="ot">&lt;-</span> </span>
<span id="cb21-41"><a href="#cb21-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predict</span>(mod_phmh, <span class="at">newdata =</span> df_counter_males, <span class="at">type =</span> <span class="st">"probs"</span>)</span>
<span id="cb21-42"><a href="#cb21-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-43"><a href="#cb21-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-44"><a href="#cb21-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-45"><a href="#cb21-45" aria-hidden="true" tabindex="-1"></a>predictions_summary_matrix_females <span class="ot">&lt;-</span> <span class="fu">cbind</span>(</span>
<span id="cb21-46"><a href="#cb21-46" aria-hidden="true" tabindex="-1"></a>  <span class="co"># The number 2 indicates do the sum function for each column.</span></span>
<span id="cb21-47"><a href="#cb21-47" aria-hidden="true" tabindex="-1"></a>  <span class="co"># If it were 1 then this would sum for each row (which should add up to 1 in call cases)</span></span>
<span id="cb21-48"><a href="#cb21-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">apply</span>(preds_df_base_females, <span class="dv">2</span>, <span class="cf">function</span>(x) <span class="fu">round</span>(<span class="fu">sum</span>(x), <span class="dv">0</span>)),</span>
<span id="cb21-49"><a href="#cb21-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">apply</span>(preds_df_counter_females, <span class="dv">2</span>, <span class="cf">function</span>(x) <span class="fu">round</span>(<span class="fu">sum</span>(x), <span class="dv">0</span>))</span>
<span id="cb21-50"><a href="#cb21-50" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb21-51"><a href="#cb21-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-52"><a href="#cb21-52" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(predictions_summary_matrix_females) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"base"</span>, <span class="st">"counterfactual"</span>)</span>
<span id="cb21-53"><a href="#cb21-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-54"><a href="#cb21-54" aria-hidden="true" tabindex="-1"></a>tbl_mod_females <span class="ot">&lt;-</span> </span>
<span id="cb21-55"><a href="#cb21-55" aria-hidden="true" tabindex="-1"></a>  predictions_summary_matrix_females <span class="sc">|&gt;</span> </span>
<span id="cb21-56"><a href="#cb21-56" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span> </span>
<span id="cb21-57"><a href="#cb21-57" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">"State"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb21-58"><a href="#cb21-58" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb21-59"><a href="#cb21-59" aria-hidden="true" tabindex="-1"></a>        <span class="at">State =</span> <span class="fu">factor</span>(</span>
<span id="cb21-60"><a href="#cb21-60" aria-hidden="true" tabindex="-1"></a>          State, </span>
<span id="cb21-61"><a href="#cb21-61" aria-hidden="true" tabindex="-1"></a>          <span class="at">ordered =</span> <span class="cn">TRUE</span>, </span>
<span id="cb21-62"><a href="#cb21-62" aria-hidden="true" tabindex="-1"></a>          <span class="at">levels =</span> econ_cat_levels</span>
<span id="cb21-63"><a href="#cb21-63" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb21-64"><a href="#cb21-64" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">|&gt;</span> </span>
<span id="cb21-65"><a href="#cb21-65" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(State) <span class="sc">|&gt;</span> </span>
<span id="cb21-66"><a href="#cb21-66" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb21-67"><a href="#cb21-67" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Absolute Change</span><span class="st">`</span> <span class="ot">=</span> counterfactual <span class="sc">-</span> base,</span>
<span id="cb21-68"><a href="#cb21-68" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Relative Change</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">Absolute Change</span><span class="st">`</span> <span class="sc">/</span> base</span>
<span id="cb21-69"><a href="#cb21-69" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb21-70"><a href="#cb21-70" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb21-71"><a href="#cb21-71" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Relative Change</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">ifelse</span>(</span>
<span id="cb21-72"><a href="#cb21-72" aria-hidden="true" tabindex="-1"></a>        <span class="st">`</span><span class="at">Relative Change</span><span class="st">`</span> <span class="sc">&gt;</span> <span class="dv">0</span>, </span>
<span id="cb21-73"><a href="#cb21-73" aria-hidden="true" tabindex="-1"></a>        glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">"{round(100 * `Relative Change`, 1)}% up"</span> ),</span>
<span id="cb21-74"><a href="#cb21-74" aria-hidden="true" tabindex="-1"></a>        glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">"{round(-100 * `Relative Change`, 1)}% down"</span>)</span>
<span id="cb21-75"><a href="#cb21-75" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb21-76"><a href="#cb21-76" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb21-77"><a href="#cb21-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-78"><a href="#cb21-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-79"><a href="#cb21-79" aria-hidden="true" tabindex="-1"></a>predictions_summary_matrix_males <span class="ot">&lt;-</span> <span class="fu">cbind</span>(</span>
<span id="cb21-80"><a href="#cb21-80" aria-hidden="true" tabindex="-1"></a>  <span class="co"># The number 2 indicates do the sum function for each column.</span></span>
<span id="cb21-81"><a href="#cb21-81" aria-hidden="true" tabindex="-1"></a>  <span class="co"># If it were 1 then this would sum for each row (which should add up to 1 in call cases)</span></span>
<span id="cb21-82"><a href="#cb21-82" aria-hidden="true" tabindex="-1"></a>  <span class="fu">apply</span>(preds_df_base_males, <span class="dv">2</span>, <span class="cf">function</span>(x) <span class="fu">round</span>(<span class="fu">sum</span>(x), <span class="dv">0</span>)),</span>
<span id="cb21-83"><a href="#cb21-83" aria-hidden="true" tabindex="-1"></a>  <span class="fu">apply</span>(preds_df_counter_males, <span class="dv">2</span>, <span class="cf">function</span>(x) <span class="fu">round</span>(<span class="fu">sum</span>(x), <span class="dv">0</span>))</span>
<span id="cb21-84"><a href="#cb21-84" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb21-85"><a href="#cb21-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-86"><a href="#cb21-86" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(predictions_summary_matrix_males) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"base"</span>, <span class="st">"counterfactual"</span>)</span>
<span id="cb21-87"><a href="#cb21-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-88"><a href="#cb21-88" aria-hidden="true" tabindex="-1"></a>tbl_mod_males <span class="ot">&lt;-</span> </span>
<span id="cb21-89"><a href="#cb21-89" aria-hidden="true" tabindex="-1"></a>  predictions_summary_matrix_males <span class="sc">|&gt;</span> </span>
<span id="cb21-90"><a href="#cb21-90" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span> </span>
<span id="cb21-91"><a href="#cb21-91" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">"State"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb21-92"><a href="#cb21-92" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb21-93"><a href="#cb21-93" aria-hidden="true" tabindex="-1"></a>        <span class="at">State =</span> <span class="fu">factor</span>(</span>
<span id="cb21-94"><a href="#cb21-94" aria-hidden="true" tabindex="-1"></a>          State, </span>
<span id="cb21-95"><a href="#cb21-95" aria-hidden="true" tabindex="-1"></a>          <span class="at">ordered =</span> <span class="cn">TRUE</span>, </span>
<span id="cb21-96"><a href="#cb21-96" aria-hidden="true" tabindex="-1"></a>          <span class="at">levels =</span> econ_cat_levels</span>
<span id="cb21-97"><a href="#cb21-97" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb21-98"><a href="#cb21-98" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">|&gt;</span> </span>
<span id="cb21-99"><a href="#cb21-99" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(State) <span class="sc">|&gt;</span> </span>
<span id="cb21-100"><a href="#cb21-100" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb21-101"><a href="#cb21-101" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Absolute Change</span><span class="st">`</span> <span class="ot">=</span> counterfactual <span class="sc">-</span> base,</span>
<span id="cb21-102"><a href="#cb21-102" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Relative Change</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">Absolute Change</span><span class="st">`</span> <span class="sc">/</span> base</span>
<span id="cb21-103"><a href="#cb21-103" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb21-104"><a href="#cb21-104" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb21-105"><a href="#cb21-105" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Relative Change</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">ifelse</span>(</span>
<span id="cb21-106"><a href="#cb21-106" aria-hidden="true" tabindex="-1"></a>        <span class="st">`</span><span class="at">Relative Change</span><span class="st">`</span> <span class="sc">&gt;</span> <span class="dv">0</span>, </span>
<span id="cb21-107"><a href="#cb21-107" aria-hidden="true" tabindex="-1"></a>        glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">"{round(100 * `Relative Change`, 1)}% up"</span> ),</span>
<span id="cb21-108"><a href="#cb21-108" aria-hidden="true" tabindex="-1"></a>        glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">"{round(-100 * `Relative Change`, 1)}% down"</span>)</span>
<span id="cb21-109"><a href="#cb21-109" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb21-110"><a href="#cb21-110" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb21-111"><a href="#cb21-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-112"><a href="#cb21-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-113"><a href="#cb21-113" aria-hidden="true" tabindex="-1"></a>kbl_health_phbias_females <span class="ot">&lt;-</span> tbl_mod_females <span class="sc">|&gt;</span> knitr<span class="sc">::</span><span class="fu">kable</span>()</span>
<span id="cb21-114"><a href="#cb21-114" aria-hidden="true" tabindex="-1"></a><span class="co"># save_kable(kbl_health, file = here::here("presentations/health_table.html"))</span></span>
<span id="cb21-115"><a href="#cb21-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-116"><a href="#cb21-116" aria-hidden="true" tabindex="-1"></a>kbl_health_phbias_males <span class="ot">&lt;-</span> tbl_mod_males <span class="sc">|&gt;</span> knitr<span class="sc">::</span><span class="fu">kable</span>()</span>
<span id="cb21-117"><a href="#cb21-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-118"><a href="#cb21-118" aria-hidden="true" tabindex="-1"></a>kbl_health_phbias_females</span>
<span id="cb21-119"><a href="#cb21-119" aria-hidden="true" tabindex="-1"></a>kbl_health_phbias_males</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="tbl-male_female_separately_modelled" class="cell tbl-parent quarto-layout-panel anchored">
<div class="panel-caption table-caption">
<p>Table&nbsp;9: Differences in effects of improving health (biased towards physical health improvements) from observed male and female populations (modelled approach</p>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div id="tbl-male_female_separately_modelled-1" class="quarto-layout-cell quarto-layout-cell-subref anchored" data-ref-parent="tbl-male_female_separately_modelled" style="flex-basis: 100.0%;justify-content: center;">
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<caption>(a) Females</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">State</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">base</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">counterfactual</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Absolute Change</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Relative Change</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Employed</td>
<td style="text-align: right;">14709</td>
<td style="text-align: right;">15103</td>
<td style="text-align: right;">394</td>
<td style="text-align: left;">2.7% up</td>
</tr>
<tr class="even">
<td style="text-align: left;">Unemployed</td>
<td style="text-align: right;">840</td>
<td style="text-align: right;">683</td>
<td style="text-align: right;">-157</td>
<td style="text-align: left;">18.7% down</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Inactive student</td>
<td style="text-align: right;">1217</td>
<td style="text-align: right;">1278</td>
<td style="text-align: right;">61</td>
<td style="text-align: left;">5% up</td>
</tr>
<tr class="even">
<td style="text-align: left;">Inactive care</td>
<td style="text-align: right;">1185</td>
<td style="text-align: right;">1137</td>
<td style="text-align: right;">-48</td>
<td style="text-align: left;">4.1% down</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Inactive long term sick</td>
<td style="text-align: right;">798</td>
<td style="text-align: right;">545</td>
<td style="text-align: right;">-253</td>
<td style="text-align: left;">31.7% down</td>
</tr>
<tr class="even">
<td style="text-align: left;">Inactive retired</td>
<td style="text-align: right;">1416</td>
<td style="text-align: right;">1430</td>
<td style="text-align: right;">14</td>
<td style="text-align: left;">1% up</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Inactive other</td>
<td style="text-align: right;">129</td>
<td style="text-align: right;">117</td>
<td style="text-align: right;">-12</td>
<td style="text-align: left;">9.3% down</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">


</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div id="tbl-male_female_separately_modelled-2" class="quarto-layout-cell quarto-layout-cell-subref anchored" data-ref-parent="tbl-male_female_separately_modelled" style="flex-basis: 100.0%;justify-content: center;">
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<caption>(b) Males</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">State</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">base</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">counterfactual</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Absolute Change</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Relative Change</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Employed</td>
<td style="text-align: right;">14945</td>
<td style="text-align: right;">15341</td>
<td style="text-align: right;">396</td>
<td style="text-align: left;">2.6% up</td>
</tr>
<tr class="even">
<td style="text-align: left;">Unemployed</td>
<td style="text-align: right;">1206</td>
<td style="text-align: right;">990</td>
<td style="text-align: right;">-216</td>
<td style="text-align: left;">17.9% down</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Inactive student</td>
<td style="text-align: right;">1143</td>
<td style="text-align: right;">1210</td>
<td style="text-align: right;">67</td>
<td style="text-align: left;">5.9% up</td>
</tr>
<tr class="even">
<td style="text-align: left;">Inactive care</td>
<td style="text-align: right;">599</td>
<td style="text-align: right;">590</td>
<td style="text-align: right;">-9</td>
<td style="text-align: left;">1.5% down</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Inactive long term sick</td>
<td style="text-align: right;">876</td>
<td style="text-align: right;">623</td>
<td style="text-align: right;">-253</td>
<td style="text-align: left;">28.9% down</td>
</tr>
<tr class="even">
<td style="text-align: left;">Inactive retired</td>
<td style="text-align: right;">1358</td>
<td style="text-align: right;">1380</td>
<td style="text-align: right;">22</td>
<td style="text-align: left;">1.6% up</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Inactive other</td>
<td style="text-align: right;">167</td>
<td style="text-align: right;">159</td>
<td style="text-align: right;">-8</td>
<td style="text-align: left;">4.8% down</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">


</div>
</div>
</div>
</div>
<p>In general both approaches lead to substantively similar estimates of the effects of the health improvement scenario. In both men and women substantive improvements in employment, unemployment, and inactive long-term sick are observed, and estimated to be of similar magnitudes. When using the more model-based approach, the differences in the effects on inactive care are even greater by sex, being estimated to lead to a 4.1% decline for females and 1.5% decline for males. Other than this, the estimated effects are very similar by both sex, and the estimation approach used.</p>
<p>Overall, we can conclude that there appear not to be substantive differences by sex in terms of the effect of improving health on labour market participation and economic (in)activity. This suggests that an effective health intervention is likely to have similar effects on improving these economic outcomes for both males and females.</p>
</section>
<section id="differences-by-age-group" class="level3">
<h3 class="anchored" data-anchor-id="differences-by-age-group">Differences by age group</h3>
<p>For looking at differences by age group, we use the equivalent of approach i) only. This is because we have sizeable subpopulations in both working age age groups considered, and because age is itself likely to influence both mental health and physical health. The results of running this subgroup analysis, splitting the observed population in wave J into the two broad age groups, is shown in <a href="#tbl-younger_older_separately_observed">Table&nbsp;10</a></p>
<div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb22"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>econ_cat_levels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Employed"</span>, <span class="st">"Unemployed"</span>, <span class="st">"Inactive student"</span>, <span class="st">"Inactive care"</span>, <span class="st">"Inactive long term sick"</span>, <span class="st">"Inactive retired"</span>, <span class="st">"Inactive other"</span>)</span>
<span id="cb22-2"><a href="#cb22-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-3"><a href="#cb22-3" aria-hidden="true" tabindex="-1"></a>df_baseline_younger <span class="ot">&lt;-</span> </span>
<span id="cb22-4"><a href="#cb22-4" aria-hidden="true" tabindex="-1"></a>  ind_data_standardised <span class="sc">|&gt;</span> </span>
<span id="cb22-5"><a href="#cb22-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb22-6"><a href="#cb22-6" aria-hidden="true" tabindex="-1"></a>    wave <span class="sc">==</span> <span class="st">"j"</span>,</span>
<span id="cb22-7"><a href="#cb22-7" aria-hidden="true" tabindex="-1"></a>    <span class="fu">between</span>(age, <span class="dv">16</span>, <span class="dv">44</span>)</span>
<span id="cb22-8"><a href="#cb22-8" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb22-9"><a href="#cb22-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-10"><a href="#cb22-10" aria-hidden="true" tabindex="-1"></a>df_baseline_older <span class="ot">&lt;-</span> </span>
<span id="cb22-11"><a href="#cb22-11" aria-hidden="true" tabindex="-1"></a>  ind_data_standardised <span class="sc">|&gt;</span> </span>
<span id="cb22-12"><a href="#cb22-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb22-13"><a href="#cb22-13" aria-hidden="true" tabindex="-1"></a>    wave <span class="sc">==</span> <span class="st">"j"</span>,</span>
<span id="cb22-14"><a href="#cb22-14" aria-hidden="true" tabindex="-1"></a>    <span class="fu">between</span>(age, <span class="dv">45</span>, <span class="dv">64</span>)</span>
<span id="cb22-15"><a href="#cb22-15" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb22-16"><a href="#cb22-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-17"><a href="#cb22-17" aria-hidden="true" tabindex="-1"></a>df_counter_younger <span class="ot">&lt;-</span></span>
<span id="cb22-18"><a href="#cb22-18" aria-hidden="true" tabindex="-1"></a>  df_baseline_younger <span class="sc">|&gt;</span> </span>
<span id="cb22-19"><a href="#cb22-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb22-20"><a href="#cb22-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">sf12mcs_dv =</span> sf12mcs_dv <span class="sc">+</span> <span class="dv">1</span> <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">5</span>),</span>
<span id="cb22-21"><a href="#cb22-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">sf12pcs_dv =</span> sf12pcs_dv <span class="sc">+</span> <span class="dv">2</span> <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">5</span>)</span>
<span id="cb22-22"><a href="#cb22-22" aria-hidden="true" tabindex="-1"></a>  )  </span>
<span id="cb22-23"><a href="#cb22-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-24"><a href="#cb22-24" aria-hidden="true" tabindex="-1"></a>df_counter_older <span class="ot">&lt;-</span></span>
<span id="cb22-25"><a href="#cb22-25" aria-hidden="true" tabindex="-1"></a>  df_baseline_older <span class="sc">|&gt;</span> </span>
<span id="cb22-26"><a href="#cb22-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb22-27"><a href="#cb22-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">sf12mcs_dv =</span> sf12mcs_dv <span class="sc">+</span> <span class="dv">1</span> <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">5</span>),</span>
<span id="cb22-28"><a href="#cb22-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">sf12pcs_dv =</span> sf12pcs_dv <span class="sc">+</span> <span class="dv">2</span> <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">5</span>)</span>
<span id="cb22-29"><a href="#cb22-29" aria-hidden="true" tabindex="-1"></a>  ) </span>
<span id="cb22-30"><a href="#cb22-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-31"><a href="#cb22-31" aria-hidden="true" tabindex="-1"></a>preds_df_base_younger <span class="ot">&lt;-</span> </span>
<span id="cb22-32"><a href="#cb22-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predict</span>(mod_phmh, <span class="at">newdata =</span> df_baseline_younger, <span class="at">type =</span> <span class="st">"probs"</span>)</span>
<span id="cb22-33"><a href="#cb22-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-34"><a href="#cb22-34" aria-hidden="true" tabindex="-1"></a>preds_df_base_older <span class="ot">&lt;-</span> </span>
<span id="cb22-35"><a href="#cb22-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predict</span>(mod_phmh, <span class="at">newdata =</span> df_baseline_older, <span class="at">type =</span> <span class="st">"probs"</span>)</span>
<span id="cb22-36"><a href="#cb22-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-37"><a href="#cb22-37" aria-hidden="true" tabindex="-1"></a>preds_df_counter_younger <span class="ot">&lt;-</span> </span>
<span id="cb22-38"><a href="#cb22-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predict</span>(mod_phmh, <span class="at">newdata =</span> df_counter_younger, <span class="at">type =</span> <span class="st">"probs"</span>)</span>
<span id="cb22-39"><a href="#cb22-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-40"><a href="#cb22-40" aria-hidden="true" tabindex="-1"></a>preds_df_counter_older <span class="ot">&lt;-</span> </span>
<span id="cb22-41"><a href="#cb22-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predict</span>(mod_phmh, <span class="at">newdata =</span> df_counter_older, <span class="at">type =</span> <span class="st">"probs"</span>)</span>
<span id="cb22-42"><a href="#cb22-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-43"><a href="#cb22-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-44"><a href="#cb22-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-45"><a href="#cb22-45" aria-hidden="true" tabindex="-1"></a>predictions_summary_matrix_younger <span class="ot">&lt;-</span> <span class="fu">cbind</span>(</span>
<span id="cb22-46"><a href="#cb22-46" aria-hidden="true" tabindex="-1"></a>  <span class="co"># The number 2 indicates do the sum function for each column.</span></span>
<span id="cb22-47"><a href="#cb22-47" aria-hidden="true" tabindex="-1"></a>  <span class="co"># If it were 1 then this would sum for each row (which should add up to 1 in call cases)</span></span>
<span id="cb22-48"><a href="#cb22-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">apply</span>(preds_df_base_younger, <span class="dv">2</span>, <span class="cf">function</span>(x) <span class="fu">round</span>(<span class="fu">sum</span>(x), <span class="dv">0</span>)),</span>
<span id="cb22-49"><a href="#cb22-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">apply</span>(preds_df_counter_younger, <span class="dv">2</span>, <span class="cf">function</span>(x) <span class="fu">round</span>(<span class="fu">sum</span>(x), <span class="dv">0</span>))</span>
<span id="cb22-50"><a href="#cb22-50" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb22-51"><a href="#cb22-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-52"><a href="#cb22-52" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(predictions_summary_matrix_younger) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"base"</span>, <span class="st">"counterfactual"</span>)</span>
<span id="cb22-53"><a href="#cb22-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-54"><a href="#cb22-54" aria-hidden="true" tabindex="-1"></a>tbl_mod_younger <span class="ot">&lt;-</span> </span>
<span id="cb22-55"><a href="#cb22-55" aria-hidden="true" tabindex="-1"></a>  predictions_summary_matrix_younger <span class="sc">|&gt;</span> </span>
<span id="cb22-56"><a href="#cb22-56" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span> </span>
<span id="cb22-57"><a href="#cb22-57" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">"State"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb22-58"><a href="#cb22-58" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb22-59"><a href="#cb22-59" aria-hidden="true" tabindex="-1"></a>        <span class="at">State =</span> <span class="fu">factor</span>(</span>
<span id="cb22-60"><a href="#cb22-60" aria-hidden="true" tabindex="-1"></a>          State, </span>
<span id="cb22-61"><a href="#cb22-61" aria-hidden="true" tabindex="-1"></a>          <span class="at">ordered =</span> <span class="cn">TRUE</span>, </span>
<span id="cb22-62"><a href="#cb22-62" aria-hidden="true" tabindex="-1"></a>          <span class="at">levels =</span> econ_cat_levels</span>
<span id="cb22-63"><a href="#cb22-63" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb22-64"><a href="#cb22-64" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">|&gt;</span> </span>
<span id="cb22-65"><a href="#cb22-65" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(State) <span class="sc">|&gt;</span> </span>
<span id="cb22-66"><a href="#cb22-66" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb22-67"><a href="#cb22-67" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Absolute Change</span><span class="st">`</span> <span class="ot">=</span> counterfactual <span class="sc">-</span> base,</span>
<span id="cb22-68"><a href="#cb22-68" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Relative Change</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">Absolute Change</span><span class="st">`</span> <span class="sc">/</span> base</span>
<span id="cb22-69"><a href="#cb22-69" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb22-70"><a href="#cb22-70" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb22-71"><a href="#cb22-71" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Relative Change</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">ifelse</span>(</span>
<span id="cb22-72"><a href="#cb22-72" aria-hidden="true" tabindex="-1"></a>        <span class="st">`</span><span class="at">Relative Change</span><span class="st">`</span> <span class="sc">&gt;</span> <span class="dv">0</span>, </span>
<span id="cb22-73"><a href="#cb22-73" aria-hidden="true" tabindex="-1"></a>        glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">"{round(100 * `Relative Change`, 1)}% up"</span> ),</span>
<span id="cb22-74"><a href="#cb22-74" aria-hidden="true" tabindex="-1"></a>        glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">"{round(-100 * `Relative Change`, 1)}% down"</span>)</span>
<span id="cb22-75"><a href="#cb22-75" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb22-76"><a href="#cb22-76" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb22-77"><a href="#cb22-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-78"><a href="#cb22-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-79"><a href="#cb22-79" aria-hidden="true" tabindex="-1"></a>predictions_summary_matrix_older <span class="ot">&lt;-</span> <span class="fu">cbind</span>(</span>
<span id="cb22-80"><a href="#cb22-80" aria-hidden="true" tabindex="-1"></a>  <span class="co"># The number 2 indicates do the sum function for each column.</span></span>
<span id="cb22-81"><a href="#cb22-81" aria-hidden="true" tabindex="-1"></a>  <span class="co"># If it were 1 then this would sum for each row (which should add up to 1 in call cases)</span></span>
<span id="cb22-82"><a href="#cb22-82" aria-hidden="true" tabindex="-1"></a>  <span class="fu">apply</span>(preds_df_base_older, <span class="dv">2</span>, <span class="cf">function</span>(x) <span class="fu">round</span>(<span class="fu">sum</span>(x), <span class="dv">0</span>)),</span>
<span id="cb22-83"><a href="#cb22-83" aria-hidden="true" tabindex="-1"></a>  <span class="fu">apply</span>(preds_df_counter_older, <span class="dv">2</span>, <span class="cf">function</span>(x) <span class="fu">round</span>(<span class="fu">sum</span>(x), <span class="dv">0</span>))</span>
<span id="cb22-84"><a href="#cb22-84" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb22-85"><a href="#cb22-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-86"><a href="#cb22-86" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(predictions_summary_matrix_older) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"base"</span>, <span class="st">"counterfactual"</span>)</span>
<span id="cb22-87"><a href="#cb22-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-88"><a href="#cb22-88" aria-hidden="true" tabindex="-1"></a>tbl_mod_older <span class="ot">&lt;-</span> </span>
<span id="cb22-89"><a href="#cb22-89" aria-hidden="true" tabindex="-1"></a>  predictions_summary_matrix_older <span class="sc">|&gt;</span> </span>
<span id="cb22-90"><a href="#cb22-90" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span> </span>
<span id="cb22-91"><a href="#cb22-91" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">"State"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb22-92"><a href="#cb22-92" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb22-93"><a href="#cb22-93" aria-hidden="true" tabindex="-1"></a>        <span class="at">State =</span> <span class="fu">factor</span>(</span>
<span id="cb22-94"><a href="#cb22-94" aria-hidden="true" tabindex="-1"></a>          State, </span>
<span id="cb22-95"><a href="#cb22-95" aria-hidden="true" tabindex="-1"></a>          <span class="at">ordered =</span> <span class="cn">TRUE</span>, </span>
<span id="cb22-96"><a href="#cb22-96" aria-hidden="true" tabindex="-1"></a>          <span class="at">levels =</span> econ_cat_levels</span>
<span id="cb22-97"><a href="#cb22-97" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb22-98"><a href="#cb22-98" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">|&gt;</span> </span>
<span id="cb22-99"><a href="#cb22-99" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(State) <span class="sc">|&gt;</span> </span>
<span id="cb22-100"><a href="#cb22-100" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb22-101"><a href="#cb22-101" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Absolute Change</span><span class="st">`</span> <span class="ot">=</span> counterfactual <span class="sc">-</span> base,</span>
<span id="cb22-102"><a href="#cb22-102" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Relative Change</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">Absolute Change</span><span class="st">`</span> <span class="sc">/</span> base</span>
<span id="cb22-103"><a href="#cb22-103" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb22-104"><a href="#cb22-104" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb22-105"><a href="#cb22-105" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Relative Change</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">ifelse</span>(</span>
<span id="cb22-106"><a href="#cb22-106" aria-hidden="true" tabindex="-1"></a>        <span class="st">`</span><span class="at">Relative Change</span><span class="st">`</span> <span class="sc">&gt;</span> <span class="dv">0</span>, </span>
<span id="cb22-107"><a href="#cb22-107" aria-hidden="true" tabindex="-1"></a>        glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">"{round(100 * `Relative Change`, 1)}% up"</span> ),</span>
<span id="cb22-108"><a href="#cb22-108" aria-hidden="true" tabindex="-1"></a>        glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">"{round(-100 * `Relative Change`, 1)}% down"</span>)</span>
<span id="cb22-109"><a href="#cb22-109" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb22-110"><a href="#cb22-110" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb22-111"><a href="#cb22-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-112"><a href="#cb22-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-113"><a href="#cb22-113" aria-hidden="true" tabindex="-1"></a>kbl_health_phbias_younger <span class="ot">&lt;-</span> tbl_mod_younger <span class="sc">|&gt;</span> knitr<span class="sc">::</span><span class="fu">kable</span>()</span>
<span id="cb22-114"><a href="#cb22-114" aria-hidden="true" tabindex="-1"></a><span class="co"># save_kable(kbl_health, file = here::here("presentations/health_table.html"))</span></span>
<span id="cb22-115"><a href="#cb22-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-116"><a href="#cb22-116" aria-hidden="true" tabindex="-1"></a>kbl_health_phbias_older <span class="ot">&lt;-</span> tbl_mod_older <span class="sc">|&gt;</span> knitr<span class="sc">::</span><span class="fu">kable</span>()</span>
<span id="cb22-117"><a href="#cb22-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb22-118"><a href="#cb22-118" aria-hidden="true" tabindex="-1"></a>kbl_health_phbias_younger</span>
<span id="cb22-119"><a href="#cb22-119" aria-hidden="true" tabindex="-1"></a>kbl_health_phbias_older</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="tbl-younger_older_separately_observed" class="cell tbl-parent quarto-layout-panel anchored">
<div class="panel-caption table-caption">
<p>Table&nbsp;10: Differences in effects of improving health (biased towards physical health improvements) from observed younger and older populations</p>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div id="tbl-younger_older_separately_observed-1" class="quarto-layout-cell quarto-layout-cell-subref anchored" data-ref-parent="tbl-younger_older_separately_observed" style="flex-basis: 100.0%;justify-content: center;">
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<caption>(a) Younger (16-44)</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">State</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">base</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">counterfactual</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Absolute Change</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Relative Change</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Employed</td>
<td style="text-align: right;">7586</td>
<td style="text-align: right;">7761</td>
<td style="text-align: right;">175</td>
<td style="text-align: left;">2.3% up</td>
</tr>
<tr class="even">
<td style="text-align: left;">Unemployed</td>
<td style="text-align: right;">589</td>
<td style="text-align: right;">464</td>
<td style="text-align: right;">-125</td>
<td style="text-align: left;">21.2% down</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Inactive student</td>
<td style="text-align: right;">1169</td>
<td style="text-align: right;">1229</td>
<td style="text-align: right;">60</td>
<td style="text-align: left;">5.1% up</td>
</tr>
<tr class="even">
<td style="text-align: left;">Inactive care</td>
<td style="text-align: right;">551</td>
<td style="text-align: right;">528</td>
<td style="text-align: right;">-23</td>
<td style="text-align: left;">4.2% down</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Inactive long term sick</td>
<td style="text-align: right;">240</td>
<td style="text-align: right;">159</td>
<td style="text-align: right;">-81</td>
<td style="text-align: left;">33.8% down</td>
</tr>
<tr class="even">
<td style="text-align: left;">Inactive retired</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">0% down</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Inactive other</td>
<td style="text-align: right;">63</td>
<td style="text-align: right;">56</td>
<td style="text-align: right;">-7</td>
<td style="text-align: left;">11.1% down</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">


</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div id="tbl-younger_older_separately_observed-2" class="quarto-layout-cell quarto-layout-cell-subref anchored" data-ref-parent="tbl-younger_older_separately_observed" style="flex-basis: 100.0%;justify-content: center;">
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<caption>(b) Older (45-65)</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">State</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">base</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">counterfactual</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Absolute Change</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Relative Change</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Employed</td>
<td style="text-align: right;">7227</td>
<td style="text-align: right;">7444</td>
<td style="text-align: right;">217</td>
<td style="text-align: left;">3% up</td>
</tr>
<tr class="even">
<td style="text-align: left;">Unemployed</td>
<td style="text-align: right;">383</td>
<td style="text-align: right;">329</td>
<td style="text-align: right;">-54</td>
<td style="text-align: left;">14.1% down</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Inactive student</td>
<td style="text-align: right;">17</td>
<td style="text-align: right;">19</td>
<td style="text-align: right;">2</td>
<td style="text-align: left;">11.8% up</td>
</tr>
<tr class="even">
<td style="text-align: left;">Inactive care</td>
<td style="text-align: right;">424</td>
<td style="text-align: right;">416</td>
<td style="text-align: right;">-8</td>
<td style="text-align: left;">1.9% down</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Inactive long term sick</td>
<td style="text-align: right;">590</td>
<td style="text-align: right;">417</td>
<td style="text-align: right;">-173</td>
<td style="text-align: left;">29.3% down</td>
</tr>
<tr class="even">
<td style="text-align: left;">Inactive retired</td>
<td style="text-align: right;">1389</td>
<td style="text-align: right;">1407</td>
<td style="text-align: right;">18</td>
<td style="text-align: left;">1.3% up</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Inactive other</td>
<td style="text-align: right;">64</td>
<td style="text-align: right;">61</td>
<td style="text-align: right;">-3</td>
<td style="text-align: left;">4.7% down</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">


</div>
</div>
</div>
</div>
<p>The key differences we observe are:</p>
<ul>
<li>For younger adults: greater reductions in unemployment</li>
<li>For older adults: greater relative increases in being an inactive student. But this is based on a much smaller baseline -probability of being in or moving to this state.</li>
<li>For older adults: a possibly higher relative effect on increasing employment. (As this is the largest state the absolute effect is important to note.)</li>
<li>Similar effects on the relative size of economic inactive long-term sick, but possibly a higher proportionate effect in younger adults (albeit from a smaller baseline than for older adults)</li>
<li>A signal of a small relative increase in early retirement in older adults as a result of improving health.</li>
<li>There is a larger relative and absolute difference in the estimated pool size of inactive care in younger adults than older adults.</li>
</ul>
</section>
<section id="differences-by-household-composition" class="level3">
<h3 class="anchored" data-anchor-id="differences-by-household-composition">Differences by household composition</h3>
<p>In order to model the effects of household composition, we need to extend the existing model to also incorporate household composition as predictor variables. This involves first taking the best-performing model of the effects of mental and physical health, and then adding to that household type as a predictor. We are especially interested in looking at households with children, and for this analysis only used observations of working age adults with children to build our model and test scenarios. We are interested, within these individuals with children, in the following household groups:</p>
<ul>
<li>Single parents</li>
<li>Couples with children</li>
<li>Other household types with children</li>
</ul>
<p>We start by determining whether adding information on these household types, for observations only of working age adults with children, leads to improvements in penalised model fit using AIC and BIC. The comparison of model fit is shown in <a href="#tbl-model_fit_ghq12_hhtype">Table&nbsp;11</a></p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>df_joined <span class="ot">&lt;-</span> </span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>  <span class="fu">add_hh_variables</span>(</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>    <span class="at">df =</span> ind_data_standardised,</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a>    <span class="at">varnames =</span> <span class="fu">c</span>(</span>
<span id="cb23-5"><a href="#cb23-5" aria-hidden="true" tabindex="-1"></a>      <span class="st">"hhtype_dv"</span></span>
<span id="cb23-6"><a href="#cb23-6" aria-hidden="true" tabindex="-1"></a>    ), </span>
<span id="cb23-7"><a href="#cb23-7" aria-hidden="true" tabindex="-1"></a>    <span class="at">vartypes =</span> <span class="fu">c</span>(</span>
<span id="cb23-8"><a href="#cb23-8" aria-hidden="true" tabindex="-1"></a>      <span class="st">"labels"</span></span>
<span id="cb23-9"><a href="#cb23-9" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb23-10"><a href="#cb23-10" aria-hidden="true" tabindex="-1"></a>  )</span>
<span id="cb23-11"><a href="#cb23-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-12"><a href="#cb23-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb23-13"><a href="#cb23-13" aria-hidden="true" tabindex="-1"></a>single_couple_parent_df <span class="ot">&lt;-</span> </span>
<span id="cb23-14"><a href="#cb23-14" aria-hidden="true" tabindex="-1"></a>df_joined <span class="sc">|&gt;</span> </span>
<span id="cb23-15"><a href="#cb23-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(</span>
<span id="cb23-16"><a href="#cb23-16" aria-hidden="true" tabindex="-1"></a>    simplified_household_lookup, </span>
<span id="cb23-17"><a href="#cb23-17" aria-hidden="true" tabindex="-1"></a>    <span class="at">by =</span> <span class="fu">c</span>(<span class="st">'hhtype_dv'</span> <span class="ot">=</span> <span class="st">'original'</span>)</span>
<span id="cb23-18"><a href="#cb23-18" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb23-19"><a href="#cb23-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(has_children <span class="sc">&amp;</span> <span class="sc">!</span><span class="fu">is.na</span>(has_children)) <span class="sc">|&gt;</span> </span>
<span id="cb23-20"><a href="#cb23-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb23-21"><a href="#cb23-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">simplified_category =</span> <span class="fu">case_when</span>(</span>
<span id="cb23-22"><a href="#cb23-22" aria-hidden="true" tabindex="-1"></a>      recoded <span class="sc">==</span> <span class="st">'Single Parent'</span>  <span class="sc">~</span> <span class="st">"Single Parent"</span>,</span>
<span id="cb23-23"><a href="#cb23-23" aria-hidden="true" tabindex="-1"></a>      recoded <span class="sc">%in%</span> <span class="fu">c</span>(<span class="st">"Family with 1-2 Children"</span>, <span class="st">"Family with 3 or more Children"</span>) <span class="sc">~</span> <span class="st">"Two Parent Household"</span>,</span>
<span id="cb23-24"><a href="#cb23-24" aria-hidden="true" tabindex="-1"></a>      <span class="cn">TRUE</span> <span class="sc">~</span> <span class="st">"Other HH with children"</span></span>
<span id="cb23-25"><a href="#cb23-25" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb23-26"><a href="#cb23-26" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb23-27"><a href="#cb23-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">select</span>(pidp, wave, age, sex, sf12mcs_dv, sf12pcs_dv, this_status, next_status, <span class="at">parent_hh_type =</span> simplified_category) <span class="sc">|&gt;</span> </span>
<span id="cb23-28"><a href="#cb23-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">parent_hh_type =</span> <span class="fu">factor</span>(parent_hh_type, <span class="at">levels =</span> <span class="fu">c</span>(<span class="st">"Two Parent Household"</span>, <span class="st">"Single Parent"</span>, <span class="st">"Other HH with children"</span>)))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
</div>
<p>Now build the model</p>
<p>compare the models</p>
<div class="cell">
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb24"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>aics <span class="ot">&lt;-</span> <span class="fu">AIC</span>(mod_00, mod_hhtype, mod_phmh_withchildrenonly, mod_hhtype_phmh, mod_hhtype_phmh_demointeraction, mod_hhtype_phmh_healthinteraction)</span>
<span id="cb24-2"><a href="#cb24-2" aria-hidden="true" tabindex="-1"></a>bics <span class="ot">&lt;-</span> <span class="fu">BIC</span>(mod_00, mod_hhtype, mod_phmh_withchildrenonly, mod_hhtype_phmh, mod_hhtype_phmh_demointeraction, mod_hhtype_phmh_healthinteraction)</span>
<span id="cb24-3"><a href="#cb24-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb24-4"><a href="#cb24-4" aria-hidden="true" tabindex="-1"></a>aics <span class="sc">|&gt;</span> </span>
<span id="cb24-5"><a href="#cb24-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">"model"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb24-6"><a href="#cb24-6" aria-hidden="true" tabindex="-1"></a>  <span class="fu">left_join</span>(</span>
<span id="cb24-7"><a href="#cb24-7" aria-hidden="true" tabindex="-1"></a>    bics <span class="sc">|&gt;</span> <span class="fu">rownames_to_column</span>(<span class="at">var=</span><span class="st">"model"</span>)    </span>
<span id="cb24-8"><a href="#cb24-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb24-9"><a href="#cb24-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb24-10"><a href="#cb24-10" aria-hidden="true" tabindex="-1"></a>    <span class="at">aic_rank =</span> <span class="fu">rank</span>(AIC),</span>
<span id="cb24-11"><a href="#cb24-11" aria-hidden="true" tabindex="-1"></a>    <span class="at">bic_rank =</span> <span class="fu">rank</span>(BIC)</span>
<span id="cb24-12"><a href="#cb24-12" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb24-13"><a href="#cb24-13" aria-hidden="true" tabindex="-1"></a>  knitr<span class="sc">::</span><span class="fu">kable</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div class="cell-output-display">
<div id="tbl-model_fit_ghq12_hhtype" class="anchored">
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<caption>Table&nbsp;11: AIC and BIC for different model specifications for including health and household type as an exposure for working age adults with children</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">model</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">df</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">AIC</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">BIC</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">aic_rank</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">bic_rank</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">mod_00</td>
<td style="text-align: right;">126</td>
<td style="text-align: right;">119299.8</td>
<td style="text-align: right;">120530.8</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">6</td>
</tr>
<tr class="even">
<td style="text-align: left;">mod_hhtype</td>
<td style="text-align: right;">138</td>
<td style="text-align: right;">118813.9</td>
<td style="text-align: right;">120162.2</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">5</td>
</tr>
<tr class="odd">
<td style="text-align: left;">mod_phmh_withchildrenonly</td>
<td style="text-align: right;">144</td>
<td style="text-align: right;">116766.5</td>
<td style="text-align: right;">118173.5</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">2</td>
</tr>
<tr class="even">
<td style="text-align: left;">mod_hhtype_phmh</td>
<td style="text-align: right;">156</td>
<td style="text-align: right;">116347.0</td>
<td style="text-align: right;">117871.1</td>
<td style="text-align: right;">2</td>
<td style="text-align: right;">1</td>
</tr>
<tr class="odd">
<td style="text-align: left;">mod_hhtype_phmh_demointeraction</td>
<td style="text-align: right;">312</td>
<td style="text-align: right;">115822.5</td>
<td style="text-align: right;">118870.9</td>
<td style="text-align: right;">1</td>
<td style="text-align: right;">4</td>
</tr>
<tr class="even">
<td style="text-align: left;">mod_hhtype_phmh_healthinteraction</td>
<td style="text-align: right;">192</td>
<td style="text-align: right;">116382.8</td>
<td style="text-align: right;">118258.7</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">3</td>
</tr>
</tbody>
</table>
</div>


</div>
</div>
<p>This confirms that adding household type information to the model, in addition to health, improved the performance.</p>
<p>We can now use this model specification to look at differences in the effects of the same change in health in economic (in)activity between couples with children and single parents. This is shown in <a href="#tbl-singleparent_coupleparent_modelled">Table&nbsp;12</a>.</p>
<div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>econ_cat_levels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Employed"</span>, <span class="st">"Unemployed"</span>, <span class="st">"Inactive student"</span>, <span class="st">"Inactive care"</span>, <span class="st">"Inactive long term sick"</span>, <span class="st">"Inactive retired"</span>, <span class="st">"Inactive other"</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>df_baseline_singleparent <span class="ot">&lt;-</span> </span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a>  single_couple_parent_df <span class="sc">|&gt;</span> </span>
<span id="cb25-5"><a href="#cb25-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb25-6"><a href="#cb25-6" aria-hidden="true" tabindex="-1"></a>    wave <span class="sc">==</span> <span class="st">"j"</span></span>
<span id="cb25-7"><a href="#cb25-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb25-8"><a href="#cb25-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">parent_hh_type =</span> <span class="st">"Single Parent"</span>)</span>
<span id="cb25-9"><a href="#cb25-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-10"><a href="#cb25-10" aria-hidden="true" tabindex="-1"></a>df_baseline_coupleparent <span class="ot">&lt;-</span> </span>
<span id="cb25-11"><a href="#cb25-11" aria-hidden="true" tabindex="-1"></a>  single_couple_parent_df <span class="sc">|&gt;</span> </span>
<span id="cb25-12"><a href="#cb25-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb25-13"><a href="#cb25-13" aria-hidden="true" tabindex="-1"></a>    wave <span class="sc">==</span> <span class="st">"j"</span></span>
<span id="cb25-14"><a href="#cb25-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb25-15"><a href="#cb25-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">parent_hh_type =</span> <span class="st">"Two Parent Household"</span>)</span>
<span id="cb25-16"><a href="#cb25-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-17"><a href="#cb25-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-18"><a href="#cb25-18" aria-hidden="true" tabindex="-1"></a>df_counter_singleparent <span class="ot">&lt;-</span></span>
<span id="cb25-19"><a href="#cb25-19" aria-hidden="true" tabindex="-1"></a>  df_baseline_singleparent <span class="sc">|&gt;</span> </span>
<span id="cb25-20"><a href="#cb25-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb25-21"><a href="#cb25-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">sf12mcs_dv =</span> sf12mcs_dv <span class="sc">+</span> <span class="dv">1</span> <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">5</span>),</span>
<span id="cb25-22"><a href="#cb25-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">sf12pcs_dv =</span> sf12pcs_dv <span class="sc">+</span> <span class="dv">2</span> <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">5</span>)</span>
<span id="cb25-23"><a href="#cb25-23" aria-hidden="true" tabindex="-1"></a>  )  </span>
<span id="cb25-24"><a href="#cb25-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-25"><a href="#cb25-25" aria-hidden="true" tabindex="-1"></a>df_counter_coupleparent <span class="ot">&lt;-</span></span>
<span id="cb25-26"><a href="#cb25-26" aria-hidden="true" tabindex="-1"></a>  df_baseline_coupleparent <span class="sc">|&gt;</span> </span>
<span id="cb25-27"><a href="#cb25-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb25-28"><a href="#cb25-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">sf12mcs_dv =</span> sf12mcs_dv <span class="sc">+</span> <span class="dv">1</span> <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">5</span>),</span>
<span id="cb25-29"><a href="#cb25-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">sf12pcs_dv =</span> sf12pcs_dv <span class="sc">+</span> <span class="dv">2</span> <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">5</span>)</span>
<span id="cb25-30"><a href="#cb25-30" aria-hidden="true" tabindex="-1"></a>  ) </span>
<span id="cb25-31"><a href="#cb25-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-32"><a href="#cb25-32" aria-hidden="true" tabindex="-1"></a>preds_df_base_single <span class="ot">&lt;-</span> </span>
<span id="cb25-33"><a href="#cb25-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predict</span>(mod_hhtype_phmh, <span class="at">newdata =</span> df_baseline_singleparent, <span class="at">type =</span> <span class="st">"probs"</span>)</span>
<span id="cb25-34"><a href="#cb25-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-35"><a href="#cb25-35" aria-hidden="true" tabindex="-1"></a>preds_df_base_couple <span class="ot">&lt;-</span> </span>
<span id="cb25-36"><a href="#cb25-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predict</span>(mod_hhtype_phmh, <span class="at">newdata =</span> df_baseline_coupleparent, <span class="at">type =</span> <span class="st">"probs"</span>)</span>
<span id="cb25-37"><a href="#cb25-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-38"><a href="#cb25-38" aria-hidden="true" tabindex="-1"></a>preds_df_counter_single <span class="ot">&lt;-</span> </span>
<span id="cb25-39"><a href="#cb25-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predict</span>(mod_hhtype_phmh, <span class="at">newdata =</span> df_counter_singleparent, <span class="at">type =</span> <span class="st">"probs"</span>)</span>
<span id="cb25-40"><a href="#cb25-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-41"><a href="#cb25-41" aria-hidden="true" tabindex="-1"></a>preds_df_counter_couple <span class="ot">&lt;-</span> </span>
<span id="cb25-42"><a href="#cb25-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predict</span>(mod_hhtype_phmh, <span class="at">newdata =</span> df_counter_coupleparent, <span class="at">type =</span> <span class="st">"probs"</span>)</span>
<span id="cb25-43"><a href="#cb25-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-44"><a href="#cb25-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-45"><a href="#cb25-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-46"><a href="#cb25-46" aria-hidden="true" tabindex="-1"></a>predictions_summary_matrix_single <span class="ot">&lt;-</span> <span class="fu">cbind</span>(</span>
<span id="cb25-47"><a href="#cb25-47" aria-hidden="true" tabindex="-1"></a>  <span class="co"># The number 2 indicates do the sum function for each column.</span></span>
<span id="cb25-48"><a href="#cb25-48" aria-hidden="true" tabindex="-1"></a>  <span class="co"># If it were 1 then this would sum for each row (which should add up to 1 in call cases)</span></span>
<span id="cb25-49"><a href="#cb25-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">apply</span>(preds_df_base_single, <span class="dv">2</span>, <span class="cf">function</span>(x) <span class="fu">round</span>(<span class="fu">sum</span>(x), <span class="dv">0</span>)),</span>
<span id="cb25-50"><a href="#cb25-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">apply</span>(preds_df_counter_single, <span class="dv">2</span>, <span class="cf">function</span>(x) <span class="fu">round</span>(<span class="fu">sum</span>(x), <span class="dv">0</span>))</span>
<span id="cb25-51"><a href="#cb25-51" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb25-52"><a href="#cb25-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-53"><a href="#cb25-53" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(predictions_summary_matrix_single) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"base"</span>, <span class="st">"counterfactual"</span>)</span>
<span id="cb25-54"><a href="#cb25-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-55"><a href="#cb25-55" aria-hidden="true" tabindex="-1"></a>tbl_mod_singleparent <span class="ot">&lt;-</span> </span>
<span id="cb25-56"><a href="#cb25-56" aria-hidden="true" tabindex="-1"></a>  predictions_summary_matrix_single <span class="sc">|&gt;</span> </span>
<span id="cb25-57"><a href="#cb25-57" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span> </span>
<span id="cb25-58"><a href="#cb25-58" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">"State"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb25-59"><a href="#cb25-59" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb25-60"><a href="#cb25-60" aria-hidden="true" tabindex="-1"></a>        <span class="at">State =</span> <span class="fu">factor</span>(</span>
<span id="cb25-61"><a href="#cb25-61" aria-hidden="true" tabindex="-1"></a>          State, </span>
<span id="cb25-62"><a href="#cb25-62" aria-hidden="true" tabindex="-1"></a>          <span class="at">ordered =</span> <span class="cn">TRUE</span>, </span>
<span id="cb25-63"><a href="#cb25-63" aria-hidden="true" tabindex="-1"></a>          <span class="at">levels =</span> econ_cat_levels</span>
<span id="cb25-64"><a href="#cb25-64" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb25-65"><a href="#cb25-65" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">|&gt;</span> </span>
<span id="cb25-66"><a href="#cb25-66" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(State) <span class="sc">|&gt;</span> </span>
<span id="cb25-67"><a href="#cb25-67" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb25-68"><a href="#cb25-68" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Absolute Change</span><span class="st">`</span> <span class="ot">=</span> counterfactual <span class="sc">-</span> base,</span>
<span id="cb25-69"><a href="#cb25-69" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Relative Change</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">Absolute Change</span><span class="st">`</span> <span class="sc">/</span> base</span>
<span id="cb25-70"><a href="#cb25-70" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb25-71"><a href="#cb25-71" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb25-72"><a href="#cb25-72" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Relative Change</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">ifelse</span>(</span>
<span id="cb25-73"><a href="#cb25-73" aria-hidden="true" tabindex="-1"></a>        <span class="st">`</span><span class="at">Relative Change</span><span class="st">`</span> <span class="sc">&gt;</span> <span class="dv">0</span>, </span>
<span id="cb25-74"><a href="#cb25-74" aria-hidden="true" tabindex="-1"></a>        glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">"{round(100 * `Relative Change`, 1)}% up"</span> ),</span>
<span id="cb25-75"><a href="#cb25-75" aria-hidden="true" tabindex="-1"></a>        glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">"{round(-100 * `Relative Change`, 1)}% down"</span>)</span>
<span id="cb25-76"><a href="#cb25-76" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb25-77"><a href="#cb25-77" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb25-78"><a href="#cb25-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-79"><a href="#cb25-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-80"><a href="#cb25-80" aria-hidden="true" tabindex="-1"></a>predictions_summary_matrix_couple <span class="ot">&lt;-</span> <span class="fu">cbind</span>(</span>
<span id="cb25-81"><a href="#cb25-81" aria-hidden="true" tabindex="-1"></a>  <span class="co"># The number 2 indicates do the sum function for each column.</span></span>
<span id="cb25-82"><a href="#cb25-82" aria-hidden="true" tabindex="-1"></a>  <span class="co"># If it were 1 then this would sum for each row (which should add up to 1 in call cases)</span></span>
<span id="cb25-83"><a href="#cb25-83" aria-hidden="true" tabindex="-1"></a>  <span class="fu">apply</span>(preds_df_base_couple, <span class="dv">2</span>, <span class="cf">function</span>(x) <span class="fu">round</span>(<span class="fu">sum</span>(x), <span class="dv">0</span>)),</span>
<span id="cb25-84"><a href="#cb25-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">apply</span>(preds_df_counter_couple, <span class="dv">2</span>, <span class="cf">function</span>(x) <span class="fu">round</span>(<span class="fu">sum</span>(x), <span class="dv">0</span>))</span>
<span id="cb25-85"><a href="#cb25-85" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb25-86"><a href="#cb25-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-87"><a href="#cb25-87" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(predictions_summary_matrix_couple) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"base"</span>, <span class="st">"counterfactual"</span>)</span>
<span id="cb25-88"><a href="#cb25-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-89"><a href="#cb25-89" aria-hidden="true" tabindex="-1"></a>tbl_mod_coupleparent <span class="ot">&lt;-</span> </span>
<span id="cb25-90"><a href="#cb25-90" aria-hidden="true" tabindex="-1"></a>  predictions_summary_matrix_couple <span class="sc">|&gt;</span> </span>
<span id="cb25-91"><a href="#cb25-91" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span> </span>
<span id="cb25-92"><a href="#cb25-92" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">"State"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb25-93"><a href="#cb25-93" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb25-94"><a href="#cb25-94" aria-hidden="true" tabindex="-1"></a>        <span class="at">State =</span> <span class="fu">factor</span>(</span>
<span id="cb25-95"><a href="#cb25-95" aria-hidden="true" tabindex="-1"></a>          State, </span>
<span id="cb25-96"><a href="#cb25-96" aria-hidden="true" tabindex="-1"></a>          <span class="at">ordered =</span> <span class="cn">TRUE</span>, </span>
<span id="cb25-97"><a href="#cb25-97" aria-hidden="true" tabindex="-1"></a>          <span class="at">levels =</span> econ_cat_levels</span>
<span id="cb25-98"><a href="#cb25-98" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb25-99"><a href="#cb25-99" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">|&gt;</span> </span>
<span id="cb25-100"><a href="#cb25-100" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(State) <span class="sc">|&gt;</span> </span>
<span id="cb25-101"><a href="#cb25-101" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb25-102"><a href="#cb25-102" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Absolute Change</span><span class="st">`</span> <span class="ot">=</span> counterfactual <span class="sc">-</span> base,</span>
<span id="cb25-103"><a href="#cb25-103" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Relative Change</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">Absolute Change</span><span class="st">`</span> <span class="sc">/</span> base</span>
<span id="cb25-104"><a href="#cb25-104" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb25-105"><a href="#cb25-105" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb25-106"><a href="#cb25-106" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Relative Change</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">ifelse</span>(</span>
<span id="cb25-107"><a href="#cb25-107" aria-hidden="true" tabindex="-1"></a>        <span class="st">`</span><span class="at">Relative Change</span><span class="st">`</span> <span class="sc">&gt;</span> <span class="dv">0</span>, </span>
<span id="cb25-108"><a href="#cb25-108" aria-hidden="true" tabindex="-1"></a>        glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">"{round(100 * `Relative Change`, 1)}% up"</span> ),</span>
<span id="cb25-109"><a href="#cb25-109" aria-hidden="true" tabindex="-1"></a>        glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">"{round(-100 * `Relative Change`, 1)}% down"</span>)</span>
<span id="cb25-110"><a href="#cb25-110" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb25-111"><a href="#cb25-111" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb25-112"><a href="#cb25-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-113"><a href="#cb25-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-114"><a href="#cb25-114" aria-hidden="true" tabindex="-1"></a>kbl_health_phbias_single <span class="ot">&lt;-</span> tbl_mod_singleparent <span class="sc">|&gt;</span> knitr<span class="sc">::</span><span class="fu">kable</span>()</span>
<span id="cb25-115"><a href="#cb25-115" aria-hidden="true" tabindex="-1"></a><span class="co"># save_kable(kbl_health, file = here::here("presentations/health_table.html"))</span></span>
<span id="cb25-116"><a href="#cb25-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-117"><a href="#cb25-117" aria-hidden="true" tabindex="-1"></a>kbl_health_phbias_couple <span class="ot">&lt;-</span> tbl_mod_coupleparent <span class="sc">|&gt;</span> knitr<span class="sc">::</span><span class="fu">kable</span>()</span>
<span id="cb25-118"><a href="#cb25-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb25-119"><a href="#cb25-119" aria-hidden="true" tabindex="-1"></a>kbl_health_phbias_single</span>
<span id="cb25-120"><a href="#cb25-120" aria-hidden="true" tabindex="-1"></a>kbl_health_phbias_couple</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="tbl-singleparent_coupleparent_modelled" class="cell tbl-parent quarto-layout-panel anchored">
<div class="panel-caption table-caption">
<p>Table&nbsp;12: Differences in the optimal health change by whether households with children have one or two parents</p>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div id="tbl-singleparent_coupleparent_modelled-1" class="quarto-layout-cell quarto-layout-cell-subref anchored" data-ref-parent="tbl-singleparent_coupleparent_modelled" style="flex-basis: 100.0%;justify-content: center;">
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<caption>(a) Single Parent</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">State</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">base</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">counterfactual</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Absolute Change</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Relative Change</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Employed</td>
<td style="text-align: right;">6614</td>
<td style="text-align: right;">6806</td>
<td style="text-align: right;">192</td>
<td style="text-align: left;">2.9% up</td>
</tr>
<tr class="even">
<td style="text-align: left;">Unemployed</td>
<td style="text-align: right;">605</td>
<td style="text-align: right;">478</td>
<td style="text-align: right;">-127</td>
<td style="text-align: left;">21% down</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Inactive student</td>
<td style="text-align: right;">856</td>
<td style="text-align: right;">918</td>
<td style="text-align: right;">62</td>
<td style="text-align: left;">7.2% up</td>
</tr>
<tr class="even">
<td style="text-align: left;">Inactive care</td>
<td style="text-align: right;">617</td>
<td style="text-align: right;">594</td>
<td style="text-align: right;">-23</td>
<td style="text-align: left;">3.7% down</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Inactive long term sick</td>
<td style="text-align: right;">254</td>
<td style="text-align: right;">156</td>
<td style="text-align: right;">-98</td>
<td style="text-align: left;">38.6% down</td>
</tr>
<tr class="even">
<td style="text-align: left;">Inactive retired</td>
<td style="text-align: right;">88</td>
<td style="text-align: right;">88</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">0% down</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Inactive other</td>
<td style="text-align: right;">49</td>
<td style="text-align: right;">42</td>
<td style="text-align: right;">-7</td>
<td style="text-align: left;">14.3% down</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">


</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div id="tbl-singleparent_coupleparent_modelled-2" class="quarto-layout-cell quarto-layout-cell-subref anchored" data-ref-parent="tbl-singleparent_coupleparent_modelled" style="flex-basis: 100.0%;justify-content: center;">
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<caption>(b) Couple Parent</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">State</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">base</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">counterfactual</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Absolute Change</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Relative Change</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Employed</td>
<td style="text-align: right;">6794</td>
<td style="text-align: right;">6952</td>
<td style="text-align: right;">158</td>
<td style="text-align: left;">2.3% up</td>
</tr>
<tr class="even">
<td style="text-align: left;">Unemployed</td>
<td style="text-align: right;">368</td>
<td style="text-align: right;">287</td>
<td style="text-align: right;">-81</td>
<td style="text-align: left;">22% down</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Inactive student</td>
<td style="text-align: right;">826</td>
<td style="text-align: right;">875</td>
<td style="text-align: right;">49</td>
<td style="text-align: left;">5.9% up</td>
</tr>
<tr class="even">
<td style="text-align: left;">Inactive care</td>
<td style="text-align: right;">751</td>
<td style="text-align: right;">713</td>
<td style="text-align: right;">-38</td>
<td style="text-align: left;">5.1% down</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Inactive long term sick</td>
<td style="text-align: right;">210</td>
<td style="text-align: right;">129</td>
<td style="text-align: right;">-81</td>
<td style="text-align: left;">38.6% down</td>
</tr>
<tr class="even">
<td style="text-align: left;">Inactive retired</td>
<td style="text-align: right;">84</td>
<td style="text-align: right;">84</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">0% down</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Inactive other</td>
<td style="text-align: right;">50</td>
<td style="text-align: right;">42</td>
<td style="text-align: right;">-8</td>
<td style="text-align: left;">16% down</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">


</div>
</div>
</div>
</div>
<p>In <a href="#tbl-singleparent_coupleparent_modelled">Table&nbsp;12</a>, we can see that…</p>
<div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb26"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>econ_cat_levels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Employed"</span>, <span class="st">"Unemployed"</span>, <span class="st">"Inactive student"</span>, <span class="st">"Inactive care"</span>, <span class="st">"Inactive long term sick"</span>, <span class="st">"Inactive retired"</span>, <span class="st">"Inactive other"</span>)</span>
<span id="cb26-2"><a href="#cb26-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-3"><a href="#cb26-3" aria-hidden="true" tabindex="-1"></a>df_baseline_singleparent <span class="ot">&lt;-</span> </span>
<span id="cb26-4"><a href="#cb26-4" aria-hidden="true" tabindex="-1"></a>  single_couple_parent_df <span class="sc">|&gt;</span> </span>
<span id="cb26-5"><a href="#cb26-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb26-6"><a href="#cb26-6" aria-hidden="true" tabindex="-1"></a>    wave <span class="sc">==</span> <span class="st">"j"</span></span>
<span id="cb26-7"><a href="#cb26-7" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb26-8"><a href="#cb26-8" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">parent_hh_type =</span> <span class="st">"Single Parent"</span>)</span>
<span id="cb26-9"><a href="#cb26-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-10"><a href="#cb26-10" aria-hidden="true" tabindex="-1"></a>df_baseline_coupleparent <span class="ot">&lt;-</span> </span>
<span id="cb26-11"><a href="#cb26-11" aria-hidden="true" tabindex="-1"></a>  single_couple_parent_df <span class="sc">|&gt;</span> </span>
<span id="cb26-12"><a href="#cb26-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb26-13"><a href="#cb26-13" aria-hidden="true" tabindex="-1"></a>    wave <span class="sc">==</span> <span class="st">"j"</span></span>
<span id="cb26-14"><a href="#cb26-14" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb26-15"><a href="#cb26-15" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(<span class="at">parent_hh_type =</span> <span class="st">"Two Parent Household"</span>)</span>
<span id="cb26-16"><a href="#cb26-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-17"><a href="#cb26-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-18"><a href="#cb26-18" aria-hidden="true" tabindex="-1"></a>df_counter_singleparent <span class="ot">&lt;-</span></span>
<span id="cb26-19"><a href="#cb26-19" aria-hidden="true" tabindex="-1"></a>  df_baseline_singleparent <span class="sc">|&gt;</span> </span>
<span id="cb26-20"><a href="#cb26-20" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb26-21"><a href="#cb26-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">sf12mcs_dv =</span> sf12mcs_dv <span class="sc">+</span> <span class="dv">1</span> <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">5</span>),</span>
<span id="cb26-22"><a href="#cb26-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">sf12pcs_dv =</span> sf12pcs_dv <span class="sc">+</span> <span class="dv">2</span> <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">5</span>)</span>
<span id="cb26-23"><a href="#cb26-23" aria-hidden="true" tabindex="-1"></a>  )  </span>
<span id="cb26-24"><a href="#cb26-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-25"><a href="#cb26-25" aria-hidden="true" tabindex="-1"></a>df_counter_coupleparent <span class="ot">&lt;-</span></span>
<span id="cb26-26"><a href="#cb26-26" aria-hidden="true" tabindex="-1"></a>  df_baseline_coupleparent <span class="sc">|&gt;</span> </span>
<span id="cb26-27"><a href="#cb26-27" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb26-28"><a href="#cb26-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">sf12mcs_dv =</span> sf12mcs_dv <span class="sc">+</span> <span class="dv">1</span> <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">5</span>),</span>
<span id="cb26-29"><a href="#cb26-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">sf12pcs_dv =</span> sf12pcs_dv <span class="sc">+</span> <span class="dv">2</span> <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">5</span>)</span>
<span id="cb26-30"><a href="#cb26-30" aria-hidden="true" tabindex="-1"></a>  ) </span>
<span id="cb26-31"><a href="#cb26-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-32"><a href="#cb26-32" aria-hidden="true" tabindex="-1"></a>preds_df_base_single <span class="ot">&lt;-</span> </span>
<span id="cb26-33"><a href="#cb26-33" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predict</span>(mod_hhtype_phmh_demointeraction, <span class="at">newdata =</span> df_baseline_singleparent, <span class="at">type =</span> <span class="st">"probs"</span>)</span>
<span id="cb26-34"><a href="#cb26-34" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-35"><a href="#cb26-35" aria-hidden="true" tabindex="-1"></a>preds_df_base_couple <span class="ot">&lt;-</span> </span>
<span id="cb26-36"><a href="#cb26-36" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predict</span>(mod_hhtype_phmh_demointeraction, <span class="at">newdata =</span> df_baseline_coupleparent, <span class="at">type =</span> <span class="st">"probs"</span>)</span>
<span id="cb26-37"><a href="#cb26-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-38"><a href="#cb26-38" aria-hidden="true" tabindex="-1"></a>preds_df_counter_single <span class="ot">&lt;-</span> </span>
<span id="cb26-39"><a href="#cb26-39" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predict</span>(mod_hhtype_phmh_demointeraction, <span class="at">newdata =</span> df_counter_singleparent, <span class="at">type =</span> <span class="st">"probs"</span>)</span>
<span id="cb26-40"><a href="#cb26-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-41"><a href="#cb26-41" aria-hidden="true" tabindex="-1"></a>preds_df_counter_couple <span class="ot">&lt;-</span> </span>
<span id="cb26-42"><a href="#cb26-42" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predict</span>(mod_hhtype_phmh_demointeraction, <span class="at">newdata =</span> df_counter_coupleparent, <span class="at">type =</span> <span class="st">"probs"</span>)</span>
<span id="cb26-43"><a href="#cb26-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-44"><a href="#cb26-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-45"><a href="#cb26-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-46"><a href="#cb26-46" aria-hidden="true" tabindex="-1"></a>predictions_summary_matrix_single <span class="ot">&lt;-</span> <span class="fu">cbind</span>(</span>
<span id="cb26-47"><a href="#cb26-47" aria-hidden="true" tabindex="-1"></a>  <span class="co"># The number 2 indicates do the sum function for each column.</span></span>
<span id="cb26-48"><a href="#cb26-48" aria-hidden="true" tabindex="-1"></a>  <span class="co"># If it were 1 then this would sum for each row (which should add up to 1 in call cases)</span></span>
<span id="cb26-49"><a href="#cb26-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">apply</span>(preds_df_base_single, <span class="dv">2</span>, <span class="cf">function</span>(x) <span class="fu">round</span>(<span class="fu">sum</span>(x), <span class="dv">0</span>)),</span>
<span id="cb26-50"><a href="#cb26-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">apply</span>(preds_df_counter_single, <span class="dv">2</span>, <span class="cf">function</span>(x) <span class="fu">round</span>(<span class="fu">sum</span>(x), <span class="dv">0</span>))</span>
<span id="cb26-51"><a href="#cb26-51" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb26-52"><a href="#cb26-52" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-53"><a href="#cb26-53" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(predictions_summary_matrix_single) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"base"</span>, <span class="st">"counterfactual"</span>)</span>
<span id="cb26-54"><a href="#cb26-54" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-55"><a href="#cb26-55" aria-hidden="true" tabindex="-1"></a>tbl_mod_singleparent <span class="ot">&lt;-</span> </span>
<span id="cb26-56"><a href="#cb26-56" aria-hidden="true" tabindex="-1"></a>  predictions_summary_matrix_single <span class="sc">|&gt;</span> </span>
<span id="cb26-57"><a href="#cb26-57" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span> </span>
<span id="cb26-58"><a href="#cb26-58" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">"State"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb26-59"><a href="#cb26-59" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb26-60"><a href="#cb26-60" aria-hidden="true" tabindex="-1"></a>        <span class="at">State =</span> <span class="fu">factor</span>(</span>
<span id="cb26-61"><a href="#cb26-61" aria-hidden="true" tabindex="-1"></a>          State, </span>
<span id="cb26-62"><a href="#cb26-62" aria-hidden="true" tabindex="-1"></a>          <span class="at">ordered =</span> <span class="cn">TRUE</span>, </span>
<span id="cb26-63"><a href="#cb26-63" aria-hidden="true" tabindex="-1"></a>          <span class="at">levels =</span> econ_cat_levels</span>
<span id="cb26-64"><a href="#cb26-64" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb26-65"><a href="#cb26-65" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">|&gt;</span> </span>
<span id="cb26-66"><a href="#cb26-66" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(State) <span class="sc">|&gt;</span> </span>
<span id="cb26-67"><a href="#cb26-67" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb26-68"><a href="#cb26-68" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Absolute Change</span><span class="st">`</span> <span class="ot">=</span> counterfactual <span class="sc">-</span> base,</span>
<span id="cb26-69"><a href="#cb26-69" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Relative Change</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">Absolute Change</span><span class="st">`</span> <span class="sc">/</span> base</span>
<span id="cb26-70"><a href="#cb26-70" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb26-71"><a href="#cb26-71" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb26-72"><a href="#cb26-72" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Relative Change</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">ifelse</span>(</span>
<span id="cb26-73"><a href="#cb26-73" aria-hidden="true" tabindex="-1"></a>        <span class="st">`</span><span class="at">Relative Change</span><span class="st">`</span> <span class="sc">&gt;</span> <span class="dv">0</span>, </span>
<span id="cb26-74"><a href="#cb26-74" aria-hidden="true" tabindex="-1"></a>        glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">"{round(100 * `Relative Change`, 1)}% up"</span> ),</span>
<span id="cb26-75"><a href="#cb26-75" aria-hidden="true" tabindex="-1"></a>        glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">"{round(-100 * `Relative Change`, 1)}% down"</span>)</span>
<span id="cb26-76"><a href="#cb26-76" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb26-77"><a href="#cb26-77" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb26-78"><a href="#cb26-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-79"><a href="#cb26-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-80"><a href="#cb26-80" aria-hidden="true" tabindex="-1"></a>predictions_summary_matrix_couple <span class="ot">&lt;-</span> <span class="fu">cbind</span>(</span>
<span id="cb26-81"><a href="#cb26-81" aria-hidden="true" tabindex="-1"></a>  <span class="co"># The number 2 indicates do the sum function for each column.</span></span>
<span id="cb26-82"><a href="#cb26-82" aria-hidden="true" tabindex="-1"></a>  <span class="co"># If it were 1 then this would sum for each row (which should add up to 1 in call cases)</span></span>
<span id="cb26-83"><a href="#cb26-83" aria-hidden="true" tabindex="-1"></a>  <span class="fu">apply</span>(preds_df_base_couple, <span class="dv">2</span>, <span class="cf">function</span>(x) <span class="fu">round</span>(<span class="fu">sum</span>(x), <span class="dv">0</span>)),</span>
<span id="cb26-84"><a href="#cb26-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">apply</span>(preds_df_counter_couple, <span class="dv">2</span>, <span class="cf">function</span>(x) <span class="fu">round</span>(<span class="fu">sum</span>(x), <span class="dv">0</span>))</span>
<span id="cb26-85"><a href="#cb26-85" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb26-86"><a href="#cb26-86" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-87"><a href="#cb26-87" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(predictions_summary_matrix_couple) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"base"</span>, <span class="st">"counterfactual"</span>)</span>
<span id="cb26-88"><a href="#cb26-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-89"><a href="#cb26-89" aria-hidden="true" tabindex="-1"></a>tbl_mod_coupleparent <span class="ot">&lt;-</span> </span>
<span id="cb26-90"><a href="#cb26-90" aria-hidden="true" tabindex="-1"></a>  predictions_summary_matrix_couple <span class="sc">|&gt;</span> </span>
<span id="cb26-91"><a href="#cb26-91" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span> </span>
<span id="cb26-92"><a href="#cb26-92" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">"State"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb26-93"><a href="#cb26-93" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb26-94"><a href="#cb26-94" aria-hidden="true" tabindex="-1"></a>        <span class="at">State =</span> <span class="fu">factor</span>(</span>
<span id="cb26-95"><a href="#cb26-95" aria-hidden="true" tabindex="-1"></a>          State, </span>
<span id="cb26-96"><a href="#cb26-96" aria-hidden="true" tabindex="-1"></a>          <span class="at">ordered =</span> <span class="cn">TRUE</span>, </span>
<span id="cb26-97"><a href="#cb26-97" aria-hidden="true" tabindex="-1"></a>          <span class="at">levels =</span> econ_cat_levels</span>
<span id="cb26-98"><a href="#cb26-98" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb26-99"><a href="#cb26-99" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">|&gt;</span> </span>
<span id="cb26-100"><a href="#cb26-100" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(State) <span class="sc">|&gt;</span> </span>
<span id="cb26-101"><a href="#cb26-101" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb26-102"><a href="#cb26-102" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Absolute Change</span><span class="st">`</span> <span class="ot">=</span> counterfactual <span class="sc">-</span> base,</span>
<span id="cb26-103"><a href="#cb26-103" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Relative Change</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">Absolute Change</span><span class="st">`</span> <span class="sc">/</span> base</span>
<span id="cb26-104"><a href="#cb26-104" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb26-105"><a href="#cb26-105" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb26-106"><a href="#cb26-106" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Relative Change</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">ifelse</span>(</span>
<span id="cb26-107"><a href="#cb26-107" aria-hidden="true" tabindex="-1"></a>        <span class="st">`</span><span class="at">Relative Change</span><span class="st">`</span> <span class="sc">&gt;</span> <span class="dv">0</span>, </span>
<span id="cb26-108"><a href="#cb26-108" aria-hidden="true" tabindex="-1"></a>        glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">"{round(100 * `Relative Change`, 1)}% up"</span> ),</span>
<span id="cb26-109"><a href="#cb26-109" aria-hidden="true" tabindex="-1"></a>        glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">"{round(-100 * `Relative Change`, 1)}% down"</span>)</span>
<span id="cb26-110"><a href="#cb26-110" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb26-111"><a href="#cb26-111" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb26-112"><a href="#cb26-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-113"><a href="#cb26-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-114"><a href="#cb26-114" aria-hidden="true" tabindex="-1"></a>kbl_health_phbias_single <span class="ot">&lt;-</span> tbl_mod_singleparent <span class="sc">|&gt;</span> knitr<span class="sc">::</span><span class="fu">kable</span>()</span>
<span id="cb26-115"><a href="#cb26-115" aria-hidden="true" tabindex="-1"></a><span class="co"># save_kable(kbl_health, file = here::here("presentations/health_table.html"))</span></span>
<span id="cb26-116"><a href="#cb26-116" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-117"><a href="#cb26-117" aria-hidden="true" tabindex="-1"></a>kbl_health_phbias_couple <span class="ot">&lt;-</span> tbl_mod_coupleparent <span class="sc">|&gt;</span> knitr<span class="sc">::</span><span class="fu">kable</span>()</span>
<span id="cb26-118"><a href="#cb26-118" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb26-119"><a href="#cb26-119" aria-hidden="true" tabindex="-1"></a>kbl_health_phbias_single</span>
<span id="cb26-120"><a href="#cb26-120" aria-hidden="true" tabindex="-1"></a>kbl_health_phbias_couple</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="tbl-singleparent_coupleparent_modelled_demoint" class="cell tbl-parent quarto-layout-panel anchored">
<div class="panel-caption table-caption">
<p>Table&nbsp;13: Differences in the optimal health change by whether households with children have one or two parents (with additional demographic interaction)</p>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div id="tbl-singleparent_coupleparent_modelled_demoint-1" class="quarto-layout-cell quarto-layout-cell-subref anchored" data-ref-parent="tbl-singleparent_coupleparent_modelled_demoint" style="flex-basis: 100.0%;justify-content: center;">
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<caption>(a) Single Parent</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">State</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">base</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">counterfactual</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Absolute Change</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Relative Change</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Employed</td>
<td style="text-align: right;">6553</td>
<td style="text-align: right;">6762</td>
<td style="text-align: right;">209</td>
<td style="text-align: left;">3.2% up</td>
</tr>
<tr class="even">
<td style="text-align: left;">Unemployed</td>
<td style="text-align: right;">654</td>
<td style="text-align: right;">510</td>
<td style="text-align: right;">-144</td>
<td style="text-align: left;">22% down</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Inactive student</td>
<td style="text-align: right;">843</td>
<td style="text-align: right;">907</td>
<td style="text-align: right;">64</td>
<td style="text-align: left;">7.6% up</td>
</tr>
<tr class="even">
<td style="text-align: left;">Inactive care</td>
<td style="text-align: right;">623</td>
<td style="text-align: right;">607</td>
<td style="text-align: right;">-16</td>
<td style="text-align: left;">2.6% down</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Inactive long term sick</td>
<td style="text-align: right;">267</td>
<td style="text-align: right;">163</td>
<td style="text-align: right;">-104</td>
<td style="text-align: left;">39% down</td>
</tr>
<tr class="even">
<td style="text-align: left;">Inactive retired</td>
<td style="text-align: right;">97</td>
<td style="text-align: right;">95</td>
<td style="text-align: right;">-2</td>
<td style="text-align: left;">2.1% down</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Inactive other</td>
<td style="text-align: right;">45</td>
<td style="text-align: right;">39</td>
<td style="text-align: right;">-6</td>
<td style="text-align: left;">13.3% down</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">


</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div id="tbl-singleparent_coupleparent_modelled_demoint-2" class="quarto-layout-cell quarto-layout-cell-subref anchored" data-ref-parent="tbl-singleparent_coupleparent_modelled_demoint" style="flex-basis: 100.0%;justify-content: center;">
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<caption>(b) Couple Parent</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">State</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">base</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">counterfactual</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Absolute Change</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Relative Change</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Employed</td>
<td style="text-align: right;">6785</td>
<td style="text-align: right;">6947</td>
<td style="text-align: right;">162</td>
<td style="text-align: left;">2.4% up</td>
</tr>
<tr class="even">
<td style="text-align: left;">Unemployed</td>
<td style="text-align: right;">367</td>
<td style="text-align: right;">286</td>
<td style="text-align: right;">-81</td>
<td style="text-align: left;">22.1% down</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Inactive student</td>
<td style="text-align: right;">829</td>
<td style="text-align: right;">881</td>
<td style="text-align: right;">52</td>
<td style="text-align: left;">6.3% up</td>
</tr>
<tr class="even">
<td style="text-align: left;">Inactive care</td>
<td style="text-align: right;">756</td>
<td style="text-align: right;">713</td>
<td style="text-align: right;">-43</td>
<td style="text-align: left;">5.7% down</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Inactive long term sick</td>
<td style="text-align: right;">211</td>
<td style="text-align: right;">130</td>
<td style="text-align: right;">-81</td>
<td style="text-align: left;">38.4% down</td>
</tr>
<tr class="even">
<td style="text-align: left;">Inactive retired</td>
<td style="text-align: right;">83</td>
<td style="text-align: right;">83</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">0% down</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Inactive other</td>
<td style="text-align: right;">52</td>
<td style="text-align: right;">44</td>
<td style="text-align: right;">-8</td>
<td style="text-align: left;">15.4% down</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">


</div>
</div>
</div>
</div>
<p>The model with demographic interaction effects shows more difference in terms of the effect of the health change than the model without such interaction effects. In particular a larger effect on the relative size of the inactice care pool is predicted for parents in a couple than single parents. Also a larger difference in the relative size of the employed population is predicted for single parents than couples. However, the change in the relative size of inactive long-term sick, and unemployment, is similar even with this more complex model specification.</p>
<hr>
<p>The other approach is to only look at the observed values</p>
<div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>econ_cat_levels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Employed"</span>, <span class="st">"Unemployed"</span>, <span class="st">"Inactive student"</span>, <span class="st">"Inactive care"</span>, <span class="st">"Inactive long term sick"</span>, <span class="st">"Inactive retired"</span>, <span class="st">"Inactive other"</span>)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>df_baseline_singleparent <span class="ot">&lt;-</span> </span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>  single_couple_parent_df <span class="sc">|&gt;</span> </span>
<span id="cb27-5"><a href="#cb27-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb27-6"><a href="#cb27-6" aria-hidden="true" tabindex="-1"></a>    wave <span class="sc">==</span> <span class="st">"j"</span>,</span>
<span id="cb27-7"><a href="#cb27-7" aria-hidden="true" tabindex="-1"></a>    parent_hh_type <span class="sc">==</span> <span class="st">"Single Parent"</span></span>
<span id="cb27-8"><a href="#cb27-8" aria-hidden="true" tabindex="-1"></a>  ) </span>
<span id="cb27-9"><a href="#cb27-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-10"><a href="#cb27-10" aria-hidden="true" tabindex="-1"></a>df_baseline_coupleparent <span class="ot">&lt;-</span> </span>
<span id="cb27-11"><a href="#cb27-11" aria-hidden="true" tabindex="-1"></a>  single_couple_parent_df <span class="sc">|&gt;</span> </span>
<span id="cb27-12"><a href="#cb27-12" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb27-13"><a href="#cb27-13" aria-hidden="true" tabindex="-1"></a>    wave <span class="sc">==</span> <span class="st">"j"</span>,</span>
<span id="cb27-14"><a href="#cb27-14" aria-hidden="true" tabindex="-1"></a>    parent_hh_type <span class="sc">==</span> <span class="st">"Two Parent Household"</span></span>
<span id="cb27-15"><a href="#cb27-15" aria-hidden="true" tabindex="-1"></a>  ) </span>
<span id="cb27-16"><a href="#cb27-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-17"><a href="#cb27-17" aria-hidden="true" tabindex="-1"></a>df_counter_singleparent <span class="ot">&lt;-</span></span>
<span id="cb27-18"><a href="#cb27-18" aria-hidden="true" tabindex="-1"></a>  df_baseline_singleparent <span class="sc">|&gt;</span> </span>
<span id="cb27-19"><a href="#cb27-19" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb27-20"><a href="#cb27-20" aria-hidden="true" tabindex="-1"></a>    <span class="at">sf12mcs_dv =</span> sf12mcs_dv <span class="sc">+</span> <span class="dv">1</span> <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">5</span>),</span>
<span id="cb27-21"><a href="#cb27-21" aria-hidden="true" tabindex="-1"></a>    <span class="at">sf12pcs_dv =</span> sf12pcs_dv <span class="sc">+</span> <span class="dv">2</span> <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">5</span>)</span>
<span id="cb27-22"><a href="#cb27-22" aria-hidden="true" tabindex="-1"></a>  )  </span>
<span id="cb27-23"><a href="#cb27-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-24"><a href="#cb27-24" aria-hidden="true" tabindex="-1"></a>df_counter_coupleparent <span class="ot">&lt;-</span></span>
<span id="cb27-25"><a href="#cb27-25" aria-hidden="true" tabindex="-1"></a>  df_baseline_coupleparent <span class="sc">|&gt;</span> </span>
<span id="cb27-26"><a href="#cb27-26" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb27-27"><a href="#cb27-27" aria-hidden="true" tabindex="-1"></a>    <span class="at">sf12mcs_dv =</span> sf12mcs_dv <span class="sc">+</span> <span class="dv">1</span> <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">5</span>),</span>
<span id="cb27-28"><a href="#cb27-28" aria-hidden="true" tabindex="-1"></a>    <span class="at">sf12pcs_dv =</span> sf12pcs_dv <span class="sc">+</span> <span class="dv">2</span> <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">5</span>)</span>
<span id="cb27-29"><a href="#cb27-29" aria-hidden="true" tabindex="-1"></a>  ) </span>
<span id="cb27-30"><a href="#cb27-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-31"><a href="#cb27-31" aria-hidden="true" tabindex="-1"></a>preds_df_base_single <span class="ot">&lt;-</span> </span>
<span id="cb27-32"><a href="#cb27-32" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predict</span>(mod_hhtype_phmh, <span class="at">newdata =</span> df_baseline_singleparent, <span class="at">type =</span> <span class="st">"probs"</span>)</span>
<span id="cb27-33"><a href="#cb27-33" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-34"><a href="#cb27-34" aria-hidden="true" tabindex="-1"></a>preds_df_base_couple <span class="ot">&lt;-</span> </span>
<span id="cb27-35"><a href="#cb27-35" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predict</span>(mod_hhtype_phmh, <span class="at">newdata =</span> df_baseline_coupleparent, <span class="at">type =</span> <span class="st">"probs"</span>)</span>
<span id="cb27-36"><a href="#cb27-36" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-37"><a href="#cb27-37" aria-hidden="true" tabindex="-1"></a>preds_df_counter_single <span class="ot">&lt;-</span> </span>
<span id="cb27-38"><a href="#cb27-38" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predict</span>(mod_hhtype_phmh, <span class="at">newdata =</span> df_counter_singleparent, <span class="at">type =</span> <span class="st">"probs"</span>)</span>
<span id="cb27-39"><a href="#cb27-39" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-40"><a href="#cb27-40" aria-hidden="true" tabindex="-1"></a>preds_df_counter_couple <span class="ot">&lt;-</span> </span>
<span id="cb27-41"><a href="#cb27-41" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predict</span>(mod_hhtype_phmh, <span class="at">newdata =</span> df_counter_coupleparent, <span class="at">type =</span> <span class="st">"probs"</span>)</span>
<span id="cb27-42"><a href="#cb27-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-43"><a href="#cb27-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-44"><a href="#cb27-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-45"><a href="#cb27-45" aria-hidden="true" tabindex="-1"></a>predictions_summary_matrix_single <span class="ot">&lt;-</span> <span class="fu">cbind</span>(</span>
<span id="cb27-46"><a href="#cb27-46" aria-hidden="true" tabindex="-1"></a>  <span class="co"># The number 2 indicates do the sum function for each column.</span></span>
<span id="cb27-47"><a href="#cb27-47" aria-hidden="true" tabindex="-1"></a>  <span class="co"># If it were 1 then this would sum for each row (which should add up to 1 in call cases)</span></span>
<span id="cb27-48"><a href="#cb27-48" aria-hidden="true" tabindex="-1"></a>  <span class="fu">apply</span>(preds_df_base_single, <span class="dv">2</span>, <span class="cf">function</span>(x) <span class="fu">round</span>(<span class="fu">sum</span>(x), <span class="dv">0</span>)),</span>
<span id="cb27-49"><a href="#cb27-49" aria-hidden="true" tabindex="-1"></a>  <span class="fu">apply</span>(preds_df_counter_single, <span class="dv">2</span>, <span class="cf">function</span>(x) <span class="fu">round</span>(<span class="fu">sum</span>(x), <span class="dv">0</span>))</span>
<span id="cb27-50"><a href="#cb27-50" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb27-51"><a href="#cb27-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-52"><a href="#cb27-52" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(predictions_summary_matrix_single) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"base"</span>, <span class="st">"counterfactual"</span>)</span>
<span id="cb27-53"><a href="#cb27-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-54"><a href="#cb27-54" aria-hidden="true" tabindex="-1"></a>tbl_mod_singleparent <span class="ot">&lt;-</span> </span>
<span id="cb27-55"><a href="#cb27-55" aria-hidden="true" tabindex="-1"></a>  predictions_summary_matrix_single <span class="sc">|&gt;</span> </span>
<span id="cb27-56"><a href="#cb27-56" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span> </span>
<span id="cb27-57"><a href="#cb27-57" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">"State"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb27-58"><a href="#cb27-58" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb27-59"><a href="#cb27-59" aria-hidden="true" tabindex="-1"></a>        <span class="at">State =</span> <span class="fu">factor</span>(</span>
<span id="cb27-60"><a href="#cb27-60" aria-hidden="true" tabindex="-1"></a>          State, </span>
<span id="cb27-61"><a href="#cb27-61" aria-hidden="true" tabindex="-1"></a>          <span class="at">ordered =</span> <span class="cn">TRUE</span>, </span>
<span id="cb27-62"><a href="#cb27-62" aria-hidden="true" tabindex="-1"></a>          <span class="at">levels =</span> econ_cat_levels</span>
<span id="cb27-63"><a href="#cb27-63" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb27-64"><a href="#cb27-64" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">|&gt;</span> </span>
<span id="cb27-65"><a href="#cb27-65" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(State) <span class="sc">|&gt;</span> </span>
<span id="cb27-66"><a href="#cb27-66" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb27-67"><a href="#cb27-67" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Absolute Change</span><span class="st">`</span> <span class="ot">=</span> counterfactual <span class="sc">-</span> base,</span>
<span id="cb27-68"><a href="#cb27-68" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Relative Change</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">Absolute Change</span><span class="st">`</span> <span class="sc">/</span> base</span>
<span id="cb27-69"><a href="#cb27-69" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb27-70"><a href="#cb27-70" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb27-71"><a href="#cb27-71" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Relative Change</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">ifelse</span>(</span>
<span id="cb27-72"><a href="#cb27-72" aria-hidden="true" tabindex="-1"></a>        <span class="st">`</span><span class="at">Relative Change</span><span class="st">`</span> <span class="sc">&gt;</span> <span class="dv">0</span>, </span>
<span id="cb27-73"><a href="#cb27-73" aria-hidden="true" tabindex="-1"></a>        glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">"{round(100 * `Relative Change`, 1)}% up"</span> ),</span>
<span id="cb27-74"><a href="#cb27-74" aria-hidden="true" tabindex="-1"></a>        glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">"{round(-100 * `Relative Change`, 1)}% down"</span>)</span>
<span id="cb27-75"><a href="#cb27-75" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb27-76"><a href="#cb27-76" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb27-77"><a href="#cb27-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-78"><a href="#cb27-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-79"><a href="#cb27-79" aria-hidden="true" tabindex="-1"></a>predictions_summary_matrix_couple <span class="ot">&lt;-</span> <span class="fu">cbind</span>(</span>
<span id="cb27-80"><a href="#cb27-80" aria-hidden="true" tabindex="-1"></a>  <span class="co"># The number 2 indicates do the sum function for each column.</span></span>
<span id="cb27-81"><a href="#cb27-81" aria-hidden="true" tabindex="-1"></a>  <span class="co"># If it were 1 then this would sum for each row (which should add up to 1 in call cases)</span></span>
<span id="cb27-82"><a href="#cb27-82" aria-hidden="true" tabindex="-1"></a>  <span class="fu">apply</span>(preds_df_base_couple, <span class="dv">2</span>, <span class="cf">function</span>(x) <span class="fu">round</span>(<span class="fu">sum</span>(x), <span class="dv">0</span>)),</span>
<span id="cb27-83"><a href="#cb27-83" aria-hidden="true" tabindex="-1"></a>  <span class="fu">apply</span>(preds_df_counter_couple, <span class="dv">2</span>, <span class="cf">function</span>(x) <span class="fu">round</span>(<span class="fu">sum</span>(x), <span class="dv">0</span>))</span>
<span id="cb27-84"><a href="#cb27-84" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb27-85"><a href="#cb27-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-86"><a href="#cb27-86" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(predictions_summary_matrix_couple) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"base"</span>, <span class="st">"counterfactual"</span>)</span>
<span id="cb27-87"><a href="#cb27-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-88"><a href="#cb27-88" aria-hidden="true" tabindex="-1"></a>tbl_mod_coupleparent <span class="ot">&lt;-</span> </span>
<span id="cb27-89"><a href="#cb27-89" aria-hidden="true" tabindex="-1"></a>  predictions_summary_matrix_couple <span class="sc">|&gt;</span> </span>
<span id="cb27-90"><a href="#cb27-90" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span> </span>
<span id="cb27-91"><a href="#cb27-91" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">"State"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb27-92"><a href="#cb27-92" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb27-93"><a href="#cb27-93" aria-hidden="true" tabindex="-1"></a>        <span class="at">State =</span> <span class="fu">factor</span>(</span>
<span id="cb27-94"><a href="#cb27-94" aria-hidden="true" tabindex="-1"></a>          State, </span>
<span id="cb27-95"><a href="#cb27-95" aria-hidden="true" tabindex="-1"></a>          <span class="at">ordered =</span> <span class="cn">TRUE</span>, </span>
<span id="cb27-96"><a href="#cb27-96" aria-hidden="true" tabindex="-1"></a>          <span class="at">levels =</span> econ_cat_levels</span>
<span id="cb27-97"><a href="#cb27-97" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb27-98"><a href="#cb27-98" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">|&gt;</span> </span>
<span id="cb27-99"><a href="#cb27-99" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(State) <span class="sc">|&gt;</span> </span>
<span id="cb27-100"><a href="#cb27-100" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb27-101"><a href="#cb27-101" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Absolute Change</span><span class="st">`</span> <span class="ot">=</span> counterfactual <span class="sc">-</span> base,</span>
<span id="cb27-102"><a href="#cb27-102" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Relative Change</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">Absolute Change</span><span class="st">`</span> <span class="sc">/</span> base</span>
<span id="cb27-103"><a href="#cb27-103" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb27-104"><a href="#cb27-104" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb27-105"><a href="#cb27-105" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Relative Change</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">ifelse</span>(</span>
<span id="cb27-106"><a href="#cb27-106" aria-hidden="true" tabindex="-1"></a>        <span class="st">`</span><span class="at">Relative Change</span><span class="st">`</span> <span class="sc">&gt;</span> <span class="dv">0</span>, </span>
<span id="cb27-107"><a href="#cb27-107" aria-hidden="true" tabindex="-1"></a>        glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">"{round(100 * `Relative Change`, 1)}% up"</span> ),</span>
<span id="cb27-108"><a href="#cb27-108" aria-hidden="true" tabindex="-1"></a>        glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">"{round(-100 * `Relative Change`, 1)}% down"</span>)</span>
<span id="cb27-109"><a href="#cb27-109" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb27-110"><a href="#cb27-110" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb27-111"><a href="#cb27-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-112"><a href="#cb27-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-113"><a href="#cb27-113" aria-hidden="true" tabindex="-1"></a>kbl_health_phbias_single <span class="ot">&lt;-</span> tbl_mod_singleparent <span class="sc">|&gt;</span> knitr<span class="sc">::</span><span class="fu">kable</span>()</span>
<span id="cb27-114"><a href="#cb27-114" aria-hidden="true" tabindex="-1"></a><span class="co"># save_kable(kbl_health, file = here::here("presentations/health_table.html"))</span></span>
<span id="cb27-115"><a href="#cb27-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-116"><a href="#cb27-116" aria-hidden="true" tabindex="-1"></a>kbl_health_phbias_couple <span class="ot">&lt;-</span> tbl_mod_coupleparent <span class="sc">|&gt;</span> knitr<span class="sc">::</span><span class="fu">kable</span>()</span>
<span id="cb27-117"><a href="#cb27-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb27-118"><a href="#cb27-118" aria-hidden="true" tabindex="-1"></a>kbl_health_phbias_single</span>
<span id="cb27-119"><a href="#cb27-119" aria-hidden="true" tabindex="-1"></a>kbl_health_phbias_couple</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="tbl-singleparent_coupleparent_observed" class="cell tbl-parent quarto-layout-panel anchored">
<div class="panel-caption table-caption">
<p>Table&nbsp;14: Differences in the optimal health change by whether households with children have one or two parents (observed values</p>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div id="tbl-singleparent_coupleparent_observed-1" class="quarto-layout-cell quarto-layout-cell-subref anchored" data-ref-parent="tbl-singleparent_coupleparent_observed" style="flex-basis: 100.0%;justify-content: center;">
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<caption>(a) Single Parent</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">State</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">base</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">counterfactual</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Absolute Change</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Relative Change</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Employed</td>
<td style="text-align: right;">442</td>
<td style="text-align: right;">462</td>
<td style="text-align: right;">20</td>
<td style="text-align: left;">4.5% up</td>
</tr>
<tr class="even">
<td style="text-align: left;">Unemployed</td>
<td style="text-align: right;">65</td>
<td style="text-align: right;">55</td>
<td style="text-align: right;">-10</td>
<td style="text-align: left;">15.4% down</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Inactive student</td>
<td style="text-align: right;">79</td>
<td style="text-align: right;">85</td>
<td style="text-align: right;">6</td>
<td style="text-align: left;">7.6% up</td>
</tr>
<tr class="even">
<td style="text-align: left;">Inactive care</td>
<td style="text-align: right;">71</td>
<td style="text-align: right;">70</td>
<td style="text-align: right;">-1</td>
<td style="text-align: left;">1.4% down</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Inactive long term sick</td>
<td style="text-align: right;">45</td>
<td style="text-align: right;">29</td>
<td style="text-align: right;">-16</td>
<td style="text-align: left;">35.6% down</td>
</tr>
<tr class="even">
<td style="text-align: left;">Inactive retired</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">6</td>
<td style="text-align: right;">1</td>
<td style="text-align: left;">20% up</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Inactive other</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">5</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">0% down</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">


</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div id="tbl-singleparent_coupleparent_observed-2" class="quarto-layout-cell quarto-layout-cell-subref anchored" data-ref-parent="tbl-singleparent_coupleparent_observed" style="flex-basis: 100.0%;justify-content: center;">
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<caption>(b) Couple Parent</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">State</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">base</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">counterfactual</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Absolute Change</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Relative Change</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Employed</td>
<td style="text-align: right;">4467</td>
<td style="text-align: right;">4555</td>
<td style="text-align: right;">88</td>
<td style="text-align: left;">2% up</td>
</tr>
<tr class="even">
<td style="text-align: left;">Unemployed</td>
<td style="text-align: right;">178</td>
<td style="text-align: right;">136</td>
<td style="text-align: right;">-42</td>
<td style="text-align: left;">23.6% down</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Inactive student</td>
<td style="text-align: right;">321</td>
<td style="text-align: right;">339</td>
<td style="text-align: right;">18</td>
<td style="text-align: left;">5.6% up</td>
</tr>
<tr class="even">
<td style="text-align: left;">Inactive care</td>
<td style="text-align: right;">440</td>
<td style="text-align: right;">415</td>
<td style="text-align: right;">-25</td>
<td style="text-align: left;">5.7% down</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Inactive long term sick</td>
<td style="text-align: right;">87</td>
<td style="text-align: right;">52</td>
<td style="text-align: right;">-35</td>
<td style="text-align: left;">40.2% down</td>
</tr>
<tr class="even">
<td style="text-align: left;">Inactive retired</td>
<td style="text-align: right;">31</td>
<td style="text-align: right;">31</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">0% down</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Inactive other</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">21</td>
<td style="text-align: right;">-4</td>
<td style="text-align: left;">16% down</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">


</div>
</div>
</div>
</div>
<p>Finally (for now) let’s look at this for females only</p>
<div>
<details>
<summary>Code</summary>
<div class="sourceCode cell-code" id="cb28"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>econ_cat_levels <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"Employed"</span>, <span class="st">"Unemployed"</span>, <span class="st">"Inactive student"</span>, <span class="st">"Inactive care"</span>, <span class="st">"Inactive long term sick"</span>, <span class="st">"Inactive retired"</span>, <span class="st">"Inactive other"</span>)</span>
<span id="cb28-2"><a href="#cb28-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-3"><a href="#cb28-3" aria-hidden="true" tabindex="-1"></a>df_baseline_singleparent <span class="ot">&lt;-</span> </span>
<span id="cb28-4"><a href="#cb28-4" aria-hidden="true" tabindex="-1"></a>  single_couple_parent_df <span class="sc">|&gt;</span> </span>
<span id="cb28-5"><a href="#cb28-5" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb28-6"><a href="#cb28-6" aria-hidden="true" tabindex="-1"></a>    wave <span class="sc">==</span> <span class="st">"j"</span>,</span>
<span id="cb28-7"><a href="#cb28-7" aria-hidden="true" tabindex="-1"></a>    parent_hh_type <span class="sc">==</span> <span class="st">"Single Parent"</span></span>
<span id="cb28-8"><a href="#cb28-8" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb28-9"><a href="#cb28-9" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(sex <span class="sc">==</span> <span class="st">"female"</span>)</span>
<span id="cb28-10"><a href="#cb28-10" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-11"><a href="#cb28-11" aria-hidden="true" tabindex="-1"></a>df_baseline_coupleparent <span class="ot">&lt;-</span> </span>
<span id="cb28-12"><a href="#cb28-12" aria-hidden="true" tabindex="-1"></a>  single_couple_parent_df <span class="sc">|&gt;</span> </span>
<span id="cb28-13"><a href="#cb28-13" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(</span>
<span id="cb28-14"><a href="#cb28-14" aria-hidden="true" tabindex="-1"></a>    wave <span class="sc">==</span> <span class="st">"j"</span>,</span>
<span id="cb28-15"><a href="#cb28-15" aria-hidden="true" tabindex="-1"></a>    parent_hh_type <span class="sc">==</span> <span class="st">"Two Parent Household"</span></span>
<span id="cb28-16"><a href="#cb28-16" aria-hidden="true" tabindex="-1"></a>  ) <span class="sc">|&gt;</span> </span>
<span id="cb28-17"><a href="#cb28-17" aria-hidden="true" tabindex="-1"></a>  <span class="fu">filter</span>(sex <span class="sc">==</span> <span class="st">"female"</span>)</span>
<span id="cb28-18"><a href="#cb28-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-19"><a href="#cb28-19" aria-hidden="true" tabindex="-1"></a>df_counter_singleparent <span class="ot">&lt;-</span></span>
<span id="cb28-20"><a href="#cb28-20" aria-hidden="true" tabindex="-1"></a>  df_baseline_singleparent <span class="sc">|&gt;</span> </span>
<span id="cb28-21"><a href="#cb28-21" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb28-22"><a href="#cb28-22" aria-hidden="true" tabindex="-1"></a>    <span class="at">sf12mcs_dv =</span> sf12mcs_dv <span class="sc">+</span> <span class="dv">1</span> <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">5</span>),</span>
<span id="cb28-23"><a href="#cb28-23" aria-hidden="true" tabindex="-1"></a>    <span class="at">sf12pcs_dv =</span> sf12pcs_dv <span class="sc">+</span> <span class="dv">2</span> <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">5</span>)</span>
<span id="cb28-24"><a href="#cb28-24" aria-hidden="true" tabindex="-1"></a>  )  </span>
<span id="cb28-25"><a href="#cb28-25" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-26"><a href="#cb28-26" aria-hidden="true" tabindex="-1"></a>df_counter_coupleparent <span class="ot">&lt;-</span></span>
<span id="cb28-27"><a href="#cb28-27" aria-hidden="true" tabindex="-1"></a>  df_baseline_coupleparent <span class="sc">|&gt;</span> </span>
<span id="cb28-28"><a href="#cb28-28" aria-hidden="true" tabindex="-1"></a>  <span class="fu">mutate</span>(</span>
<span id="cb28-29"><a href="#cb28-29" aria-hidden="true" tabindex="-1"></a>    <span class="at">sf12mcs_dv =</span> sf12mcs_dv <span class="sc">+</span> <span class="dv">1</span> <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">5</span>),</span>
<span id="cb28-30"><a href="#cb28-30" aria-hidden="true" tabindex="-1"></a>    <span class="at">sf12pcs_dv =</span> sf12pcs_dv <span class="sc">+</span> <span class="dv">2</span> <span class="sc">/</span> <span class="fu">sqrt</span>(<span class="dv">5</span>)</span>
<span id="cb28-31"><a href="#cb28-31" aria-hidden="true" tabindex="-1"></a>  ) </span>
<span id="cb28-32"><a href="#cb28-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-33"><a href="#cb28-33" aria-hidden="true" tabindex="-1"></a>preds_df_base_single <span class="ot">&lt;-</span> </span>
<span id="cb28-34"><a href="#cb28-34" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predict</span>(mod_hhtype_phmh, <span class="at">newdata =</span> df_baseline_singleparent, <span class="at">type =</span> <span class="st">"probs"</span>)</span>
<span id="cb28-35"><a href="#cb28-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-36"><a href="#cb28-36" aria-hidden="true" tabindex="-1"></a>preds_df_base_couple <span class="ot">&lt;-</span> </span>
<span id="cb28-37"><a href="#cb28-37" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predict</span>(mod_hhtype_phmh, <span class="at">newdata =</span> df_baseline_coupleparent, <span class="at">type =</span> <span class="st">"probs"</span>)</span>
<span id="cb28-38"><a href="#cb28-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-39"><a href="#cb28-39" aria-hidden="true" tabindex="-1"></a>preds_df_counter_single <span class="ot">&lt;-</span> </span>
<span id="cb28-40"><a href="#cb28-40" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predict</span>(mod_hhtype_phmh, <span class="at">newdata =</span> df_counter_singleparent, <span class="at">type =</span> <span class="st">"probs"</span>)</span>
<span id="cb28-41"><a href="#cb28-41" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-42"><a href="#cb28-42" aria-hidden="true" tabindex="-1"></a>preds_df_counter_couple <span class="ot">&lt;-</span> </span>
<span id="cb28-43"><a href="#cb28-43" aria-hidden="true" tabindex="-1"></a>  <span class="fu">predict</span>(mod_hhtype_phmh, <span class="at">newdata =</span> df_counter_coupleparent, <span class="at">type =</span> <span class="st">"probs"</span>)</span>
<span id="cb28-44"><a href="#cb28-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-45"><a href="#cb28-45" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-46"><a href="#cb28-46" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-47"><a href="#cb28-47" aria-hidden="true" tabindex="-1"></a>predictions_summary_matrix_single <span class="ot">&lt;-</span> <span class="fu">cbind</span>(</span>
<span id="cb28-48"><a href="#cb28-48" aria-hidden="true" tabindex="-1"></a>  <span class="co"># The number 2 indicates do the sum function for each column.</span></span>
<span id="cb28-49"><a href="#cb28-49" aria-hidden="true" tabindex="-1"></a>  <span class="co"># If it were 1 then this would sum for each row (which should add up to 1 in call cases)</span></span>
<span id="cb28-50"><a href="#cb28-50" aria-hidden="true" tabindex="-1"></a>  <span class="fu">apply</span>(preds_df_base_single, <span class="dv">2</span>, <span class="cf">function</span>(x) <span class="fu">round</span>(<span class="fu">sum</span>(x), <span class="dv">0</span>)),</span>
<span id="cb28-51"><a href="#cb28-51" aria-hidden="true" tabindex="-1"></a>  <span class="fu">apply</span>(preds_df_counter_single, <span class="dv">2</span>, <span class="cf">function</span>(x) <span class="fu">round</span>(<span class="fu">sum</span>(x), <span class="dv">0</span>))</span>
<span id="cb28-52"><a href="#cb28-52" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb28-53"><a href="#cb28-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-54"><a href="#cb28-54" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(predictions_summary_matrix_single) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"base"</span>, <span class="st">"counterfactual"</span>)</span>
<span id="cb28-55"><a href="#cb28-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-56"><a href="#cb28-56" aria-hidden="true" tabindex="-1"></a>tbl_mod_singleparent <span class="ot">&lt;-</span> </span>
<span id="cb28-57"><a href="#cb28-57" aria-hidden="true" tabindex="-1"></a>  predictions_summary_matrix_single <span class="sc">|&gt;</span> </span>
<span id="cb28-58"><a href="#cb28-58" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span> </span>
<span id="cb28-59"><a href="#cb28-59" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">"State"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb28-60"><a href="#cb28-60" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb28-61"><a href="#cb28-61" aria-hidden="true" tabindex="-1"></a>        <span class="at">State =</span> <span class="fu">factor</span>(</span>
<span id="cb28-62"><a href="#cb28-62" aria-hidden="true" tabindex="-1"></a>          State, </span>
<span id="cb28-63"><a href="#cb28-63" aria-hidden="true" tabindex="-1"></a>          <span class="at">ordered =</span> <span class="cn">TRUE</span>, </span>
<span id="cb28-64"><a href="#cb28-64" aria-hidden="true" tabindex="-1"></a>          <span class="at">levels =</span> econ_cat_levels</span>
<span id="cb28-65"><a href="#cb28-65" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb28-66"><a href="#cb28-66" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">|&gt;</span> </span>
<span id="cb28-67"><a href="#cb28-67" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(State) <span class="sc">|&gt;</span> </span>
<span id="cb28-68"><a href="#cb28-68" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb28-69"><a href="#cb28-69" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Absolute Change</span><span class="st">`</span> <span class="ot">=</span> counterfactual <span class="sc">-</span> base,</span>
<span id="cb28-70"><a href="#cb28-70" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Relative Change</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">Absolute Change</span><span class="st">`</span> <span class="sc">/</span> base</span>
<span id="cb28-71"><a href="#cb28-71" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb28-72"><a href="#cb28-72" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb28-73"><a href="#cb28-73" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Relative Change</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">ifelse</span>(</span>
<span id="cb28-74"><a href="#cb28-74" aria-hidden="true" tabindex="-1"></a>        <span class="st">`</span><span class="at">Relative Change</span><span class="st">`</span> <span class="sc">&gt;</span> <span class="dv">0</span>, </span>
<span id="cb28-75"><a href="#cb28-75" aria-hidden="true" tabindex="-1"></a>        glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">"{round(100 * `Relative Change`, 1)}% up"</span> ),</span>
<span id="cb28-76"><a href="#cb28-76" aria-hidden="true" tabindex="-1"></a>        glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">"{round(-100 * `Relative Change`, 1)}% down"</span>)</span>
<span id="cb28-77"><a href="#cb28-77" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb28-78"><a href="#cb28-78" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb28-79"><a href="#cb28-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-80"><a href="#cb28-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-81"><a href="#cb28-81" aria-hidden="true" tabindex="-1"></a>predictions_summary_matrix_couple <span class="ot">&lt;-</span> <span class="fu">cbind</span>(</span>
<span id="cb28-82"><a href="#cb28-82" aria-hidden="true" tabindex="-1"></a>  <span class="co"># The number 2 indicates do the sum function for each column.</span></span>
<span id="cb28-83"><a href="#cb28-83" aria-hidden="true" tabindex="-1"></a>  <span class="co"># If it were 1 then this would sum for each row (which should add up to 1 in call cases)</span></span>
<span id="cb28-84"><a href="#cb28-84" aria-hidden="true" tabindex="-1"></a>  <span class="fu">apply</span>(preds_df_base_couple, <span class="dv">2</span>, <span class="cf">function</span>(x) <span class="fu">round</span>(<span class="fu">sum</span>(x), <span class="dv">0</span>)),</span>
<span id="cb28-85"><a href="#cb28-85" aria-hidden="true" tabindex="-1"></a>  <span class="fu">apply</span>(preds_df_counter_couple, <span class="dv">2</span>, <span class="cf">function</span>(x) <span class="fu">round</span>(<span class="fu">sum</span>(x), <span class="dv">0</span>))</span>
<span id="cb28-86"><a href="#cb28-86" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb28-87"><a href="#cb28-87" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-88"><a href="#cb28-88" aria-hidden="true" tabindex="-1"></a><span class="fu">colnames</span>(predictions_summary_matrix_couple) <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="st">"base"</span>, <span class="st">"counterfactual"</span>)</span>
<span id="cb28-89"><a href="#cb28-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-90"><a href="#cb28-90" aria-hidden="true" tabindex="-1"></a>tbl_mod_coupleparent <span class="ot">&lt;-</span> </span>
<span id="cb28-91"><a href="#cb28-91" aria-hidden="true" tabindex="-1"></a>  predictions_summary_matrix_couple <span class="sc">|&gt;</span> </span>
<span id="cb28-92"><a href="#cb28-92" aria-hidden="true" tabindex="-1"></a>    <span class="fu">as.data.frame</span>() <span class="sc">|&gt;</span> </span>
<span id="cb28-93"><a href="#cb28-93" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rownames_to_column</span>(<span class="at">var =</span> <span class="st">"State"</span>) <span class="sc">|&gt;</span> </span>
<span id="cb28-94"><a href="#cb28-94" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb28-95"><a href="#cb28-95" aria-hidden="true" tabindex="-1"></a>        <span class="at">State =</span> <span class="fu">factor</span>(</span>
<span id="cb28-96"><a href="#cb28-96" aria-hidden="true" tabindex="-1"></a>          State, </span>
<span id="cb28-97"><a href="#cb28-97" aria-hidden="true" tabindex="-1"></a>          <span class="at">ordered =</span> <span class="cn">TRUE</span>, </span>
<span id="cb28-98"><a href="#cb28-98" aria-hidden="true" tabindex="-1"></a>          <span class="at">levels =</span> econ_cat_levels</span>
<span id="cb28-99"><a href="#cb28-99" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb28-100"><a href="#cb28-100" aria-hidden="true" tabindex="-1"></a>      ) <span class="sc">|&gt;</span> </span>
<span id="cb28-101"><a href="#cb28-101" aria-hidden="true" tabindex="-1"></a>    <span class="fu">arrange</span>(State) <span class="sc">|&gt;</span> </span>
<span id="cb28-102"><a href="#cb28-102" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb28-103"><a href="#cb28-103" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Absolute Change</span><span class="st">`</span> <span class="ot">=</span> counterfactual <span class="sc">-</span> base,</span>
<span id="cb28-104"><a href="#cb28-104" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Relative Change</span><span class="st">`</span> <span class="ot">=</span> <span class="st">`</span><span class="at">Absolute Change</span><span class="st">`</span> <span class="sc">/</span> base</span>
<span id="cb28-105"><a href="#cb28-105" aria-hidden="true" tabindex="-1"></a>    ) <span class="sc">|&gt;</span> </span>
<span id="cb28-106"><a href="#cb28-106" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(</span>
<span id="cb28-107"><a href="#cb28-107" aria-hidden="true" tabindex="-1"></a>      <span class="st">`</span><span class="at">Relative Change</span><span class="st">`</span> <span class="ot">=</span> <span class="fu">ifelse</span>(</span>
<span id="cb28-108"><a href="#cb28-108" aria-hidden="true" tabindex="-1"></a>        <span class="st">`</span><span class="at">Relative Change</span><span class="st">`</span> <span class="sc">&gt;</span> <span class="dv">0</span>, </span>
<span id="cb28-109"><a href="#cb28-109" aria-hidden="true" tabindex="-1"></a>        glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">"{round(100 * `Relative Change`, 1)}% up"</span> ),</span>
<span id="cb28-110"><a href="#cb28-110" aria-hidden="true" tabindex="-1"></a>        glue<span class="sc">::</span><span class="fu">glue</span>(<span class="st">"{round(-100 * `Relative Change`, 1)}% down"</span>)</span>
<span id="cb28-111"><a href="#cb28-111" aria-hidden="true" tabindex="-1"></a>        )</span>
<span id="cb28-112"><a href="#cb28-112" aria-hidden="true" tabindex="-1"></a>    )</span>
<span id="cb28-113"><a href="#cb28-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-114"><a href="#cb28-114" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-115"><a href="#cb28-115" aria-hidden="true" tabindex="-1"></a>kbl_health_phbias_single <span class="ot">&lt;-</span> tbl_mod_singleparent <span class="sc">|&gt;</span> knitr<span class="sc">::</span><span class="fu">kable</span>()</span>
<span id="cb28-116"><a href="#cb28-116" aria-hidden="true" tabindex="-1"></a><span class="co"># save_kable(kbl_health, file = here::here("presentations/health_table.html"))</span></span>
<span id="cb28-117"><a href="#cb28-117" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-118"><a href="#cb28-118" aria-hidden="true" tabindex="-1"></a>kbl_health_phbias_couple <span class="ot">&lt;-</span> tbl_mod_coupleparent <span class="sc">|&gt;</span> knitr<span class="sc">::</span><span class="fu">kable</span>()</span>
<span id="cb28-119"><a href="#cb28-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb28-120"><a href="#cb28-120" aria-hidden="true" tabindex="-1"></a>kbl_health_phbias_single</span>
<span id="cb28-121"><a href="#cb28-121" aria-hidden="true" tabindex="-1"></a>kbl_health_phbias_couple</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details>
<div id="tbl-singlemother_couplemother_observed" class="cell tbl-parent quarto-layout-panel anchored">
<div class="panel-caption table-caption">
<p>Table&nbsp;15: Differences in the optimal health change by whether mothers with children are single parents or parenting</p>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div id="tbl-singlemother_couplemother_observed-1" class="quarto-layout-cell quarto-layout-cell-subref anchored" data-ref-parent="tbl-singlemother_couplemother_observed" style="flex-basis: 100.0%;justify-content: center;">
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<caption>(a) Single Mother</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">State</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">base</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">counterfactual</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Absolute Change</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Relative Change</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Employed</td>
<td style="text-align: right;">409</td>
<td style="text-align: right;">428</td>
<td style="text-align: right;">19</td>
<td style="text-align: left;">4.6% up</td>
</tr>
<tr class="even">
<td style="text-align: left;">Unemployed</td>
<td style="text-align: right;">52</td>
<td style="text-align: right;">44</td>
<td style="text-align: right;">-8</td>
<td style="text-align: left;">15.4% down</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Inactive student</td>
<td style="text-align: right;">39</td>
<td style="text-align: right;">42</td>
<td style="text-align: right;">3</td>
<td style="text-align: left;">7.7% up</td>
</tr>
<tr class="even">
<td style="text-align: left;">Inactive care</td>
<td style="text-align: right;">69</td>
<td style="text-align: right;">69</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">0% down</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Inactive long term sick</td>
<td style="text-align: right;">38</td>
<td style="text-align: right;">25</td>
<td style="text-align: right;">-13</td>
<td style="text-align: left;">34.2% down</td>
</tr>
<tr class="even">
<td style="text-align: left;">Inactive retired</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">3</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">0% down</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Inactive other</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">4</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">0% down</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">


</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div id="tbl-singlemother_couplemother_observed-2" class="quarto-layout-cell quarto-layout-cell-subref anchored" data-ref-parent="tbl-singlemother_couplemother_observed" style="flex-basis: 100.0%;justify-content: center;">
<table data-quarto-postprocess="true" class="table table-sm table-striped small">
<caption>(b) Mother in couple</caption>
<thead>
<tr class="header">
<th style="text-align: left;" data-quarto-table-cell-role="th">State</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">base</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">counterfactual</th>
<th style="text-align: right;" data-quarto-table-cell-role="th">Absolute Change</th>
<th style="text-align: left;" data-quarto-table-cell-role="th">Relative Change</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Employed</td>
<td style="text-align: right;">2224</td>
<td style="text-align: right;">2282</td>
<td style="text-align: right;">58</td>
<td style="text-align: left;">2.6% up</td>
</tr>
<tr class="even">
<td style="text-align: left;">Unemployed</td>
<td style="text-align: right;">89</td>
<td style="text-align: right;">69</td>
<td style="text-align: right;">-20</td>
<td style="text-align: left;">22.5% down</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Inactive student</td>
<td style="text-align: right;">177</td>
<td style="text-align: right;">186</td>
<td style="text-align: right;">9</td>
<td style="text-align: left;">5.1% up</td>
</tr>
<tr class="even">
<td style="text-align: left;">Inactive care</td>
<td style="text-align: right;">416</td>
<td style="text-align: right;">392</td>
<td style="text-align: right;">-24</td>
<td style="text-align: left;">5.8% down</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Inactive long term sick</td>
<td style="text-align: right;">51</td>
<td style="text-align: right;">30</td>
<td style="text-align: right;">-21</td>
<td style="text-align: left;">41.2% down</td>
</tr>
<tr class="even">
<td style="text-align: left;">Inactive retired</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">11</td>
<td style="text-align: right;">0</td>
<td style="text-align: left;">0% down</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Inactive other</td>
<td style="text-align: right;">15</td>
<td style="text-align: right;">13</td>
<td style="text-align: right;">-2</td>
<td style="text-align: left;">13.3% down</td>
</tr>
</tbody>
</table>
</div>
</div>
<div class="quarto-layout-row quarto-layout-valign-top">
<div class="quarto-layout-cell" style="flex-basis: 100.0%;justify-content: center;">


</div>
</div>
</div>
</div>
</section>
<section id="summary-of-part-two" class="level3">
<h3 class="anchored" data-anchor-id="summary-of-part-two">Summary of part two</h3>
<p>The impact of improving health had a similar effect on reducing the size of the inactive long-term sick population and unemployed populations. However there were some differences by subpopulations in terms of relative changes in other economic activity states.</p>
<p>For sex differences:</p>
<ul>
<li>Improving health had a larger effect in women in reducing the size of the economically inactive carer popualtion</li>
</ul>
<p>For age differences:</p>
<ul>
<li>Improving health may lead to a greater relative reduction in the unemployed population for younger adults, and a greater increase in the relative size of the employed population for older adults.</li>
</ul>
<p>For households with children, and single parents and couples within this group:</p>
<ul>
<li>A simpler but well performing model specification incorporating household type did not indicate substantive differences between single parents and couples with children in the effect of health</li>
<li>However a more complex model with demographic interactions suggested there may be differences in how health affects economic (in)activity. In particular, there may be a larger relative impact on employment for single parents than parents in a couple, and larger relative reductions in inactive care populations in working age parents in a couple.</li>
</ul>
</section>
</section>
</section>
<section id="discussion" class="level1">
<h1>Discussion</h1>
<section id="strengths" class="level2">
<h2 class="anchored" data-anchor-id="strengths">Strengths</h2>
<ul>
<li><p>Very generalisable and adaptable framework for potentially considering many drivers both individually and in combination.</p></li>
<li><p>Makes use of a large and complex dataset which was initially broadly representative of the UK population.</p></li>
<li><p>UKHLS has both strengths in following individuals and households over time. But on the other hand there is selective retention from wave to wave, so the study sample may become less representative of the general population over time.</p>
<ul>
<li>Particular strength is the longitudinal nature of the study. This was essential for allowing transitions at individual level to be modelled, as a first stage to producing estimates of the effects of drivers on the overall populations</li>
</ul></li>
</ul>
</section>
<section id="comparison-with-other-findings" class="level2">
<h2 class="anchored" data-anchor-id="comparison-with-other-findings">Comparison with other findings</h2>
<ul>
<li>We haven’t looked yet. <strong>A priority to focus on?</strong></li>
</ul>
</section>
<section id="limitationscaveats" class="level2">
<h2 class="anchored" data-anchor-id="limitationscaveats">Limitations/Caveats</h2>
<ul>
<li>We aren’t capturing uncertainty (i) where there are few observations (ii) representativeness of the sample (including sub-groups) (iii) multiplication of uncertainty - more variables, more biased data (iv) computations stop at 100 runs…we could do more for a more precise model.</li>
</ul>
</section>
<section id="implications" class="level2">
<h2 class="anchored" data-anchor-id="implications">Implications</h2>
<section id="research" class="level3">
<h3 class="anchored" data-anchor-id="research">Research</h3>
<ul>
<li><p>As more variables are included in a model, there is less complete data available to populate the models. This may bias the results. We could look at methods such as multiple imputation to attempt to reduce this source of bias.</p></li>
<li><p>We can attempt to make the results more representative of specific within-UK populations, such as those more representative of Scotland, Northern Ireland, or Wales. Different UK nations differ in terms of their demographic and socioeconomic characteristics and so the same exposures are likely to have different effects in different parts of the UK.</p></li>
<li><p>We can also use the modelling framework to consider the effect that ageing populations alone will likely have on the proportion of the working age population who are economically active and inactive in different ways.</p></li>
<li><p>We can also use the framework to project the effect that modest but sustained interventions on drivers may have over multiple years.</p></li>
<li><p>Will link geographic drivers to provide broader upstream context to movements into and out of different economic (in)activity states.</p></li>
</ul>
</section>
<section id="practice" class="level3">
<h3 class="anchored" data-anchor-id="practice">Practice</h3>
<ul>
<li><p>These estimates attempt to quantify the amount of HREI ‘explained by’ specific drivers, based on a PAF-style framing of the questions. This is equivalent to asking what the effect of fully mitigating any driver would be on the population as a whole. However the effectiveness of any real-world intervention is likely to be less, as no adverse driver/exposure is likely to be fully mitigated. As such these estimates likely give an upper bound to the effect of any real-world intervention.</p></li>
<li></li>
</ul>
</section>
</section>
</section>
<section id="references" class="level1">
<h1>References</h1>
<div id="refs" role="list">

</div>
</section>
<section id="appendices" class="level1">
<h1>Appendices</h1>
<section id="appendix-1" class="level2">
<h2 class="anchored" data-anchor-id="appendix-1">Appendix 1</h2>
</section>
<section id="appendix-2" class="level2">
<h2 class="anchored" data-anchor-id="appendix-2">Appendix 2</h2>
</section>
</section>


<div id="quarto-appendix" class="default"><section id="footnotes" class="footnotes footnotes-end-of-document" role="doc-endnotes"><h2 class="anchored quarto-appendix-heading">Footnotes</h2>

<ol>
<li id="fn1"><p>There is no single `health` driver/exposure included in the model. Instead there are separate mental health and physical health exposures. However both mental health and physical health have been standardised, meaning we can model a scenario in which ‘health’ has been improved, and the effect of these health improvements is equal across the mental and and physical health subdomains. In order to ensure we are looking at the effect of the type of the driver being modified, rather than the amount of change we are making to these drivers, we need to employ a little trigonometry. If we were to modify both MH and PH by one standard unit, the total amount of change in ‘health’ would be the hypotenuse of a triangle in which both MH and PH are ‘legs’, i.e.&nbsp;$\sqrt{1^2 + 1^2}$ or $\sqrt2$, which is 1.41 to two decimal places, and so larger than either of the previous exposure reductions being modelled. In order to work out the amount of equal change across both ‘legs’ required for a 1 unit total change across both dimensions, we therefore need to solve $1 = \sqrt{z^2 + z^2}$, i.e.&nbsp;$1 = \sqrt{2z^2}$. This means $1 = 2z^2$, so $z^2 = \frac{1}{2}$, and therefore $z = \frac{1}{\sqrt2}$. In scenario 3, therefore, both MH and PH are increased by this same amount, which is 0.71 to two decimal places.<a href="#fnref1" class="footnote-back" role="doc-backlink">↩︎</a></p></li>
</ol>
</section></div></main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>